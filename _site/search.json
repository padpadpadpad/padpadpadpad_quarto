[
  {
    "objectID": "posts.html",
    "href": "posts.html",
    "title": "Posts",
    "section": "",
    "text": "Caring for someone with severe ME\n\n\n\n\n\nA running journal of the realities of caring for someone with severe ME. \n\n\n\n\n\n2024-06-01\n\n\n35 min\n\n\n\n\n\n\n\n\n\n\n\n\nME Awareness Day 2024\n\n\n\n\n\nLoving someone with severe ME and neuropathic pain. \n\n\n\n\n\n2024-05-12\n\n\n3 min\n\n\n\n\n\n\n\n\n\n\n\n\nSubmitting files to ENA\n\n\n\n\n\nA brief guide to submitting sequencing files to the European Nucleotide Archive (ENA) using the Webin-CLI interface. \n\n\n\n\n\n2023-11-29\n\n\n22 min\n\n\n\n\n\n\n\n\n\n\n\n\nRecreate Ed Hawkins’ climate spiral in R\n\n\n\n\n\nUse ggplot2 and gganimate to visualise climate change since 1880 \n\n\n\n\n\n2023-02-16\n\n\n9 min\n\n\n\n\n\n\n\n\n\n\n\n\nRolling regression to estimate microbial growth rate\n\n\n\n\n\nCalculating microbial growth rates from OD measurements using rolling regression in the tidyverse \n\n\n\n\n\n2019-11-15\n\n\n8 min\n\n\n\n\n\n\n\n\n\n\n\n\nrStrava and gganimate\n\n\n\n\n\nAnimate your Strava activities in R using rStrava and gganimate \n\n\n\n\n\n2018-05-18\n\n\n9 min\n\n\n\n\n\n\n\n\n\n\n\n\nBootstrap nls models in R\n\n\n\n\n\nBootstrap non-linear least squares regression in R with purrr and car \n\n\n\n\n\n2018-01-21\n\n\n18 min\n\n\n\n\n\n\n\n\n\n\n\n\nDoing robust nls regression in R\n\n\n\n\n\nFitting non-linear regressions with broom, purrr and nls.multstart \n\n\n\n\n\n2018-01-07\n\n\n10 min\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Daniel Padfield",
    "section": "",
    "text": "I am a microbial ecologist working at the University of Exeter in Penryn, Cornwall. I have broad interests that span climate change, evolution, and community ecology. My research has concentrated on how environmental change alters the interplay of ecological and evolutionary dynamics in microbial communities. I do this by combining theory and simulations with experimental evolution. In January 2023 I started a NERC Independent Research Fellowship at the University of Exeter to explore the links between climate warming and antibiotic resistance in microbial communities.\nOne of my favourite parts of research is exploring new and exciting datasets. I have been using R for &gt;10 years - authoring the R packages nls.multstart and rTPC - and specialise in the wrangling, manipulation, and visualisation of large datasets and statistical analysis.\nI am also a carer for my partner. She has full-body neuropathic pain, severe ME/CFS and has been bed-bound for around 4 years. She lives with her parents in Cheltenham and I visit for long weekends every three to four weeks.\nIf you are interested in collaborating or have any questions or comments I would love to hear from you."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Welcome to DanPadLab’s website",
    "section": "",
    "text": "I am Daniel Padfield and I am based at the University of Exeter (at the Cornwall campus by the sea). My research is broadly interested in understanding how microbial communities respond to environmental change. To do this, I use a variety of sequencing, experimental, and modelling approaches.\nI am also committed to reproducible and open science. All of the code and data from my projects are freely available online through GitHub and archived on Zenodo.\nThe aim of this website is to allow me to document my work and to provide a space to share useful code and walk-throughs. I also hope to use this as an outlet to document my academic journey as I attempt to manage being an academic alongside being a long-time carer."
  },
  {
    "objectID": "publications/articles/castledine_2020a.html",
    "href": "publications/articles/castledine_2020a.html",
    "title": "Experimental (co)evolution in a multi‐species microbial community results in local maladaptation",
    "section": "",
    "text": "Castledine, M., Padfield, D., & Buckling, A. (2020). Experimental (co) evolution in a multi‐species microbial community results in local maladaptation. Ecology Letters, 23(11), 1673-1681."
  },
  {
    "objectID": "publications/articles/castledine_2020a.html#citation",
    "href": "publications/articles/castledine_2020a.html#citation",
    "title": "Experimental (co)evolution in a multi‐species microbial community results in local maladaptation",
    "section": "",
    "text": "Castledine, M., Padfield, D., & Buckling, A. (2020). Experimental (co) evolution in a multi‐species microbial community results in local maladaptation. Ecology Letters, 23(11), 1673-1681."
  },
  {
    "objectID": "publications/articles/castledine_2020a.html#abstract",
    "href": "publications/articles/castledine_2020a.html#abstract",
    "title": "Experimental (co)evolution in a multi‐species microbial community results in local maladaptation",
    "section": "Abstract",
    "text": "Abstract\nInterspecific coevolutionary interactions can result in rapid biotic adaptation, but most studies have focused only on species pairs. Here, we (co)evolved five microbial species in replicate polycultures and monocultures and quantified local adaptation. Specifically, growth rate assays were used to determine adaptations of each species’ populations to (1) the presence of the other four species in general and (2) sympatric vs. allopatric communities. We found that species did not show an increase in net biotic adaptation:ancestral, polyculture- and monoculture-evolved populations did not have significantly different growth rates within communities. However, 4/5 species’ growth rates were significantly lower within the community they evolved in relative to an allopatric community. ‘Local maladaptation’ suggests that species evolved increased competitive interactions to sympatric species’ populations. This increased competition did not affect community stability or productivity. Our results suggest that (co)evolution within communities can increase competitive interactions that are specific to (co)evolved community members."
  },
  {
    "objectID": "publications/articles/barton_2023.html",
    "href": "publications/articles/barton_2023.html",
    "title": "Comparative experimental evolution reveals species‐specific idiosyncrasies in marine phytoplankton adaptation to warming",
    "section": "",
    "text": "Barton, S., Padfield, D., Masterson, A., Buckling, A., Smirnoff, N., & Yvon‐Durocher, G. (2023). Comparative experimental evolution reveals species‐specific idiosyncrasies in marine phytoplankton adaptation to warming. Global Change Biology."
  },
  {
    "objectID": "publications/articles/barton_2023.html#citation",
    "href": "publications/articles/barton_2023.html#citation",
    "title": "Comparative experimental evolution reveals species‐specific idiosyncrasies in marine phytoplankton adaptation to warming",
    "section": "",
    "text": "Barton, S., Padfield, D., Masterson, A., Buckling, A., Smirnoff, N., & Yvon‐Durocher, G. (2023). Comparative experimental evolution reveals species‐specific idiosyncrasies in marine phytoplankton adaptation to warming. Global Change Biology."
  },
  {
    "objectID": "publications/articles/barton_2023.html#abstract",
    "href": "publications/articles/barton_2023.html#abstract",
    "title": "Comparative experimental evolution reveals species‐specific idiosyncrasies in marine phytoplankton adaptation to warming",
    "section": "Abstract",
    "text": "Abstract\nA number of experimental studies have demonstrated that phytoplankton can display rapid thermal adaptation in response to warmed environments. While these studies provide insight into the evolutionary responses of single species, they tend to employ different experimental techniques. Consequently, our ability to compare the potential for thermal adaptation across different, ecologically relevant, species remains limited. Here, we address this limitation by conducting simultaneous long-term warming experiments with the same experimental design on clonal isolates of three phylogenetically diverse species of marine phytoplankton; the cyanobacterium Synechococcus sp., the prasinophyte Ostreococcus tauri and the diatom Phaeodoactylum tricornutum. Over the same experimental time period, we observed differing levels of thermal adaptation in response to stressful supra-optimal temperatures. Synechococcus sp. displayed the greatest improvement in fitness (i.e., growth rate) and thermal tolerance (i.e., temperature limits of growth). Ostreococcus tauri was able to improve fitness and thermal tolerance, but to a lesser extent. Finally, Phaeodoactylum tricornutum showed no signs of adaptation. These findings could help us understand how the structure of phytoplankton communities may change in response to warming, and possible biogeochemical implications, as some species show relatively more rapid adaptive shifts in their thermal tolerance."
  },
  {
    "objectID": "publications/articles/schaum_2018.html",
    "href": "publications/articles/schaum_2018.html",
    "title": "Temperature‐driven selection on metabolic traits increases the strength of an algal–grazer interaction in naturally warmed streams",
    "section": "",
    "text": "Schaum, C. E., Student Research Team, ffrench‐Constant, R., Lowe, C., Ólafsson, J. S., Padfield, D., … & Wrigglesworth, E. (2018). Temperature‐driven selection on metabolic traits increases the strength of an algal–grazer interaction in naturally warmed streams. Global Change Biology, 24(4), 1793-1803."
  },
  {
    "objectID": "publications/articles/schaum_2018.html#citation",
    "href": "publications/articles/schaum_2018.html#citation",
    "title": "Temperature‐driven selection on metabolic traits increases the strength of an algal–grazer interaction in naturally warmed streams",
    "section": "",
    "text": "Schaum, C. E., Student Research Team, ffrench‐Constant, R., Lowe, C., Ólafsson, J. S., Padfield, D., … & Wrigglesworth, E. (2018). Temperature‐driven selection on metabolic traits increases the strength of an algal–grazer interaction in naturally warmed streams. Global Change Biology, 24(4), 1793-1803."
  },
  {
    "objectID": "publications/articles/schaum_2018.html#abstract",
    "href": "publications/articles/schaum_2018.html#abstract",
    "title": "Temperature‐driven selection on metabolic traits increases the strength of an algal–grazer interaction in naturally warmed streams",
    "section": "Abstract",
    "text": "Abstract"
  },
  {
    "objectID": "publications/articles/padfield_2024.html",
    "href": "publications/articles/padfield_2024.html",
    "title": "Macroevolutionary dynamics in micro-organisms: generalists give rise to specialists across biomes in the ubiquitous bacterial phylum Myxococcota",
    "section": "",
    "text": "Padfield, D., Kay, S., Vos, R., Quince, C., & Vos, M. (2024). Macroevolutionary dynamics in micro-organisms: generalists give rise to specialists across biomes in the ubiquitous bacterial phylum Myxococcota. Molecular Biology & Evolution."
  },
  {
    "objectID": "publications/articles/padfield_2024.html#citation",
    "href": "publications/articles/padfield_2024.html#citation",
    "title": "Macroevolutionary dynamics in micro-organisms: generalists give rise to specialists across biomes in the ubiquitous bacterial phylum Myxococcota",
    "section": "",
    "text": "Padfield, D., Kay, S., Vos, R., Quince, C., & Vos, M. (2024). Macroevolutionary dynamics in micro-organisms: generalists give rise to specialists across biomes in the ubiquitous bacterial phylum Myxococcota. Molecular Biology & Evolution."
  },
  {
    "objectID": "publications/articles/padfield_2024.html#abstract",
    "href": "publications/articles/padfield_2024.html#abstract",
    "title": "Macroevolutionary dynamics in micro-organisms: generalists give rise to specialists across biomes in the ubiquitous bacterial phylum Myxococcota",
    "section": "Abstract",
    "text": "Abstract\nProkaryotes dominate the Tree of Life, but our understanding of the macroevolutionary processes generating this diversity is still limited. Habitat transitions are thought to be a key driver of prokaryote diversity. However, relatively little is known about how prokaryotes successfully transition and persist across environments, and how these processes might vary between biomes and lineages. Here, we investigate biome transitions and specialisation in natural populations of a focal bacterial phylum, the Myxococcota, sampled across a range of replicated soils and freshwater and marine sediments in Cornwall (UK). By targeted deep sequencing of the protein-coding gene rpoB, we found &gt;2000 unique Myxococcota lineages, with the majority (77%) being biome specialists and with only &lt;5% of lineages distributed across the salt barrier. Discrete character evolution models revealed that specialists in one biome rarely transitioned into specialists in another biome. Instead, evolved generalism mediated transitions between biome specialists. State-dependent diversification models found variation in speciation rates across the tree, but this variation was independent of biome association or specialisation. These results were robust to phylogenetic uncertainty, assumed amounts of unsampled diversity resulting in an incomplete phylogeny, and different levels of species delineation. Overall, our results are consistent with a “jack-of-all-trades” trade-off where generalists suffer a cost in any individual environment, resulting in rapid evolution of niche specialists and shed light on how bacteria could transition between biomes."
  },
  {
    "objectID": "publications/articles/padfield_2024.html#summary",
    "href": "publications/articles/padfield_2024.html#summary",
    "title": "Macroevolutionary dynamics in micro-organisms: generalists give rise to specialists across biomes in the ubiquitous bacterial phylum Myxococcota",
    "section": "Summary",
    "text": "Summary"
  },
  {
    "objectID": "publications/articles/lear_2022.html",
    "href": "publications/articles/lear_2022.html",
    "title": "Bacterial colonisation dynamics of household plastics in a coastal environment",
    "section": "",
    "text": "Lear, L., Padfield, D., Dowsett, T., Jones, M., Kay, S., Hayward, A., & Vos, M. (2022). Bacterial colonisation dynamics of household plastics in a coastal environment. Science of the Total Environment, 838, 156199."
  },
  {
    "objectID": "publications/articles/lear_2022.html#citation",
    "href": "publications/articles/lear_2022.html#citation",
    "title": "Bacterial colonisation dynamics of household plastics in a coastal environment",
    "section": "",
    "text": "Lear, L., Padfield, D., Dowsett, T., Jones, M., Kay, S., Hayward, A., & Vos, M. (2022). Bacterial colonisation dynamics of household plastics in a coastal environment. Science of the Total Environment, 838, 156199."
  },
  {
    "objectID": "publications/articles/lear_2022.html#abstract",
    "href": "publications/articles/lear_2022.html#abstract",
    "title": "Bacterial colonisation dynamics of household plastics in a coastal environment",
    "section": "Abstract",
    "text": "Abstract\nAccumulation of plastics in the marine environment has widespread detrimental consequences for ecosystems and wildlife. Marine plastics are rapidly colonised by a wide diversity of bacteria, including human pathogens, posing potential risks to health. Here, we investigate the effect of polymer type, residence time and estuarine location on bacterial colonisation of common household plastics, including pathogenic bacteria. We submerged five main household plastic types: low-density PE (LDPE), high-density PE (HDPE), polypropylene (PP), polyvinyl chloride (PVC) and polyethylene terephthalate (PET) at an estuarine site in Cornwall (U.K.) and tracked bacterial colonisation dynamics. Using both culture-dependent and culture-independent approaches, we found that bacteria rapidly colonised plastics irrespective of polymer type, reaching culturable densities of up to 1000 cells cm3 after 7 weeks. Community composition of the biofilms changed over time, but not among polymer types. The presence of pathogenic bacteria, quantified using the insect model Galleria mellonella, increased dramatically over a five-week period, with Galleria mortality increasing from 4% in week one to 65% in week five. No consistent differences in virulence were observed between polymer types. Pathogens isolated from plastic biofilms using Galleria enrichment included Serratia and Enterococcus species and they harboured a wide range of antimicrobial resistance genes. Our findings show that plastics in coastal waters are rapidly colonised by a wide diversity of bacteria independent of polymer type. Further, our results show that marine plastic biofilms become increasingly associated with virulent bacteria over time."
  },
  {
    "objectID": "publications/articles/lear_2022.html#graphical-abstract",
    "href": "publications/articles/lear_2022.html#graphical-abstract",
    "title": "Bacterial colonisation dynamics of household plastics in a coastal environment",
    "section": "Graphical Abstract",
    "text": "Graphical Abstract"
  },
  {
    "objectID": "publications/articles/swan_2022.html",
    "href": "publications/articles/swan_2022.html",
    "title": "Associations between abundances of free-roaming gamebirds and common buzzards Buteo buteo are not driven by consumption of gamebirds in the buzzard breeding season",
    "section": "",
    "text": "Swan, G. J., Bearhop, S., Redpath, S. M., Silk, M. J., Padfield, D., Goodwin, C. E., & McDonald, R. A. (2022). Associations between abundances of free‐roaming gamebirds and common buzzards Buteo buteo are not driven by consumption of gamebirds in the buzzard breeding season. Ecology and Evolution, 12(5), e8877."
  },
  {
    "objectID": "publications/articles/swan_2022.html#citation",
    "href": "publications/articles/swan_2022.html#citation",
    "title": "Associations between abundances of free-roaming gamebirds and common buzzards Buteo buteo are not driven by consumption of gamebirds in the buzzard breeding season",
    "section": "",
    "text": "Swan, G. J., Bearhop, S., Redpath, S. M., Silk, M. J., Padfield, D., Goodwin, C. E., & McDonald, R. A. (2022). Associations between abundances of free‐roaming gamebirds and common buzzards Buteo buteo are not driven by consumption of gamebirds in the buzzard breeding season. Ecology and Evolution, 12(5), e8877."
  },
  {
    "objectID": "publications/articles/swan_2022.html#abstract",
    "href": "publications/articles/swan_2022.html#abstract",
    "title": "Associations between abundances of free-roaming gamebirds and common buzzards Buteo buteo are not driven by consumption of gamebirds in the buzzard breeding season",
    "section": "Abstract",
    "text": "Abstract\nReleasing gamebirds in large numbers for sport shooting may directly or indirectly influence the abundance, distribution and population dynamics of native wildlife. The abundances of generalist predators have been positively associated with the abundance of gamebirds. These relationships have implications for prey populations, with the potential for indirect impacts of gamebird releases on wider biodiversity. To understand the basis of these associations, we investigated variation in territory size, prey provisioning to chicks, and breeding success of common buzzards Buteo buteo, and associations with variation in the abundances of free-roaming gamebirds, primarily pheasants Phasianus colchicus, and of rabbits Oryctolagus cuniculus and field voles Microtus agrestis, as important prey for buzzards. The relative abundance of gamebirds, but not those of rabbits or voles, was weakly but positively correlated with our index of buzzard territory size. Gamebirds were rarely brought to the nest. Rabbits and voles, and not gamebirds, were provisioned to chicks in proportion to their relative abundance. The number of buzzard chicks increased with provisioning rates of rabbits, in terms of both provisioning frequency and biomass, but not with provisioning rates for gamebirds or voles. Associations between the abundances of buzzards and gamebirds may not be a consequence of the greater availability of gamebirds as prey during the buzzard breeding season. Instead, the association may arise either from habitat or predator management leading to higher densities of alternative prey (in this instance, rabbits), or from greater availability of gamebirds as prey or carrion during the autumn and winter shooting season. The interactions between gamebird releases and associated practices of predator control and shooting itself require better understanding to more effectively intervene in any one aspect of this complex social-ecological system."
  },
  {
    "objectID": "publications/articles/sierocinski_2021.html",
    "href": "publications/articles/sierocinski_2021.html",
    "title": "The impact of propagule pressure on whole community invasions in biomethane-producing communities",
    "section": "",
    "text": "Sierocinski, P., Pascual, J. S., Padfield, D., Salter, M., & Buckling, A. (2021). The impact of propagule pressure on whole community invasions in biomethane-producing communities. Iscience, 24(6), 102659."
  },
  {
    "objectID": "publications/articles/sierocinski_2021.html#citation",
    "href": "publications/articles/sierocinski_2021.html#citation",
    "title": "The impact of propagule pressure on whole community invasions in biomethane-producing communities",
    "section": "",
    "text": "Sierocinski, P., Pascual, J. S., Padfield, D., Salter, M., & Buckling, A. (2021). The impact of propagule pressure on whole community invasions in biomethane-producing communities. Iscience, 24(6), 102659."
  },
  {
    "objectID": "publications/articles/sierocinski_2021.html#abstract",
    "href": "publications/articles/sierocinski_2021.html#abstract",
    "title": "The impact of propagule pressure on whole community invasions in biomethane-producing communities",
    "section": "Abstract",
    "text": "Abstract\nMicrobes can invade as whole communities, but the ecology of whole community invasions is poorly understood. Here, we investigate how invader propagule pressure (the number of invading organisms) affects the composition and function of invaded laboratory methanogenic communities. An invading community was equally successful at establishing itself in a resident community regardless of propagule pressure, which varied between 0.01 and 10% of the size resident community. Invasion resulted in enhanced biogas production (to the level of the pure invading community) but only when propagule pressure was 1% or greater. This inconsistency between invasion success and changes in function can be explained by a lower richness of invading taxa at lower propagule pressures, and an important functional role of the taxa that were absent. Our results highlight that whole community invasion ecology cannot simply be extrapolated from our understanding of single species invasions. Moreover, we show that methane production can be enhanced by invading poorly performing reactors with a better performing community at levels that may be practical in industrial settings."
  },
  {
    "objectID": "publications/articles/sierocinski_2021.html#graphical-abstract",
    "href": "publications/articles/sierocinski_2021.html#graphical-abstract",
    "title": "The impact of propagule pressure on whole community invasions in biomethane-producing communities",
    "section": "Graphical Abstract",
    "text": "Graphical Abstract"
  },
  {
    "objectID": "publications/articles/lear_2022a.html",
    "href": "publications/articles/lear_2022a.html",
    "title": "Disturbance‐mediated invasions are dependent on community resource abundance",
    "section": "",
    "text": "Lear, L., Padfield, D., Inamine, H., Shea, K., & Buckling, A. (2022). Disturbance‐mediated invasions are dependent on community resource abundance. Ecology, 103(8), e3728."
  },
  {
    "objectID": "publications/articles/lear_2022a.html#citation",
    "href": "publications/articles/lear_2022a.html#citation",
    "title": "Disturbance‐mediated invasions are dependent on community resource abundance",
    "section": "",
    "text": "Lear, L., Padfield, D., Inamine, H., Shea, K., & Buckling, A. (2022). Disturbance‐mediated invasions are dependent on community resource abundance. Ecology, 103(8), e3728."
  },
  {
    "objectID": "publications/articles/lear_2022a.html#abstract",
    "href": "publications/articles/lear_2022a.html#abstract",
    "title": "Disturbance‐mediated invasions are dependent on community resource abundance",
    "section": "Abstract",
    "text": "Abstract\nDisturbances can facilitate biological invasions, with the associated increase in resource availability being a proposed cause. Here, we experimentally tested the interactive effects of disturbance regime (different frequencies of biomass removal at equal intensities) and resource abundance on invasion success using a factorial design containing five disturbance frequencies and three resource levels. We invaded populations of the bacterium Pseudomonas fluorescens with two ecologically different invader morphotypes: a fast-growing “colonizer” type and a slower growing “competitor” type. As resident populations were altered by the treatments, we additionally tested their effect on invader success. Disturbance frequency and resource abundance interacted to affect the success of both invaders, but this interaction differed between the invader types. The success of the colonizer type was positively affected by disturbance under high resources but negatively under low. However, disturbance negatively affected the success of the competitor type under high resource abundance but not under low or medium. Resident population changes did not alter invader success beyond direct treatment effects. We therefore demonstrate that the same disturbance regime can either be beneficial or detrimental for an invader depending on both community resource abundance and its life history. These results may help to explain some of the inconsistencies found in the disturbance-invasion literature."
  },
  {
    "objectID": "publications/articles/padfield_2016.html",
    "href": "publications/articles/padfield_2016.html",
    "title": "Rapid evolution of metabolic traits explains thermal adaptation in phytoplankton",
    "section": "",
    "text": "Padfield, D., Yvon‐Durocher, G., Buckling, A., Jennings, S., & Yvon‐Durocher, G. (2016). Rapid evolution of metabolic traits explains thermal adaptation in phytoplankton. Ecology letters, 19(2), 133-142."
  },
  {
    "objectID": "publications/articles/padfield_2016.html#citation",
    "href": "publications/articles/padfield_2016.html#citation",
    "title": "Rapid evolution of metabolic traits explains thermal adaptation in phytoplankton",
    "section": "",
    "text": "Padfield, D., Yvon‐Durocher, G., Buckling, A., Jennings, S., & Yvon‐Durocher, G. (2016). Rapid evolution of metabolic traits explains thermal adaptation in phytoplankton. Ecology letters, 19(2), 133-142."
  },
  {
    "objectID": "publications/articles/padfield_2016.html#abstract",
    "href": "publications/articles/padfield_2016.html#abstract",
    "title": "Rapid evolution of metabolic traits explains thermal adaptation in phytoplankton",
    "section": "Abstract",
    "text": "Abstract\nUnderstanding the mechanisms that determine how phytoplankton adapt to warming will substantially improve the realism of models describing ecological and biogeochemical effects of climate change. Here, we quantify the evolution of elevated thermal tolerance in the phytoplankton, Chlorella vulgaris. Initially, population growth was limited at higher temperatures because respiration was more sensitive to temperature than photosynthesis meaning less carbon was available for growth. Tolerance to high temperature evolved after ≈ 100 generations via greater down-regulation of respiration relative to photosynthesis. By down-regulating respiration, phytoplankton overcame the metabolic constraint imposed by the greater temperature sensitivity of respiration and more efficiently allocated fixed carbon to growth. Rapid evolution of carbon-use efficiency provides a potentially general mechanism for thermal adaptation in phytoplankton and implies that evolutionary responses in phytoplankton will modify biogeochemical cycles and hence food web structure and function under warming. Models of climate futures that ignore adaptation would usefully be revisited."
  },
  {
    "objectID": "publications/articles/mcnicol_2020.html",
    "href": "publications/articles/mcnicol_2020.html",
    "title": "Postrelease movement and habitat selection of translocated pine martens Martes martes",
    "section": "",
    "text": "McNicol, C. M., Bavin, D., Bearhop, S., Bridges, J., Croose, E., Gill, R., … & McDonald, R. A. (2020). Postrelease movement and habitat selection of translocated pine martens Martes martes. Ecology and evolution, 10(11), 5106-5118."
  },
  {
    "objectID": "publications/articles/mcnicol_2020.html#citation",
    "href": "publications/articles/mcnicol_2020.html#citation",
    "title": "Postrelease movement and habitat selection of translocated pine martens Martes martes",
    "section": "",
    "text": "McNicol, C. M., Bavin, D., Bearhop, S., Bridges, J., Croose, E., Gill, R., … & McDonald, R. A. (2020). Postrelease movement and habitat selection of translocated pine martens Martes martes. Ecology and evolution, 10(11), 5106-5118."
  },
  {
    "objectID": "publications/articles/mcnicol_2020.html#abstract",
    "href": "publications/articles/mcnicol_2020.html#abstract",
    "title": "Postrelease movement and habitat selection of translocated pine martens Martes martes",
    "section": "Abstract",
    "text": "Abstract\nMonitoring postrelease establishment and movement of animals is important in evaluating conservation translocations. We translocated 39 wild pine martens Martes martes (19 females, 20 males) from Scotland to Wales. We released them into forested areas with no conspecifics in 2015, followed by a second release in 2016, alongside the previously released animals. We used radio-tracking to describe postrelease movement and habitat selection. Six martens (15%) were not re-encountered during the tracking period, of which four undertook long-distance dispersal. For the remaining individuals, we characterized two phases of movement, “exploration” followed by “settlement,” that differed between releases. In the first release, martens remained in exploration phase for a mean of 14.5 days (SE = 3.9 days) and settled at a mean distance of 8.7 km (SE = 1.8 km) from release sites, whereas martens released in year two, alongside resident conspecifics, traveled away from release sites at a faster rate, settling sooner, at a mean of 6.6 days (SE = 1.8 days), but further, at a mean distance of 14.0 km (SE = 1.7 km) from release sites. Animals released in year one did not exhibit habitat preferences overall but within forests they favored recently felled areas, whereas animals released in year two showed strong selection for forested habitat but did not discriminate between forest types. The presence of conspecifics appeared influential for settlement and site fidelity of translocated martens and was associated with more rapid but more distant dispersal of the later cohort. Releases of animals in close proximity appeared to promote site fidelity and rapid establishment of ranges in the recipient environment."
  },
  {
    "objectID": "publications/articles/castledine_2022b.html",
    "href": "publications/articles/castledine_2022b.html",
    "title": "Greater phage genotypic diversity constrains arms-race coevolution",
    "section": "",
    "text": "Castledine, M., Sierocinski, P., Inglis, M., Kay, S., Hayward, A., Buckling, A., & Padfield, D. (2022). Greater phage genotypic diversity constrains arms-race coevolution. Frontiers in Cellular and Infection Microbiology, 168."
  },
  {
    "objectID": "publications/articles/castledine_2022b.html#citation",
    "href": "publications/articles/castledine_2022b.html#citation",
    "title": "Greater phage genotypic diversity constrains arms-race coevolution",
    "section": "",
    "text": "Castledine, M., Sierocinski, P., Inglis, M., Kay, S., Hayward, A., Buckling, A., & Padfield, D. (2022). Greater phage genotypic diversity constrains arms-race coevolution. Frontiers in Cellular and Infection Microbiology, 168."
  },
  {
    "objectID": "publications/articles/castledine_2022b.html#abstract",
    "href": "publications/articles/castledine_2022b.html#abstract",
    "title": "Greater phage genotypic diversity constrains arms-race coevolution",
    "section": "Abstract",
    "text": "Abstract\nAntagonistic coevolution between hosts and parasites, the reciprocal evolution of host resistance and parasite infectivity, has important implications in ecology and evolution. The dynamics of coevolution – notably whether host or parasite has an evolutionary advantage – is greatly affected by the relative amount of genetic variation in host resistance and parasite infectivity traits. While studies have manipulated genetic diversity during coevolution, such as by increasing mutation rates, it is unclear how starting genetic diversity affects host-parasite coevolution. Here, we (co)evolved the bacterium Pseudomonas fluorescens SBW25 and two bacteriophage genotypes of its lytic phage SBW25ɸ2 in isolation (one phage genotype) and together (two phage genotypes). Bacterial populations rapidly evolved phage resistance and phage reciprocally increased their infectivity in response. When phage populations were evolved with bacteria in isolation, bacterial resistance and phage infectivity increased through time, indicative of arms-race coevolution. In contrast, when both phage genotypes were together, bacteria did not increase their resistance in response to increasing phage infectivity. This was likely due to bacteria being unable to evolve resistance to both phage via the same mutations. These results suggest that increasing initial parasite genotypic diversity can give parasites an evolutionary advantage that arrests long-term coevolution. This study has important implications for the applied use of phage in phage therapy and in understanding host-parasite dynamics in broader ecological and evolutionary theory."
  },
  {
    "objectID": "publications/articles/castledine_2022a.html",
    "href": "publications/articles/castledine_2022a.html",
    "title": "Parallel evolution of Pseudomonas aeruginosa phage resistance and virulence loss in response to phage treatment in vivo and in vitro",
    "section": "",
    "text": "Castledine, M., Padfield, D., Sierocinski, P., Pascual, J. S., Hughes, A., Mäkinen, L., Friman, V.P., Pirnay, J.P., Merabishvili, M., De Vos, D., & Buckling, A. (2022). Parallel evolution of Pseudomonas aeruginosa phage resistance and virulence loss in response to phage treatment in vivo and in vitro. Elife, 11, e73679."
  },
  {
    "objectID": "publications/articles/castledine_2022a.html#citation",
    "href": "publications/articles/castledine_2022a.html#citation",
    "title": "Parallel evolution of Pseudomonas aeruginosa phage resistance and virulence loss in response to phage treatment in vivo and in vitro",
    "section": "",
    "text": "Castledine, M., Padfield, D., Sierocinski, P., Pascual, J. S., Hughes, A., Mäkinen, L., Friman, V.P., Pirnay, J.P., Merabishvili, M., De Vos, D., & Buckling, A. (2022). Parallel evolution of Pseudomonas aeruginosa phage resistance and virulence loss in response to phage treatment in vivo and in vitro. Elife, 11, e73679."
  },
  {
    "objectID": "publications/articles/castledine_2022a.html#abstract",
    "href": "publications/articles/castledine_2022a.html#abstract",
    "title": "Parallel evolution of Pseudomonas aeruginosa phage resistance and virulence loss in response to phage treatment in vivo and in vitro",
    "section": "Abstract",
    "text": "Abstract\nWith rising antibiotic resistance, there has been increasing interest in treating pathogenic bacteria with bacteriophages (phage therapy). One limitation of phage therapy is the ease at which bacteria can evolve resistance. Negative effects of resistance may be mitigated when resistance results in reduced bacterial growth and virulence, or when phage coevolves to overcome resistance. Resistance evolution and its consequences are contingent on the bacteria-phage combination and their environmental context, making therapeutic outcomes hard to predict. One solution might be to conduct ‘in vitro evolutionary simulations’ using bacteria-phage combinations from the therapeutic context. Overall, our aim was to investigate parallels between in vitro experiments and in vivo dynamics in a human participant. Evolutionary dynamics were similar, with high levels of resistance evolving quickly with limited evidence of phage evolution. Resistant bacteria—evolved in vitro and in vivo—had lower virulence. In vivo, this was linked to lower growth rates of resistant isolates, whereas in vitro phage resistant isolates evolved greater biofilm production. Population sequencing suggests resistance resulted from selection on de novo mutations rather than sorting of existing variants. These results highlight the speed at which phage resistance can evolve in vivo, and how in vitro experiments may give useful insights for clinical evolutionary outcomes."
  },
  {
    "objectID": "publications/articles/castledine_2019.html",
    "href": "publications/articles/castledine_2019.html",
    "title": "A shared coevolutionary history does not alter the outcome of coalescence in experimental populations of Pseudomonas fluorescens",
    "section": "",
    "text": "Castledine, M., Buckling, A., & Padfield, D. (2019). A shared coevolutionary history does not alter the outcome of coalescence in experimental populations of Pseudomonas fluorescens. Journal of evolutionary biology, 32(1), 58-65."
  },
  {
    "objectID": "publications/articles/castledine_2019.html#citation",
    "href": "publications/articles/castledine_2019.html#citation",
    "title": "A shared coevolutionary history does not alter the outcome of coalescence in experimental populations of Pseudomonas fluorescens",
    "section": "",
    "text": "Castledine, M., Buckling, A., & Padfield, D. (2019). A shared coevolutionary history does not alter the outcome of coalescence in experimental populations of Pseudomonas fluorescens. Journal of evolutionary biology, 32(1), 58-65."
  },
  {
    "objectID": "publications/articles/castledine_2019.html#abstract",
    "href": "publications/articles/castledine_2019.html#abstract",
    "title": "A shared coevolutionary history does not alter the outcome of coalescence in experimental populations of Pseudomonas fluorescens",
    "section": "Abstract",
    "text": "Abstract\nCommunity coalescence, the mixing of multiple communities, is ubiquitous in natural microbial communities. During coalescence, theory suggests the success of a population will be enhanced by the presence of species it has coevolved with (relative to foreign species), because coevolution will result in greater resource specialization to minimize competition. Thus, more coevolved communities should dominate over less coevolved communities during coalescence events. We test these hypotheses using the bacterium Pseudomonas fluorescens which diversifies into coexisting niche-specialist morphotypes. We first evolved replicate populations for ~40 generations and then isolated evolved genotypes. In a series of competition trials, we determined if using coevolved versus random genotypes affected the relative performance of “communities” of single and multiple genotypes. We found no effect of coevolutionary history on either genotype fitness or community performance, which suggests parallel (co)evolution between communities. However, fitness was enhanced by the presence of other genotypes of the same strain type (wild-type or an isogenic strain with a LacZ marker; the inclusion of the latter necessary to distinguish genotypes during competition), indicative of local adaptation with respect to genetic background. Our results are the first to investigate the effect of (co)evolution on the outcome of coalescence and suggest that when input populations are functionally similar and added at equal mixing ratios, the outcome community may not be asymmetrically dominated by either input population."
  },
  {
    "objectID": "publications/articles/hesse_2019.html",
    "href": "publications/articles/hesse_2019.html",
    "title": "Anthropogenic remediation of heavy metals selects against natural microbial remediation",
    "section": "",
    "text": "Hesse, E., Padfield, D., Bayer, F., Van Veen, E. M., Bryan, C. G., & Buckling, A. (2019). Anthropogenic remediation of heavy metals selects against natural microbial remediation. Proceedings of the Royal Society B, 286(1905), 20190804."
  },
  {
    "objectID": "publications/articles/hesse_2019.html#citation",
    "href": "publications/articles/hesse_2019.html#citation",
    "title": "Anthropogenic remediation of heavy metals selects against natural microbial remediation",
    "section": "",
    "text": "Hesse, E., Padfield, D., Bayer, F., Van Veen, E. M., Bryan, C. G., & Buckling, A. (2019). Anthropogenic remediation of heavy metals selects against natural microbial remediation. Proceedings of the Royal Society B, 286(1905), 20190804."
  },
  {
    "objectID": "publications/articles/hesse_2019.html#abstract",
    "href": "publications/articles/hesse_2019.html#abstract",
    "title": "Anthropogenic remediation of heavy metals selects against natural microbial remediation",
    "section": "Abstract",
    "text": "Abstract\nIn an era of unprecedented environmental change, there have been increasing ecological and global public health concerns associated with exposure to anthropogenic pollutants. While there is a pressing need to remediate polluted ecosystems, human intervention might unwittingly oppose selection for natural detoxification, which is primarily carried out by microbes. We test this possibility in the context of a ubiquitous chemical remediation strategy aimed at targeting metal pollution: the addition of lime-containing materials. Here, we show that raising pH by liming decreased the availability of toxic metals in acidic mine-degraded soils, but as a consequence selected against microbial taxa that naturally remediate soil through the production of metal-binding siderophores. Our results therefore highlight the crucial need to consider the eco-evolutionary consequences of human environmental strategies on microbial ecosystem services and other traits."
  },
  {
    "objectID": "publications/articles/bagra_2024.html",
    "href": "publications/articles/bagra_2024.html",
    "title": "Contrary effects of increasing temperatures on the spread of antimicrobial resistance in river biofilms",
    "section": "",
    "text": "Bagra, K., Kneis, D., Padfield, D., Szekeres, E., Teban-Man, A., Coman, C., … & Klümper, U. (2024). Contrary effects of increasing temperatures on the spread of antimicrobial resistance in river biofilms. Msphere, e00573-23."
  },
  {
    "objectID": "publications/articles/bagra_2024.html#citation",
    "href": "publications/articles/bagra_2024.html#citation",
    "title": "Contrary effects of increasing temperatures on the spread of antimicrobial resistance in river biofilms",
    "section": "",
    "text": "Bagra, K., Kneis, D., Padfield, D., Szekeres, E., Teban-Man, A., Coman, C., … & Klümper, U. (2024). Contrary effects of increasing temperatures on the spread of antimicrobial resistance in river biofilms. Msphere, e00573-23."
  },
  {
    "objectID": "publications/articles/bagra_2024.html#abstract",
    "href": "publications/articles/bagra_2024.html#abstract",
    "title": "Contrary effects of increasing temperatures on the spread of antimicrobial resistance in river biofilms",
    "section": "Abstract",
    "text": "Abstract\nRiver microbial communities regularly act as the first barrier of defense against the spread of antimicrobial resistance genes (ARGs) that enter environmental microbiomes through wastewater. However, how the invasion dynamics of wastewater-borne ARGs into river biofilm communities will shift due to climate change with increasing average and peak temperatures remains unknown. Here, we aimed to elucidate the effects of increasing temperatures on the naturally occurring river biofilm resistome, as well as the invasion success of foreign ARGs entering through wastewater. Natural biofilms were grown in a low-anthropogenic impact river and transferred to artificial laboratory recirculation flume systems operated at three different temperatures (20°C, 25°C, and 30°C). After 1 week of temperature acclimatization, significant increases in the abundance of the naturally occurring ARGs in biofilms were detected at higher temperatures. After this acclimatization period, biofilms were exposed to a single pulse of wastewater, and the invasion dynamics of wastewater-borne ARGs were analyzed over 2 weeks. After 1 day, wastewater-borne ARGs were able to invade the biofilms successfully with no observable effect of temperature on their relative abundance. However, thereafter, ARGs were lost at a far increased rate at 30°C, with ARG levels dropping to the initial natural levels after 14 days. Contrary to the lower temperatures, ARGs were either lost at slower rates or even able to establish themselves in biofilms with stable relative abundances above natural levels. Hence, higher temperatures come with contrary effects on river biofilm resistomes: naturally occurring ARGs increase in abundance, while foreign, invading ARGs are lost at elevated speeds."
  },
  {
    "objectID": "posts/caring_for_soph/index.html",
    "href": "posts/caring_for_soph/index.html",
    "title": "Caring for someone with severe ME",
    "section": "",
    "text": "You may know me. You may not. I am Daniel Padfield, a microbial ecologist and carer. I live in Cornwall and my partner of 11 years is called Sophia Galpin. She lives in Cheltenham with her family and has very severe ME. She has been getting steadily worse for around 10 years, and is now bedbound in constant neuropathic pain. I visit every three weeks for 3 to 4 days.\nThe pain and suffering she gets through is very difficult to describe, but I have decided to try and document each visit in some, small way. This is my account, of how it feels to watch her, of how I see her suffering. This is my account because she cannot tell the world about what she is going through. Right now she cannot speak. Cannot text in full sentences. Cannot write.\nA warning that this set of posts are going to be very sad.\n\n\nCopper - as some of you may know - is our 9 year old sausage dog. He was meant to be our great silver lining. When Soph became ill and unable to work, it meant she was at home so much more. Which gave us the opportunity to get a dog, and we specifically got Copper because he does not need walking so much with his tiny ridiculous legs.\nAnd he was a triumph. He loves people and company, and loved Soph in particular. He just loves being on you, touching you, stealing your warmth. We toilet trained him, taught him tricks, and the couple of summers we spent in Cornwall together as a 3 are among my happiest memories. And Soph loves him so much. She loves how he holds toys between his paws while he chews them, and how he rolls on his back for scritches and so many other things (apart from his barking). We used to enjoy dressing him up and trying to put our glasses on his face while he snoozed next to us. We were a tripod supporting each other.\n\n\n\nCopper with glasses.\n\n\nSoph has not been in Cornwall for ~7 years, and Copper has not either. As I live alone and try to get to the office when I am down there it is not the best place for a dog, so he lives in Cheltenham. When Soph was downstairs this worked ok. He would wait for her to come downstairs in the morning and be so excited to see her, showing her his belly and asking for scritches and giving licks. He is not an ideal companion dog, but he loved being around Soph as much as he could.\n\n\n\nCopper and Soph on an outdoor trip to to Potager gardens.\n\n\nHowever, as Soph has got worse she has seen Copper less. When Copper goes upstairs he is very alert and wants to sniff everything compared to the mellow, settled dog we’d need him to be so that Soph’s vertigo is not triggered. A few years ago when I still managed to very occasionally bring him upstairs, she would enjoy seeing him, she would smile and be engaged. He would lick her hand and let her be stroked, but he could sense something was wrong and need reassurance from me.\n\n\n\nCopper and Soph when Soph when she used to spend time downstairs.\n\n\nFast forward to today, he is sat on me under a blanket while I am typing. Soph has not seen him properly in &gt;6 years. Yet another heartbreaking thing she has lost. Instead he lives downstairs providing company and emotional support for the rest of us. I describe him as a living hot water bottle and stress ball (he is lay on me under a blanket as I type this). He is great for me when I come up to visit. And I am so thankful for Soph’s family for looking after him so well.\n\n\n\nHe just loves blankets.\n\n\nI often describe Soph as being in stasis, like her life is on pause - albeit while going through indescribable suffering - until we can have our little lifey. And that means she remembers Copper when he was 3, not when he was 9. In that time he has recovered from a slipped disc which left him unable to walk, had some cancerous tissue removed from a paw, and started greying under his chinny chin chin. But he is not allowed to get old. Not until Soph recovers somewhat to be able to see him regularly again The thought of him dying of old age while Soph is still alone, suffering in her bed, crosses my mind briefly. Cannot even imagine how we would tell her.\n\n\n\nIn the last post, I described how little time Soph sees people in a day, but using the word “see” is very misleading. Soph’s ME/CFS means she very rarely “sees” us in the way you would expect. For instance, after I told her I was going to talk about her vision, she messaged to say she remembered the last time she saw my eyes - February 2024 (nearly a year ago). There are multiple reasons why Soph no longer gets to see us in any traditional sense, and they combine to be another cruel, complex, debilitating, and heartbreaking outcome of her severe ME/CFS.\nFirst, Soph regularly loses her vision regularly in her left eye for an hour or two. This can happen several times a day, and we are not sure why (I don’t think). Her eye waters and she kind of shrugs it off; she has much more extreme symptoms to survive through each day! Oops its happened again. Imagine what you would do if you suddenly lost sight in one eye!?!\nSecond, Soph has severe light sensitivity, which means she cannot tolerate much light. During the day she wears prescription sunglasses indoors during the day, and she has the curtains closed apart from a slither of light that is angled towards the other end of the room to the one she lies. She only uses lamps that have low brightness, and we help her change into normal glasses in the evening from 8pm.\nThird, her vertigo is so extreme that any changes in her head position can set off an attack. So Soph just looks straight forward, and rarely - if ever - turns her head. She has a very restricted field of view. When we move through her field of vision, this can also set off a vertigo attack. So Soph wears an eye mask when Karen is sorting the room out at bedtime, and when we move around the room at lunch and dinner, and even when we are refilling her cup for the next mouthful of soup.\nWe all do the best we can. We have nice prints at the wall facing her so that she has lovely things to look at (we have had new prints for &gt;1.5 years that we still have not managed to change over). She has a moon lamp and some nice tea light holders that she puts on in the evening. But all of our care is delivered by her bedside, which means she cannot see us, in the traditional sense of the word. She cannot see our eyes, our lips, our facial expressions. She cannot see the tears rolling down my face as I watch her suffer, or the smile that comes from her making a dark joke or when we share a memory of better times. Instead she seems to sense our emotions and what we’re doing in her peripheral vision and through her other senses. She really is desperate to maintain connections despite all of her limitations. Her fight keeps us all going.\nFinally, to briefly rant. This trip was delayed as I got a lurgy for Christmas. I hate that Soph has to make decisions about when she is comfortable or able for me to come visit. It breaks my heart. And I will remember this trip for seeing a kingfisher, getting two fleeting but precious smiles from Soph, and spilling soup down her face during lunch and having to leave after just 1.5 mouthfuls (normally she does 5.5). Oh and her fatigue and general suffering was so bad on the last lunch we did not get to say goodbye. Sigh.\n\n\n\nLast year (2023) I visited Soph every third weekend and stayed for 5 nights from Thursday to Tuesday. It never feels like enough, but Soph’s fatigue is so severe and she is so poorly that she cannot manage more. She also puts in so much effort to engage on my visits that seeing me can actually make her more ill. Heartbreakingly, because she is worse in 2024 I only come up on Fridays, so we have lost 20% of our time together. But in reality we have lost much more.\nAs Soph has gotten more ill, the time she can see people each day has decreased, and the proportion of that time that she gets to interact with people - rather than just surviving - has shrunk. In total, for most of 2024, she sees people for a max of 1.5 hours each day (probably less). During my visits, I probably see her for less than one hour each day, and only around thirty minutes of that is when I am not feeding her. Only thirty minutes of “quality” time to just be in the same room as each other.\nDuring each long weekend visiting Soph, I see her for a total of around 4.5 hours. Unbelievable. The rest of the time she lies alone upstairs as we potter around downstairs, always worrying whether the day will be worse than the day before. So close, and yet so far apart. When I am in Cornwall and have been in work since 9, had meetings, ate lunch, been for a run, my mind wanders and realises it is 2:30 and Soph has been alone apart from a fleeting 5 or 10 minutes. Every single day. It is inconceivably cruel.\nShe must be so lonely. She is desperate to interact but is physically and mentally unable to do more than she currently can. She has to deal with terrifying, complicated and severe symptoms alone. To cope with vertigo attacks without being able to call for help.\nBut it is a lonely existence for the carers too. I find it very hard to find anyone my age with such a complicated life situation helping care for someone so so poorly. It feels like I lead a double life as a researcher and a carer, which ends up meaning I feel inadequate at both: not doing enough work and cannot seem to stop Soph’s slow, depressing, heartbreaking deterioration no matter how hard we all try. Logistically, I still self-isolate in Cornwall for 5 days before I travel to Soph’s, which is much lonelier in the winter when days are shorter and the weather worse for sitting outside. My friends are still super about this, always willing to wear a bunch of layers and brave the outside with me. But it does not stop you feeling like a burden. Like I am always bringing people’s mood down. Suppose we must always feel like that sometimes.\n\n\n\nWe were the most tactile couple. Living in each other’s pockets. Snuggling under blankets on a Sunday watching a film. Cuddling at night until we inevitably got too hot. And we still are, but in mind rather than body.\nThrough the last ten years, Soph has developed extreme skin sensitivity - a condition called allodynia - her whole body neuropathic pain has become ever more extreme, and her lips and mouth are constantly on fire. What this means in practice in that her clothes cause her pain. Touch causes her pain. Soup on her lip causes her pain. Everything causes her pain. It is impossible for me to convey what it feels like, but when she sleeps she often has nightmares about being stabbed.\nI find it the hardest when her suffering is most extreme (if it even varies anymore). When her vertigo flares, and her arms flail and she screams in fright, I can’t grab her hand, can’t hold her, can’t just reach out and try make her feel safe. When feeding her soup, I sometimes tip the soup in too fast which causes her to feel like she is choking and she starts coughing and spluttering. I can’t help her drink water, can’t tap her back, can’t hold her. I just have to sit and watch, feeling helpless and hopeless. It rips me to pieces and shatters my heart.\nWe have had so much taken away from us. Most of the normal things couples do we have been unable to do in years. Years without being able to physically show each other affection. I cannot remember the last time we kissed on the lips. The last time we had a proper hug or a cuddle. Let that sink in. No doubt Soph will remember. She never forgets how long she has been suffering for. And everything she has lost along the way.\nAnd yet, love and care finds a way, and I now all the tiny physical touch we still share is precious to me. In the evening, I lie next to her, with my arm over her body. Never touching, it reminds me of a lap bar on an old rollercoaster that comes down over your legs to keep you safe in the carriage. She holds my other hand and we gently stroke each others hand. She slowly, shakily moves her hand to my face and gives me tiny, weak, but defiant strokes. I shave everyday so that my face is as smooth as possible for her. When we share a dark joke or a memory, and my cheeks raise - giving away a smile - I know she can feel it. She knows every wrinkle of my face. Every pock mark from my teenage acne. It is one of the ways to maintain closeness.\nWe are so close physically, and yet we can barely touch. And yet - amazingly - we are somehow closer than ever. More in love now than we ever have been. I have no idea how she does it.\n\n\n\nI arrive at 18:40 on Friday. Instead of going inside and saying hi to Karen, John, and Copper, I sit in my car and wait for Karen to message that it is ok to come in. Soph’s sound sensitivity is so severe that during mealtimes, any extra and unexpected noise is so painful and all encompassing that she cannot eat.\nSoph has very severe sound sensitivity which means that normal levels of sound are painful for her. As a result, Soph’s family have tailored the house to keep sound to a minimum. We do not flush the toilets when Soph’s door is open, we are careful around the times when we take showers, we keep the TV volume low, we try and limit the number of times we come in and out of the front door, we never shout through the house, and we keep the doors to where we spend most of the day closed. We try prevent the dog barking (although if he sees a squirrel this is nigh on impossible). Essentially we do everything as quietly and softly as possible.\nThe same applies when you see her. We wear socks to try minimise the sound of our feet on the wooden floor. We only ever whisper - although the intonation of whispers can be problematic for her sound sensitivity too. We minimise rustling by opening packets of tissues/bags/wipes before we go into the room. We hold back sneezes and coughs, and prevent banging and tapping. We do everything in our power to create a tailored environment for Soph to survive in and give her the best chance of getting through each and every day.\nHowever, we cannot always control the sound levels. It turns out being quiet is hard! Sometimes we accidentally drop something and Soph screams in shock and surprise. That suffering feels preventable. We feel incredible guilt even though it is not our fault. Earlier this year, the Wychwood music festival happened on Cheltenham racecourse and positioned a stage &lt;500m from Soph’s window. This resulted in her getting so much worse and we still have not recovered what we lost. For the last three weeks, neighbours have been having bathrooms and a roof replaced. Karen - to her immense credit - goes out and asks them to stop during key times (e.g. Soph’s meal times) but there is only so much she can do. Soph’s illness - and severe MECFS in general - is often incompatible with normal life and society.\nAnd all these difficulties lead us to discussing pretty wild ideas. Can we soundproof her room somehow? Soundproof a different room where we could then move her? Could she wear over ear noise cancelling headphones (her whole body pain prevents this)? We’re desperate to build in resilience, but right now we can barely tread water.\nAt the end of the day, the quietness in the house is broken. Soph has kept so much pain inside during the day that she lets it out at night. We hear her scream and wail through the door, but we cannot go in to help.\n\n\n\nFrom the outside, it looks like we care for Soph. Karen is Soph’s full-time carer. She sorts Soph’s medications, washes her clothes and bedding, makes countless soups, buys endless supplies, and is her medical guardian. The admin, research, and fighting Karen does for Soph is endless. We are all very lucky to have her. Soph’s dad - John - works 8-3 and then comes back to help care for Soph and allow Karen to run errands or take a walk. And then I visit every third weekend to allow Karen and John to do a few different things they cannot do without me there, and to see my beloved Soph. I collected some leaves during a walk as Soph loves autumn and left one for her in her room. She told me it smelled like autumn and the outside. We take so much for granted.\nSoph constantly thinks of us as well, despite her being the one who is suffering relentlessly. I just want to highlight some examples of her incredible thoughtfulness and selflessness in the face of her own brutal torture.\nFirst, she hides so much from us. To protect us in some small way. She suppresses screams, holds back tears, and holds her hand to her collarbone - or tucks it into her armpit - to stop uncontrollably shaking. There are many terrifying symptoms that she does not mention - beyond what we see - that must be so frightening. When I lie next to her in the evening for a short time, I can feel her whole body tense as she holds in intense, excruciating, indescribable pain. She then lets out a quiet “oooh” more akin to standing under a shower that is too cold than the feeling of being stabbed by thousands of knives inside and out.\n\n\n\nH-E-L-L in BSL, icons from https://mkdeafzone.org.uk/\n\n\nWhen she explicitly tells us how awful it is - today she used finger spelling for the word H-E-L-L to describe her life - she quickly moves on and downplays the seriousness of it all by saying “it’s ok”. “So so so so so so so so so much suffering, but it’s ok”. She also manages who does what in terms of her care to try and make sure the load is spread to try not to overburden anyone. If we suggest a change, she sometimes says no to protect us, even if she would like to see more of a particular person.\nDespite her extreme limitations, she still manages to show us how much she cares. She has two lamps in her room that she can change the colour of. One is a moon-shaped light which she adores. When I enter her room, they will often be blue - my favourite colour. For Karen, she will make them a different colour. She makes sure to ask me if I’m ok, and will regularly mention to me ways in which we could allow John and Karen to take better care of themselves.\nShe remains my biggest supporter and cheerleader, despite being unable to speak and communication being extremely limited. She asks about my family, friends, and work. She sends me a 🍀 when I have counselling to wish me good luck. She arranges for a caramel shortbread cake for my birthday and arranges with us all to do and buy nice things for each other.\nShe is always thinking of others. All she wants is to make us all happy. She has a huge heart and is trapped inside her body. She has so much to give the world. She goes through hell every day and we are all incredibly proud. In awe of her force of will and huge heart when she is coping with the cruellest of hands.\n\n\n\nThis evening I went into Soph’s for our “time” at 8pm. This is the only time of the day Soph really has to try and interact with someone when it is not also about eating soup. Her only time to connect. On a relatively good day, this can last ~30 minutes. Not today. She was using a tissue to cover her eyes as I moved around as she had dropped her eye mask somewhere. Within seconds of lying next to her I realised this was not going to go well. Her hand was limp. Her breathing laboured. Suffering and torture writ all over her face, and her body was tense as she tried to hold everything in. I had to make the decision - even though I had seen her for less than thirty minutes all day - to leave almost immediately as she was so far past her energy envelope, what she can cope with.\nI returned with her chocolate, vegan cheese, and oat milk and undressed her. She had nothing left. She could barely lift her arm up for me to move the shoulder of her dress down. She held back screams of pain. I often sing silly made up lyrics to “here comes the sun” by The Beatles, one of our favourite songs, so start a verse, to fill the silence as chatting is impossible.\n\n“Mrs Beanie, my love for you grows each hour,\nMrs Beanie, you are one of the world’s most beautiful flowers…“.\n\nSoph interrupted me. She signs that she did not hear the first line. Despite everything going on in that moment, she was trying to escape, to engage, to listen. She is truly incredible. And it is all so extremely cruel.\nAnd then I have to leave. I closed the door. The last night of this trip reduced to maybe five minutes. And she chose to use her energy trying to see me properly instead of having her sheet changed. And I had spilt soup on it, and other things can get on it. And she just has to lie there. And put up with it. Imagine having to choose between eating, engaging, and having your bedding changed. The lack of independence. Of choice. Of dignity.\nI am so heartbroken. Feel so helpless. So incredibly, deeply sad. You do not get used to watching that level of torture and suffering. And yet she does it everyday. She is incredible.\n\n\n\n\nShit. On the 15th August I tested positive for coronavirus. I woke up with a sore throat at 2am and just knew. Thankfully I was in Cornwall, and I had 8 days before I planned to go to Soph’s next. Plenty of time. And then I tested positive again and again. Day after day.\nI had a holiday planned for after the next Soph visit to attend a couple of weddings and see family. But because of these events, if I did not get up to Cheltenham to see Soph beforehand, then it would be a very long time between visits due to needing to self isolate afterwards.\nI tested negative on the 25th August, so I hoped I would be able to see Soph after all and change around some of my holiday plans. I chatted to Karen about what may be best for me trying to come up, but it was just impossible for me to discuss with Soph due to her fatigue and communication limitations. And unfortunately she has to make this decision, to be comfortable with me coming. And getting covid - and becoming more ill generally - is amongst her worst fears.\nShe worried about making the right decision for a couple of days, making herself more ill in the process. In the end, she decided it was best for me not to come, and she knew it would mean the biggest ever gap between my visits. And to put the despair of this decision into perspective: I am the only person who sees her other than her parents. Me visiting is one of the only positive things that changes in her life. My voice is one of the only voices she ever hears. Her life partner. And she had to make the decision not to see me.\nKaren rang me to tell me the decision and we spent a day ruminating, trying desperately to work out how we could make it better, whether to bring it up again. But Soph is simply too ill to have to go through trying to change her mind. Everything - I mean everything - makes her fatigue worse. My heart broke into a thousand tiny pieces.\nThis is the longest I have not seen Soph for ~9 years. Even through coronavirus pandemic. And Soph is well aware. “5w 3 dys”, she messages on the day before I come up.\n\n\n\n\n\n&lt;a href=\"https://tenor.com/view/train-tracks-tracks-collect-get-gromit-gif-11667864\"&gt;Train Tracks Collect GIF&lt;/a&gt;from &lt;a href=\"https://tenor.com/search/train-tracks-gifs\"&gt;Train Tracks GIFs&lt;/a&gt;\n\n\n\n\nI feel like I live my life like Gromit on the train, constantly laying down the tracks in front of myself to keep going. Every day I lay down a new track, prioritising what to do that day - or at best that week or that month - uncertain and unable to plan much beyond that. Living precariously, day by day.\nIn some ways it often feels like I live two separate lives. In one life, I work in Cornwall at the University of Exeter, researching how bacteria respond to environmental change and in the other I care for Soph in Cheltenham. I try my best to juggle both and switch off from one when I am doing the other, but the stress and trauma of watching Soph suffer, and occasionally work stress, inevitably blend into some constant low-level - sometimes more severe - depression that makes managing both work and life rather challenging. The contrast between my last day at Soph’s to my first back at work is always stark: holding a cup for Soph to eat soup to making presentation slides, coding or editing manuscripts\nLogistically it has become increasingly challenging. I visit Soph every third week, and beforehand I self-isolate for 5 days to ensure I do not have covid or any other illness that I could pass on to her. In practice, this means I only have 8 days in person at work in every 15 (work days). I have 4 days at home isolating, and 3 at Soph’s or travelling to Soph’s. Part of my research involves lab work, but in reality this has been incredibly challenging to plan and do. I rarely go to conferences or visit other research groups, and I miss seminars and visiting researchers I would like to chat to. As a research fellow I currently do not have many teaching responsibilities, but at some point that will change. Planning in-person activities with people alongside making sure I am covid (and other illness) free for visiting Soph is a constant anxiety for me. Caring for someone automatically makes you a hypochondriac. I second guess when my throat feels the tiniest bit different. The consequences of bringing a virus to Soph’s house are frightening. Then if I do get covid then all other plans would have to be shifted to accommodate a rearranged Soph visit. It makes my brain hurt thinking about it.\nEmotionally and mentally, maintaining a full time job in academia while caring for Soph is hard, especially so recently as Soph has gotten worse. Although she may have stabilised over the last two visits, we have stabilised at a place much worse than before. Less time together. Less interaction. More suffering. And with that my depression has flared. I have been on antidepressants for several years, and I do counselling every third week (with Action for ME). I have become addicted to the routine and endorphins that exercise gives me. But it just isn’t enough at times. Some days, no matter how much I will myself, I cannot get out of bed. Scrolling to numb my brain. Napping to avoid the world. Unable to shift the haze of anxiety or the big black blob of dread that lives in the pit of my stomach. My inability to make my brain productive and do what I know I should be doing just makes me feel further behind with work, which fuels work stress. It is a never ending cycle.\nAnd yet I am coping. I still manage to help care for Soph and maintain a career in academia. And even though most of the time it does not feel like it, somehow my career seems to still be going well. I am lucky and privileged for the opportunities I have, for the flexibility that my job currently allows me to look after Soph. And I have very understanding colleagues and a great support network that looks out for me. I am also getting better at letting some less important stressors go, to make time for myself and acknowledge that I need that afternoon of self care to make sure I can keep at least some of the plates turning.\nWhether undressing Soph while she screams in pain one day, or analysing growth curves, attending meetings, and editing manuscripts. Both days start the same, with getting out of bed.\nThere are so many feelings of guilt, sadness, and grief - as well as fleeting smiles, happiness, and warmth - but this is a good introduction to how I “manage”.\n\n\n\nThe shifting baseline is a concept used in fisheries management which reflects how in the present day we underestimate how big a fish population was before human exploitation. Because we have overfished many species of fish for a long period of time, we lose perception of what “untouched” actually is, and through the generations we forget just how many fish there were in the first place. This makes it hard to know what we should aim for in terms of management, and what numbers of fish we could get back to. This shifting baseline is exactly the same dilemma we face as Soph’s condition has worsened.\nEleven years ago (according to my Google Photos) Soph and I were on holiday in Italy. But if you saw her today you would be completely shocked.She would quite possibly be the poorliest person you have ever seen. She screams in pain. She can’t speak. Her hand constantly shakes. She has not gotten out of bed for &gt;3 months, not gone downstairs for several years, and not eaten solid food for longer than that. You would expect her to be in hospital under specialist care. And yet we as a family have normalised so much. We normalise what Soph fights through everyday, and what we witness, so that we can cope and continue caring for her. It’s normal for us that she only eats soup, and that we hold the cup to her mouth. That she loses eyesight in one eye several times a day. That she cannot tolerate light or sound. That she cannot look to her right or left without triggering a vertigo attack. This is our baseline. Because Sophs’s health has worsened quite slowly, we sometimes forget just how crazy everything has become. It also makes it hard to imagine what it even is that we would like to get back to, but this is an existential question that lives in the back of my brain.\nSoph and I have gradually lost the ways that we connect as she has deteriorated. Each time we lose something, we find another way to connect and keep some sort of intimacy, before eventually that too, is taken from us. There are too many heartbreaks to cover, so I will keep to two that remain raw for me. For three years or so Soph watched birds in the garden during breakfast. She would come alive when fledglings came to the feeders and be in awe of the colours of the greenfinch, robins, and - on the rare occasion - the great spotted woodpecker. Our breakfast time was precious, a moment we could share together every day, and her mum and dad could share in it when I was not there. It’s been 1.5 years since Soph last went to the window to watch the birds. Today I saw 4 fledged goldfinches on the birdfeeder. It brings mixed emotions as I know how much Soph would have loved to see them.\nTo maintain our connection, Soph and I would make eye contact with each other twice a day for 30 seconds or so. We would just be present in that moment, and time would stand still. Her eyes are so expressive. But in the last two months that has gone too. Survival eats up almost all of her energy, and there is just so little left to be used for social interactions right now. My heart is broken, even more so because of the heartbreak and anguish I know Soph is also going through (on top of all the suffering). So now I grieve yet another loss alongside the general depression that comes with watching Soph suffer. I have managed to somehow cope with all the other losses, overcome the grief. However, I did not take notes so I feel like I am starting from scratch. Who knows when and how I will overcome it this time.\n\n\n\nEarly in 2024 I went to a Level 1 Makaton training course organised by the University. I had a very unique reason for going: to better communicate with Soph my 35 year old partner. The ability to communicate is something we take for granted, but it is just another thing that has become increasingly difficult for Soph. In person she now communicates with very strained words, some makaton, and some of her own signs (her birthday sign is especially resourceful), but it is when she holds in screams or holds back severe pain that makes it plain to us all how much she is suffering. And when her hand shakes uncontrollably and her head and arms writhe we know a crash is coming. If she has only just started eating, she somehow manages to continue because she knows she has to.\nShe only sees people for maybe an hour a day due to her fatigue, so outside of that she communicates via WhatsApp with shortened words and emojis. These are mostly to discuss soup choices and times for us to go up to do lunch/dinner etc. These are also ingenious as she describes the ingredients for a soup in a mix of emojis and broken words. For example the message:\n🥦, Cour toast🌽, 🤏 🥔, hard GC, thy\nTranslates to:\nBroccoli, courgette, toasted corn, a small amount of potato, hard goats cheese and thyme.\nHer mum and I translate these - mostly successfully - and when we discuss what Soph tells us we interestingly retell everything in full sentences. Maybe to humanise the conversations, to make them more like what Soph sounds like as we know she still is inside.\nI had no idea how much I rely on these tiny messages, until they become less regular or stopped altogether. You can spend an hour looking at your phone because you know she is going to message, and you worry that something catastrophic has happened. Last Wednesday when I was in Cornwall I did not hear from Soph after 5pm until the next morning. That had never happened before in several years of her being bedbound. She had a big crash and was just incapable of messaging. And knowing how desperate she is to message, how lonely she is lay alone in bed just makes it worse. I panicked, spiralled and took the Thursday off work.\nI send her maybe 5 or 6 voice messages a day telling her about the mundanities of my life in Cornwall. I try to take photos of baby animals, beaches, and sunsets to send to her. I receive back heart emojis and the broken words. I miss her voice. I miss her laugh. I miss her touch. I also feel pressure to maintain those voice messages, as it is the only voice she hears outside of her mum’s and dad’s in a day. I am prone to sending messages while pottering around, banging a door, or boiling the kettle, and that creates background noise that makes the message harder for Soph to listen to. I know I shouldn’t feel guilty, and yet I am trying to do better.\nThere are so many complexities about communication I cannot cover in a short post. How Soph’s mum discusses treatment options with her now I have no idea. How Karen and I have to discuss so many things about visiting and Soph because she does not have the energy to. How she must feel forgotten as she is not able to communicate with people she loves. How she feels so alone. The mutual frustration of me not being able to understand a sign and the obvious toll it takes on Soph’s energy to have to repeat it several times. Soph is extremely resourceful and incredible for being able to communicate despite everything. And I try so hard to try to understand because every message, sign, word is precious, a privilege to try to decipher. She is an incredible woman, fighting to survive and keep any semblance of a personal connection wherever she can.\nBelow is a video of the finger spelling alphabet. It might be useful for someone. ❤️\n\n\n\n\nWhy do I always think it cannot get any worse? Wychwood Music Festival is on at the Racecourse two fields away from Soph’s house. The sound feels louder than previous years and now reverberates through her room. This makes her condition worse. The earplugs she uses do very little to help. She holds her hands to her ears in pain. She cannot move to another room. There is no escape. It is just something else that is relentless. Torture. Suffering. It is going to last three days. Each day compounds onto the next. She starts each new day relatively more poorly than the last, and all her energy needs to go into eating and doing the bare minimum. Since all of her energy is used up for surviving, there isn’t any left for actually living. No energy can be used for talking, engaging, being. I cannot fathom how lonely Soph must be. It is beyond heartbreaking. And through all this she thinks of other people. She asks me to leave because she does not want our time together - already limited in duration and scope - to be like this. She does not want me to see her like this. And yet maybe this is the new normal - at least for a bit. Post exertional malaise is unpredictable and we do not have a great track record of seeing Soph’s condition improve after big crashes. So maybe I will have to see her like this to be able to see her at all, at least for a bit. But we hope. As I write this on Sunday morning I don’t know whether I will see her today. Maybe I will stay and just cook soup for her, food for her family, and be around for emotional support for her parents. Maybe I will see her. I cannot ask Soph because she has no energy to answer. I am supposed to have a small holiday on Tuesday. Not really sure how.\nSoph’s mum rings people at the local council and gets a number for the local environment monitors who reassure her that they are well within their sound limits. But that isn’t the point. A loud music festival might be a slight annoyance for most people but it is brutal for Soph. No one understands. How can anyone understand how impossible life is for Soph and her family? They do amazing things everyday to survive and be the best they can be but severe ME is just incompatible with life sometimes. However much we try we cannot control everything.\nHere is a video of baby swans I saw to try and give me some level of happiness. Soph will love this video, but I do not know when she will have the energy to see it."
  },
  {
    "objectID": "posts/caring_for_soph/index.html#were-in-the-same-room-but-she-cant-really-see-us.",
    "href": "posts/caring_for_soph/index.html#were-in-the-same-room-but-she-cant-really-see-us.",
    "title": "Caring for someone with severe ME",
    "section": "",
    "text": "In the last post, I described how little time Soph sees people in a day, but using the word “see” is very misleading. Soph’s ME/CFS means she very rarely “sees” us in the way you would expect. For instance, after I told her I was going to talk about her vision, she messaged to say she remembered the last time she saw my eyes - February 2024 (nearly a year ago). There are multiple reasons why Soph no longer gets to see us in any traditional sense, and they combine to be another cruel, complex, debilitating, and heartbreaking outcome of her severe ME/CFS.\nFirst, Soph regularly loses her vision regularly in her left eye for an hour or two. This can happen several times a day, and we are not sure why (I don’t think). Her eye waters and she kind of shrugs it off; she has much more extreme symptoms to survive through each day! Oops its happened again. Imagine what you would do if you suddenly lost sight in one eye!?!\nSecond, Soph has severe light sensitivity, which means she cannot tolerate much light. During the day she wears prescription sunglasses indoors during the day, and she has the curtains closed apart from a slither of light that is angled towards the other end of the room to the one she lies. She only uses lamps that have low brightness, and we help her change into normal glasses in the evening from 8pm.\nThird, her vertigo is so extreme that any changes in her head position can set off an attack. So Soph just looks straight forward, and rarely - if ever - turns her head. She has a very restricted field of view. When we move through her field of vision, this can also set off a vertigo attack. So Soph wears an eye mask when Karen is sorting the room out at bedtime, and when we move around the room at lunch and dinner, and even when we are refilling her cup for the next mouthful of soup.\nWe all do the best we can. We have nice prints at the wall facing her so that she has lovely things to look at (we have had new prints for &gt;1.5 years that we still have not managed to change over). She has a moon lamp and some nice tea light holders that she puts on in the evening. But all of our care is delivered by her bedside, which means she cannot see us, in the traditional sense of the word. She cannot see our eyes, our lips, our facial expressions. She cannot see the tears rolling down my face as I watch her suffer, or the smile that comes from her making a dark joke or when we share a memory of better times. Instead she seems to sense our emotions and what we’re doing in her peripheral vision and through her other senses. She really is desperate to maintain connections despite all of her limitations. Her fight keeps us all going.\nFinally, to briefly rant. This trip was delayed as I got a lurgy for Christmas. I hate that Soph has to make decisions about when she is comfortable or able for me to come visit. It breaks my heart. And I will remember this trip for seeing a kingfisher, getting two fleeting but precious smiles from Soph, and spilling soup down her face during lunch and having to leave after just 1.5 mouthfuls (normally she does 5.5). Oh and her fatigue and general suffering was so bad on the last lunch we did not get to say goodbye. Sigh."
  },
  {
    "objectID": "posts/caring_for_soph/index.html#so-close-yet-so-far-apart.",
    "href": "posts/caring_for_soph/index.html#so-close-yet-so-far-apart.",
    "title": "Caring for someone with severe ME",
    "section": "",
    "text": "Last year (2023) I visited Soph every third weekend and stayed for 5 nights from Thursday to Tuesday. It never feels like enough, but Soph’s fatigue is so severe and she is so poorly that she cannot manage more. She also puts in so much effort to engage on my visits that seeing me can actually make her more ill. Heartbreakingly, because she is worse in 2024 I only come up on Fridays, so we have lost 20% of our time together. But in reality we have lost much more.\nAs Soph has gotten more ill, the time she can see people each day has decreased, and the proportion of that time that she gets to interact with people - rather than just surviving - has shrunk. In total, for most of 2024, she sees people for a max of 1.5 hours each day (probably less). During my visits, I probably see her for less than one hour each day, and only around thirty minutes of that is when I am not feeding her. Only thirty minutes of “quality” time to just be in the same room as each other.\nDuring each long weekend visiting Soph, I see her for a total of around 4.5 hours. Unbelievable. The rest of the time she lies alone upstairs as we potter around downstairs, always worrying whether the day will be worse than the day before. So close, and yet so far apart. When I am in Cornwall and have been in work since 9, had meetings, ate lunch, been for a run, my mind wanders and realises it is 2:30 and Soph has been alone apart from a fleeting 5 or 10 minutes. Every single day. It is inconceivably cruel.\nShe must be so lonely. She is desperate to interact but is physically and mentally unable to do more than she currently can. She has to deal with terrifying, complicated and severe symptoms alone. To cope with vertigo attacks without being able to call for help.\nBut it is a lonely existence for the carers too. I find it very hard to find anyone my age with such a complicated life situation helping care for someone so so poorly. It feels like I lead a double life as a researcher and a carer, which ends up meaning I feel inadequate at both: not doing enough work and cannot seem to stop Soph’s slow, depressing, heartbreaking deterioration no matter how hard we all try. Logistically, I still self-isolate in Cornwall for 5 days before I travel to Soph’s, which is much lonelier in the winter when days are shorter and the weather worse for sitting outside. My friends are still super about this, always willing to wear a bunch of layers and brave the outside with me. But it does not stop you feeling like a burden. Like I am always bringing people’s mood down. Suppose we must always feel like that sometimes."
  },
  {
    "objectID": "posts/caring_for_soph/index.html#when-was-the-last-time-we-kissed",
    "href": "posts/caring_for_soph/index.html#when-was-the-last-time-we-kissed",
    "title": "Caring for someone with severe ME",
    "section": "",
    "text": "We were the most tactile couple. Living in each other’s pockets. Snuggling under blankets on a Sunday watching a film. Cuddling at night until we inevitably got too hot. And we still are, but in mind rather than body.\nThrough the last ten years, Soph has developed extreme skin sensitivity - a condition called allodynia - her whole body neuropathic pain has become ever more extreme, and her lips and mouth are constantly on fire. What this means in practice in that her clothes cause her pain. Touch causes her pain. Soup on her lip causes her pain. Everything causes her pain. It is impossible for me to convey what it feels like, but when she sleeps she often has nightmares about being stabbed.\nI find it the hardest when her suffering is most extreme (if it even varies anymore). When her vertigo flares, and her arms flail and she screams in fright, I can’t grab her hand, can’t hold her, can’t just reach out and try make her feel safe. When feeding her soup, I sometimes tip the soup in too fast which causes her to feel like she is choking and she starts coughing and spluttering. I can’t help her drink water, can’t tap her back, can’t hold her. I just have to sit and watch, feeling helpless and hopeless. It rips me to pieces and shatters my heart.\nWe have had so much taken away from us. Most of the normal things couples do we have been unable to do in years. Years without being able to physically show each other affection. I cannot remember the last time we kissed on the lips. The last time we had a proper hug or a cuddle. Let that sink in. No doubt Soph will remember. She never forgets how long she has been suffering for. And everything she has lost along the way.\nAnd yet, love and care finds a way, and I now all the tiny physical touch we still share is precious to me. In the evening, I lie next to her, with my arm over her body. Never touching, it reminds me of a lap bar on an old rollercoaster that comes down over your legs to keep you safe in the carriage. She holds my other hand and we gently stroke each others hand. She slowly, shakily moves her hand to my face and gives me tiny, weak, but defiant strokes. I shave everyday so that my face is as smooth as possible for her. When we share a dark joke or a memory, and my cheeks raise - giving away a smile - I know she can feel it. She knows every wrinkle of my face. Every pock mark from my teenage acne. It is one of the ways to maintain closeness.\nWe are so close physically, and yet we can barely touch. And yet - amazingly - we are somehow closer than ever. More in love now than we ever have been. I have no idea how she does it."
  },
  {
    "objectID": "posts/caring_for_soph/index.html#a-quiet-place.",
    "href": "posts/caring_for_soph/index.html#a-quiet-place.",
    "title": "Caring for someone with severe ME",
    "section": "",
    "text": "I arrive at 18:40 on Friday. Instead of going inside and saying hi to Karen, John, and Copper, I sit in my car and wait for Karen to message that it is ok to come in. Soph’s sound sensitivity is so severe that during mealtimes, any extra and unexpected noise is so painful and all encompassing that she cannot eat.\nSoph has very severe sound sensitivity which means that normal levels of sound are painful for her. As a result, Soph’s family have tailored the house to keep sound to a minimum. We do not flush the toilets when Soph’s door is open, we are careful around the times when we take showers, we keep the TV volume low, we try and limit the number of times we come in and out of the front door, we never shout through the house, and we keep the doors to where we spend most of the day closed. We try prevent the dog barking (although if he sees a squirrel this is nigh on impossible). Essentially we do everything as quietly and softly as possible.\nThe same applies when you see her. We wear socks to try minimise the sound of our feet on the wooden floor. We only ever whisper - although the intonation of whispers can be problematic for her sound sensitivity too. We minimise rustling by opening packets of tissues/bags/wipes before we go into the room. We hold back sneezes and coughs, and prevent banging and tapping. We do everything in our power to create a tailored environment for Soph to survive in and give her the best chance of getting through each and every day.\nHowever, we cannot always control the sound levels. It turns out being quiet is hard! Sometimes we accidentally drop something and Soph screams in shock and surprise. That suffering feels preventable. We feel incredible guilt even though it is not our fault. Earlier this year, the Wychwood music festival happened on Cheltenham racecourse and positioned a stage &lt;500m from Soph’s window. This resulted in her getting so much worse and we still have not recovered what we lost. For the last three weeks, neighbours have been having bathrooms and a roof replaced. Karen - to her immense credit - goes out and asks them to stop during key times (e.g. Soph’s meal times) but there is only so much she can do. Soph’s illness - and severe MECFS in general - is often incompatible with normal life and society.\nAnd all these difficulties lead us to discussing pretty wild ideas. Can we soundproof her room somehow? Soundproof a different room where we could then move her? Could she wear over ear noise cancelling headphones (her whole body pain prevents this)? We’re desperate to build in resilience, but right now we can barely tread water.\nAt the end of the day, the quietness in the house is broken. Soph has kept so much pain inside during the day that she lets it out at night. We hear her scream and wail through the door, but we cannot go in to help."
  },
  {
    "objectID": "posts/caring_for_soph/index.html#who-is-looking-after-who",
    "href": "posts/caring_for_soph/index.html#who-is-looking-after-who",
    "title": "Caring for someone with severe ME",
    "section": "",
    "text": "From the outside, it looks like we care for Soph. Karen is Soph’s full-time carer. She sorts Soph’s medications, washes her clothes and bedding, makes countless soups, buys endless supplies, and is her medical guardian. The admin, research, and fighting Karen does for Soph is endless. We are all very lucky to have her. Soph’s dad - John - works 8-3 and then comes back to help care for Soph and allow Karen to run errands or take a walk. And then I visit every third weekend to allow Karen and John to do a few different things they cannot do without me there, and to see my beloved Soph. I collected some leaves during a walk as Soph loves autumn and left one for her in her room. She told me it smelled like autumn and the outside. We take so much for granted.\nSoph constantly thinks of us as well, despite her being the one who is suffering relentlessly. I just want to highlight some examples of her incredible thoughtfulness and selflessness in the face of her own brutal torture.\nFirst, she hides so much from us. To protect us in some small way. She suppresses screams, holds back tears, and holds her hand to her collarbone - or tucks it into her armpit - to stop uncontrollably shaking. There are many terrifying symptoms that she does not mention - beyond what we see - that must be so frightening. When I lie next to her in the evening for a short time, I can feel her whole body tense as she holds in intense, excruciating, indescribable pain. She then lets out a quiet “oooh” more akin to standing under a shower that is too cold than the feeling of being stabbed by thousands of knives inside and out.\n\n\n\nH-E-L-L in BSL, icons from https://mkdeafzone.org.uk/\n\n\nWhen she explicitly tells us how awful it is - today she used finger spelling for the word H-E-L-L to describe her life - she quickly moves on and downplays the seriousness of it all by saying “it’s ok”. “So so so so so so so so so much suffering, but it’s ok”. She also manages who does what in terms of her care to try and make sure the load is spread to try not to overburden anyone. If we suggest a change, she sometimes says no to protect us, even if she would like to see more of a particular person.\nDespite her extreme limitations, she still manages to show us how much she cares. She has two lamps in her room that she can change the colour of. One is a moon-shaped light which she adores. When I enter her room, they will often be blue - my favourite colour. For Karen, she will make them a different colour. She makes sure to ask me if I’m ok, and will regularly mention to me ways in which we could allow John and Karen to take better care of themselves.\nShe remains my biggest supporter and cheerleader, despite being unable to speak and communication being extremely limited. She asks about my family, friends, and work. She sends me a 🍀 when I have counselling to wish me good luck. She arranges for a caramel shortbread cake for my birthday and arranges with us all to do and buy nice things for each other.\nShe is always thinking of others. All she wants is to make us all happy. She has a huge heart and is trapped inside her body. She has so much to give the world. She goes through hell every day and we are all incredibly proud. In awe of her force of will and huge heart when she is coping with the cruellest of hands."
  },
  {
    "objectID": "posts/caring_for_soph/index.html#cruel-does-not-cover-it.",
    "href": "posts/caring_for_soph/index.html#cruel-does-not-cover-it.",
    "title": "Caring for someone with severe ME",
    "section": "",
    "text": "This evening I went into Soph’s for our “time” at 8pm. This is the only time of the day Soph really has to try and interact with someone when it is not also about eating soup. Her only time to connect. On a relatively good day, this can last ~30 minutes. Not today. She was using a tissue to cover her eyes as I moved around as she had dropped her eye mask somewhere. Within seconds of lying next to her I realised this was not going to go well. Her hand was limp. Her breathing laboured. Suffering and torture writ all over her face, and her body was tense as she tried to hold everything in. I had to make the decision - even though I had seen her for less than thirty minutes all day - to leave almost immediately as she was so far past her energy envelope, what she can cope with.\nI returned with her chocolate, vegan cheese, and oat milk and undressed her. She had nothing left. She could barely lift her arm up for me to move the shoulder of her dress down. She held back screams of pain. I often sing silly made up lyrics to “here comes the sun” by The Beatles, one of our favourite songs, so start a verse, to fill the silence as chatting is impossible.\n\n“Mrs Beanie, my love for you grows each hour,\nMrs Beanie, you are one of the world’s most beautiful flowers…“.\n\nSoph interrupted me. She signs that she did not hear the first line. Despite everything going on in that moment, she was trying to escape, to engage, to listen. She is truly incredible. And it is all so extremely cruel.\nAnd then I have to leave. I closed the door. The last night of this trip reduced to maybe five minutes. And she chose to use her energy trying to see me properly instead of having her sheet changed. And I had spilt soup on it, and other things can get on it. And she just has to lie there. And put up with it. Imagine having to choose between eating, engaging, and having your bedding changed. The lack of independence. Of choice. Of dignity.\nI am so heartbroken. Feel so helpless. So incredibly, deeply sad. You do not get used to watching that level of torture and suffering. And yet she does it everyday. She is incredible."
  },
  {
    "objectID": "posts/caring_for_soph/index.html#covid-and-the-trip-that-never-was.",
    "href": "posts/caring_for_soph/index.html#covid-and-the-trip-that-never-was.",
    "title": "Caring for someone with severe ME",
    "section": "",
    "text": "Shit. On the 15th August I tested positive for coronavirus. I woke up with a sore throat at 2am and just knew. Thankfully I was in Cornwall, and I had 8 days before I planned to go to Soph’s next. Plenty of time. And then I tested positive again and again. Day after day.\nI had a holiday planned for after the next Soph visit to attend a couple of weddings and see family. But because of these events, if I did not get up to Cheltenham to see Soph beforehand, then it would be a very long time between visits due to needing to self isolate afterwards.\nI tested negative on the 25th August, so I hoped I would be able to see Soph after all and change around some of my holiday plans. I chatted to Karen about what may be best for me trying to come up, but it was just impossible for me to discuss with Soph due to her fatigue and communication limitations. And unfortunately she has to make this decision, to be comfortable with me coming. And getting covid - and becoming more ill generally - is amongst her worst fears.\nShe worried about making the right decision for a couple of days, making herself more ill in the process. In the end, she decided it was best for me not to come, and she knew it would mean the biggest ever gap between my visits. And to put the despair of this decision into perspective: I am the only person who sees her other than her parents. Me visiting is one of the only positive things that changes in her life. My voice is one of the only voices she ever hears. Her life partner. And she had to make the decision not to see me.\nKaren rang me to tell me the decision and we spent a day ruminating, trying desperately to work out how we could make it better, whether to bring it up again. But Soph is simply too ill to have to go through trying to change her mind. Everything - I mean everything - makes her fatigue worse. My heart broke into a thousand tiny pieces.\nThis is the longest I have not seen Soph for ~9 years. Even through coronavirus pandemic. And Soph is well aware. “5w 3 dys”, she messages on the day before I come up."
  },
  {
    "objectID": "posts/caring_for_soph/index.html#feeding-soph-on-tuesday-making-presentation-slides-on-wednesday.",
    "href": "posts/caring_for_soph/index.html#feeding-soph-on-tuesday-making-presentation-slides-on-wednesday.",
    "title": "Caring for someone with severe ME",
    "section": "",
    "text": "&lt;a href=\"https://tenor.com/view/train-tracks-tracks-collect-get-gromit-gif-11667864\"&gt;Train Tracks Collect GIF&lt;/a&gt;from &lt;a href=\"https://tenor.com/search/train-tracks-gifs\"&gt;Train Tracks GIFs&lt;/a&gt;\n\n\n\n\nI feel like I live my life like Gromit on the train, constantly laying down the tracks in front of myself to keep going. Every day I lay down a new track, prioritising what to do that day - or at best that week or that month - uncertain and unable to plan much beyond that. Living precariously, day by day.\nIn some ways it often feels like I live two separate lives. In one life, I work in Cornwall at the University of Exeter, researching how bacteria respond to environmental change and in the other I care for Soph in Cheltenham. I try my best to juggle both and switch off from one when I am doing the other, but the stress and trauma of watching Soph suffer, and occasionally work stress, inevitably blend into some constant low-level - sometimes more severe - depression that makes managing both work and life rather challenging. The contrast between my last day at Soph’s to my first back at work is always stark: holding a cup for Soph to eat soup to making presentation slides, coding or editing manuscripts\nLogistically it has become increasingly challenging. I visit Soph every third week, and beforehand I self-isolate for 5 days to ensure I do not have covid or any other illness that I could pass on to her. In practice, this means I only have 8 days in person at work in every 15 (work days). I have 4 days at home isolating, and 3 at Soph’s or travelling to Soph’s. Part of my research involves lab work, but in reality this has been incredibly challenging to plan and do. I rarely go to conferences or visit other research groups, and I miss seminars and visiting researchers I would like to chat to. As a research fellow I currently do not have many teaching responsibilities, but at some point that will change. Planning in-person activities with people alongside making sure I am covid (and other illness) free for visiting Soph is a constant anxiety for me. Caring for someone automatically makes you a hypochondriac. I second guess when my throat feels the tiniest bit different. The consequences of bringing a virus to Soph’s house are frightening. Then if I do get covid then all other plans would have to be shifted to accommodate a rearranged Soph visit. It makes my brain hurt thinking about it.\nEmotionally and mentally, maintaining a full time job in academia while caring for Soph is hard, especially so recently as Soph has gotten worse. Although she may have stabilised over the last two visits, we have stabilised at a place much worse than before. Less time together. Less interaction. More suffering. And with that my depression has flared. I have been on antidepressants for several years, and I do counselling every third week (with Action for ME). I have become addicted to the routine and endorphins that exercise gives me. But it just isn’t enough at times. Some days, no matter how much I will myself, I cannot get out of bed. Scrolling to numb my brain. Napping to avoid the world. Unable to shift the haze of anxiety or the big black blob of dread that lives in the pit of my stomach. My inability to make my brain productive and do what I know I should be doing just makes me feel further behind with work, which fuels work stress. It is a never ending cycle.\nAnd yet I am coping. I still manage to help care for Soph and maintain a career in academia. And even though most of the time it does not feel like it, somehow my career seems to still be going well. I am lucky and privileged for the opportunities I have, for the flexibility that my job currently allows me to look after Soph. And I have very understanding colleagues and a great support network that looks out for me. I am also getting better at letting some less important stressors go, to make time for myself and acknowledge that I need that afternoon of self care to make sure I can keep at least some of the plates turning.\nWhether undressing Soph while she screams in pain one day, or analysing growth curves, attending meetings, and editing manuscripts. Both days start the same, with getting out of bed.\nThere are so many feelings of guilt, sadness, and grief - as well as fleeting smiles, happiness, and warmth - but this is a good introduction to how I “manage”."
  },
  {
    "objectID": "posts/caring_for_soph/index.html#the-shifting-baseline-of-severe-me-and-grieving-what-weve-lost.",
    "href": "posts/caring_for_soph/index.html#the-shifting-baseline-of-severe-me-and-grieving-what-weve-lost.",
    "title": "Caring for someone with severe ME",
    "section": "",
    "text": "The shifting baseline is a concept used in fisheries management which reflects how in the present day we underestimate how big a fish population was before human exploitation. Because we have overfished many species of fish for a long period of time, we lose perception of what “untouched” actually is, and through the generations we forget just how many fish there were in the first place. This makes it hard to know what we should aim for in terms of management, and what numbers of fish we could get back to. This shifting baseline is exactly the same dilemma we face as Soph’s condition has worsened.\nEleven years ago (according to my Google Photos) Soph and I were on holiday in Italy. But if you saw her today you would be completely shocked.She would quite possibly be the poorliest person you have ever seen. She screams in pain. She can’t speak. Her hand constantly shakes. She has not gotten out of bed for &gt;3 months, not gone downstairs for several years, and not eaten solid food for longer than that. You would expect her to be in hospital under specialist care. And yet we as a family have normalised so much. We normalise what Soph fights through everyday, and what we witness, so that we can cope and continue caring for her. It’s normal for us that she only eats soup, and that we hold the cup to her mouth. That she loses eyesight in one eye several times a day. That she cannot tolerate light or sound. That she cannot look to her right or left without triggering a vertigo attack. This is our baseline. Because Sophs’s health has worsened quite slowly, we sometimes forget just how crazy everything has become. It also makes it hard to imagine what it even is that we would like to get back to, but this is an existential question that lives in the back of my brain.\nSoph and I have gradually lost the ways that we connect as she has deteriorated. Each time we lose something, we find another way to connect and keep some sort of intimacy, before eventually that too, is taken from us. There are too many heartbreaks to cover, so I will keep to two that remain raw for me. For three years or so Soph watched birds in the garden during breakfast. She would come alive when fledglings came to the feeders and be in awe of the colours of the greenfinch, robins, and - on the rare occasion - the great spotted woodpecker. Our breakfast time was precious, a moment we could share together every day, and her mum and dad could share in it when I was not there. It’s been 1.5 years since Soph last went to the window to watch the birds. Today I saw 4 fledged goldfinches on the birdfeeder. It brings mixed emotions as I know how much Soph would have loved to see them.\nTo maintain our connection, Soph and I would make eye contact with each other twice a day for 30 seconds or so. We would just be present in that moment, and time would stand still. Her eyes are so expressive. But in the last two months that has gone too. Survival eats up almost all of her energy, and there is just so little left to be used for social interactions right now. My heart is broken, even more so because of the heartbreak and anguish I know Soph is also going through (on top of all the suffering). So now I grieve yet another loss alongside the general depression that comes with watching Soph suffer. I have managed to somehow cope with all the other losses, overcome the grief. However, I did not take notes so I feel like I am starting from scratch. Who knows when and how I will overcome it this time."
  },
  {
    "objectID": "posts/caring_for_soph/index.html#six-voice-messages-a-photo-of-a-swan-and-15-emojis.",
    "href": "posts/caring_for_soph/index.html#six-voice-messages-a-photo-of-a-swan-and-15-emojis.",
    "title": "Caring for someone with severe ME",
    "section": "",
    "text": "Early in 2024 I went to a Level 1 Makaton training course organised by the University. I had a very unique reason for going: to better communicate with Soph my 35 year old partner. The ability to communicate is something we take for granted, but it is just another thing that has become increasingly difficult for Soph. In person she now communicates with very strained words, some makaton, and some of her own signs (her birthday sign is especially resourceful), but it is when she holds in screams or holds back severe pain that makes it plain to us all how much she is suffering. And when her hand shakes uncontrollably and her head and arms writhe we know a crash is coming. If she has only just started eating, she somehow manages to continue because she knows she has to.\nShe only sees people for maybe an hour a day due to her fatigue, so outside of that she communicates via WhatsApp with shortened words and emojis. These are mostly to discuss soup choices and times for us to go up to do lunch/dinner etc. These are also ingenious as she describes the ingredients for a soup in a mix of emojis and broken words. For example the message:\n🥦, Cour toast🌽, 🤏 🥔, hard GC, thy\nTranslates to:\nBroccoli, courgette, toasted corn, a small amount of potato, hard goats cheese and thyme.\nHer mum and I translate these - mostly successfully - and when we discuss what Soph tells us we interestingly retell everything in full sentences. Maybe to humanise the conversations, to make them more like what Soph sounds like as we know she still is inside.\nI had no idea how much I rely on these tiny messages, until they become less regular or stopped altogether. You can spend an hour looking at your phone because you know she is going to message, and you worry that something catastrophic has happened. Last Wednesday when I was in Cornwall I did not hear from Soph after 5pm until the next morning. That had never happened before in several years of her being bedbound. She had a big crash and was just incapable of messaging. And knowing how desperate she is to message, how lonely she is lay alone in bed just makes it worse. I panicked, spiralled and took the Thursday off work.\nI send her maybe 5 or 6 voice messages a day telling her about the mundanities of my life in Cornwall. I try to take photos of baby animals, beaches, and sunsets to send to her. I receive back heart emojis and the broken words. I miss her voice. I miss her laugh. I miss her touch. I also feel pressure to maintain those voice messages, as it is the only voice she hears outside of her mum’s and dad’s in a day. I am prone to sending messages while pottering around, banging a door, or boiling the kettle, and that creates background noise that makes the message harder for Soph to listen to. I know I shouldn’t feel guilty, and yet I am trying to do better.\nThere are so many complexities about communication I cannot cover in a short post. How Soph’s mum discusses treatment options with her now I have no idea. How Karen and I have to discuss so many things about visiting and Soph because she does not have the energy to. How she must feel forgotten as she is not able to communicate with people she loves. How she feels so alone. The mutual frustration of me not being able to understand a sign and the obvious toll it takes on Soph’s energy to have to repeat it several times. Soph is extremely resourceful and incredible for being able to communicate despite everything. And I try so hard to try to understand because every message, sign, word is precious, a privilege to try to decipher. She is an incredible woman, fighting to survive and keep any semblance of a personal connection wherever she can.\nBelow is a video of the finger spelling alphabet. It might be useful for someone. ❤️"
  },
  {
    "objectID": "posts/caring_for_soph/index.html#the-worst-it-has-ever-been.",
    "href": "posts/caring_for_soph/index.html#the-worst-it-has-ever-been.",
    "title": "Caring for someone with severe ME",
    "section": "",
    "text": "Why do I always think it cannot get any worse? Wychwood Music Festival is on at the Racecourse two fields away from Soph’s house. The sound feels louder than previous years and now reverberates through her room. This makes her condition worse. The earplugs she uses do very little to help. She holds her hands to her ears in pain. She cannot move to another room. There is no escape. It is just something else that is relentless. Torture. Suffering. It is going to last three days. Each day compounds onto the next. She starts each new day relatively more poorly than the last, and all her energy needs to go into eating and doing the bare minimum. Since all of her energy is used up for surviving, there isn’t any left for actually living. No energy can be used for talking, engaging, being. I cannot fathom how lonely Soph must be. It is beyond heartbreaking. And through all this she thinks of other people. She asks me to leave because she does not want our time together - already limited in duration and scope - to be like this. She does not want me to see her like this. And yet maybe this is the new normal - at least for a bit. Post exertional malaise is unpredictable and we do not have a great track record of seeing Soph’s condition improve after big crashes. So maybe I will have to see her like this to be able to see her at all, at least for a bit. But we hope. As I write this on Sunday morning I don’t know whether I will see her today. Maybe I will stay and just cook soup for her, food for her family, and be around for emotional support for her parents. Maybe I will see her. I cannot ask Soph because she has no energy to answer. I am supposed to have a small holiday on Tuesday. Not really sure how.\nSoph’s mum rings people at the local council and gets a number for the local environment monitors who reassure her that they are well within their sound limits. But that isn’t the point. A loud music festival might be a slight annoyance for most people but it is brutal for Soph. No one understands. How can anyone understand how impossible life is for Soph and her family? They do amazing things everyday to survive and be the best they can be but severe ME is just incompatible with life sometimes. However much we try we cannot control everything.\nHere is a video of baby swans I saw to try and give me some level of happiness. Soph will love this video, but I do not know when she will have the energy to see it."
  },
  {
    "objectID": "posts/me_awareness_2024/index.html",
    "href": "posts/me_awareness_2024/index.html",
    "title": "ME Awareness Day 2024",
    "section": "",
    "text": "Today is ME awareness day.\nSoph and I have been together for 12 years. She is a speech therapist and the most extraordinary person I know. She is beautiful, darkly funny, stubborn, fiercely independent, and selfless. She loves cooking, watching the birds, poetry, flowers, dancing, eating, and countless other things. She still loves those things, she just now has to fight to just survive every second, minute, and hour, instead of living.\nBecause Soph has very severe ME and whole body neuropathic pain. She is currently bedbound, only managing to go to the bathroom every 2 weeks on average, and even that she does through pure stubbornness and force of will. Her pain is indescribable, but right now we watch her writhe and hear her wail as there is no respite. It is relentless. It is brutal. It is never ending. She sleeps for only one hour a night, but has nightmares about being stabbed because there is no escape from her pain. She lies in her bed 24 hours a day, in a darkened room, with sunglasses on due to her light sensitivity. She has sound and touch sensitivity. We have not kissed or hugged for several years. She is probably the poorliest person I - and most likely you reading this - will ever know or read about. And we (modern medicine and society as a whole) do not know how to treat people this severe. They get left and forgotten about. And when they’re so severe you do not hear from them, because Soph can barely use her phone due to fatigue and cognitive issues and mainly messages in emojis, only 4 or 5 times a day. It is traumatic and exhausting to try and put into words how ill she is, and I do not do it enough. This is me trying to do it more, maybe little and often will be easiest.\n\n\nLoving someone with severe ME and neuropathic pain.\nSeeing Soph is the worst part of my day\nI have never felt closer to her emotionally\nWhile never feeling further away from her physically\nI have never had so much to talk to her about\nWhile communication between us has never been so difficult\nHer heart has never been more full with love to give\nBut she has never been less able to show it to the world\nSoph has never been more vulnerable, poorly, and weak\nWhile never being stronger than she is right now to survive every day\nI still feel like I know her\nBut ME and the pain makes it harder and harder to see the glimpses of her\nBut when I see her eyes, or a tiny smile, seeing Soph is the best part of my day.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: A picture of me, Soph, and Copper in ~2016 (left), and Soph in 2020 (right)."
  },
  {
    "objectID": "posts/climate_spiral/index.html",
    "href": "posts/climate_spiral/index.html",
    "title": "Recreate Ed Hawkins’ climate spiral in R",
    "section": "",
    "text": "Climate change is happening, and changes in average temperatures are happening quickly. The 5 hottest years on record have occurred in the last six years for which we have data. One of the best ways to demonstrate climate warming is through data visualisations, and one of the best examples of this are Ed Hawkins’ climate stripes.\n\n\n\nEd Hawkins’ Climate Stripes\n\n\nThis visualisation is made up of vertical stripes, each representing the average temperature for a single year, relative to the average temperature over the whole period (from 1880 to the most recent year for which we have data). Blue colours indicate cooler-than-average years, while red colours indicate years that were hotter than average. As you can see, the increasing redness on the right-hand side of the graphic shows the rapid heating over recent years.\nI love the simplicity of this graphic, and it has proved a very effective tool for improving people’s awareness of climate warming (see the #climatestripes for amazing examples of its use across the world).\nI also loved the climate spiral animation created by Ed and re-created by NASA to help people understand the concept of global warming and the change in global temperatures over time. The spiral presents a visual representation of temperature changes over the past century or more, by showing a line that spirals outwards from the center of the graph as time progresses.\n\nIn the centre of the spiral is the average temperature of a baseline period, typically the 20th century average. As the line moves outwards, the temperature increases, with each full rotation of the spiral representing one year of data. The thickness of the line represents the magnitude of the temperature change in each year, with thicker lines indicating larger temperature increases.\nHaving played with ggplot2 and gganimate a bit, I was interested if I could recreate this animation in R (unfortunately without the amazing axis flip at the end)!"
  },
  {
    "objectID": "posts/climate_spiral/index.html#introduction",
    "href": "posts/climate_spiral/index.html#introduction",
    "title": "Recreate Ed Hawkins’ climate spiral in R",
    "section": "",
    "text": "Climate change is happening, and changes in average temperatures are happening quickly. The 5 hottest years on record have occurred in the last six years for which we have data. One of the best ways to demonstrate climate warming is through data visualisations, and one of the best examples of this are Ed Hawkins’ climate stripes.\n\n\n\nEd Hawkins’ Climate Stripes\n\n\nThis visualisation is made up of vertical stripes, each representing the average temperature for a single year, relative to the average temperature over the whole period (from 1880 to the most recent year for which we have data). Blue colours indicate cooler-than-average years, while red colours indicate years that were hotter than average. As you can see, the increasing redness on the right-hand side of the graphic shows the rapid heating over recent years.\nI love the simplicity of this graphic, and it has proved a very effective tool for improving people’s awareness of climate warming (see the #climatestripes for amazing examples of its use across the world).\nI also loved the climate spiral animation created by Ed and re-created by NASA to help people understand the concept of global warming and the change in global temperatures over time. The spiral presents a visual representation of temperature changes over the past century or more, by showing a line that spirals outwards from the center of the graph as time progresses.\n\nIn the centre of the spiral is the average temperature of a baseline period, typically the 20th century average. As the line moves outwards, the temperature increases, with each full rotation of the spiral representing one year of data. The thickness of the line represents the magnitude of the temperature change in each year, with thicker lines indicating larger temperature increases.\nHaving played with ggplot2 and gganimate a bit, I was interested if I could recreate this animation in R (unfortunately without the amazing axis flip at the end)!"
  },
  {
    "objectID": "posts/climate_spiral/index.html#make-the-climate-spiral-in-r",
    "href": "posts/climate_spiral/index.html#make-the-climate-spiral-in-r",
    "title": "Recreate Ed Hawkins’ climate spiral in R",
    "section": "Make the climate spiral in R",
    "text": "Make the climate spiral in R\nAt the time of writing this blog post, using gganimate for geom_path() and transition_reveal() is unfortunately bugged in version 1.0.8, meaning that some frames would be missing. As such we will install a previous version (1.0.7).\nThis post will walkthrough how to recreate Ed Hawkins’ famous climate spiral in R. We will mainly use the tidyverse packages and gganimate to do this. Firstly we will load in these required packages.\n\n# load packages\nlibrary(tidyverse)\nlibrary(gganimate) # remotes::install_github('thomasp85/gganimate@v1.0.7')\nlibrary(janitor)\nlibrary(MetBrewer)\nlibrary(ggforce)\n\nWe can next load in the dataset used from the NASA website.\n\n# load in dataset from NASA\nd &lt;- read.csv('https://data.giss.nasa.gov/gistemp/tabledata_v4/GLB.Ts+dSST.csv', skip = 1)\nhead(d)\n\n  Year   Jan  Feb  Mar  Apr  May  Jun  Jul  Aug  Sep  Oct  Nov  Dec  J.D  D.N\n1 1880 -0.18 -.24 -.09 -.16 -.10 -.21 -.18 -.10 -.15 -.23 -.22 -.17 -.17  ***\n2 1881 -0.19 -.14  .03  .05  .06 -.18  .00 -.03 -.15 -.22 -.18 -.07 -.09 -.09\n3 1882  0.16  .14  .04 -.16 -.14 -.22 -.17 -.08 -.15 -.23 -.17 -.36 -.11 -.09\n4 1883 -0.29 -.37 -.12 -.18 -.18 -.07 -.07 -.14 -.22 -.11 -.24 -.11 -.18 -.20\n5 1884 -0.13 -.08 -.36 -.40 -.34 -.35 -.30 -.28 -.27 -.25 -.33 -.31 -.28 -.27\n6 1885 -0.58 -.33 -.26 -.42 -.45 -.43 -.34 -.31 -.28 -.23 -.24 -.10 -.33 -.35\n   DJF  MAM  JJA  SON\n1  *** -.11 -.16 -.20\n2 -.17  .05 -.07 -.18\n3  .08 -.08 -.16 -.18\n4 -.34 -.16 -.10 -.19\n5 -.11 -.37 -.31 -.28\n6 -.41 -.38 -.36 -.25\n\n\nThis dataset has month across the top with some other columns I do not necessarily understand, and the values in the month columns are the temperature anomaly. Right now all the columns have been read in character format, so we can do some data wrangling to get the data in the correct format for ggplot2. This includes going from wide to long format, stacking all the months on top of each other in a single column.\nThese commands could all be linked together using successive pipe commands, but I kept them separate to better document what each line is doing.\n\n# wrangle the data set\n# make all columns numeric - there are some *** that i dont know what they mean\nd &lt;- mutate(d, across(everything(), as.numeric))\n\n# replace NAs with 0 - just make them to have no positive or negative anomaly\nd &lt;- mutate(d, across(everything(), ~(replace_na(.x, 0))))\n\n# tidy the dataframe\nd &lt;- janitor::clean_names(d) %&gt;%\n  pivot_longer(cols = jan:dec, names_to = 'month', values_to = 'anomaly')\n\n# add a time column\nd &lt;- mutate(d, time = paste(year, toupper(month), sep = '-'),\n            time = lubridate::ym(time),\n            month2 = lubridate::month(time)) %&gt;%\n  # select only necessary columns\n  select(year, month, month2, time, anomaly)\n\n# look at dataset\nhead(d)\n\n# A tibble: 6 × 5\n   year month month2 time       anomaly\n  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;date&gt;       &lt;dbl&gt;\n1  1880 jan        1 1880-01-01   -0.18\n2  1880 feb        2 1880-02-01   -0.24\n3  1880 mar        3 1880-03-01   -0.09\n4  1880 apr        4 1880-04-01   -0.16\n5  1880 may        5 1880-05-01   -0.1 \n6  1880 jun        6 1880-06-01   -0.21\n\n\nThe most recent data in the spreadsheet from 2023, but we will remove this at the moment because it is mid-year.\n\n# remove 2023\nd &lt;- filter(d, year &lt; 2023)\n\nWe are now ready to make our first plot. I have chosen a MetBrewer colour palette which goes from blue to red to represent the hot and cold colours. For the plot I will use a theme I defined previously in a random R package called theme_black() (lots of other themes are available).\n\n# create first plot\np1 &lt;- ggplot(d, aes(month2, anomaly, col = anomaly)) +\n  geom_line(aes(group = year)) +\n  scale_color_gradientn('Temperature anomaly', colors = met.brewer(name='Homer1', direction=-1, override.order = FALSE)) +\n  MicrobioUoE::theme_black() +\n  theme(panel.grid.major = element_blank(),\n        axis.title.x = element_blank()) +\n  scale_x_continuous(breaks = 1:12, labels = c('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'))\n\np1 + coord_polar()\n\n\n\n\n\n\n\n\nThis is looking quite good, but still quite far from the polished version on NASA’s YouTube. One of the problems we have is that geom_path() will not cross over the 0-360 line when using coord_polar(). This would ruin the whole visualisation and prevent us having a smooth transition from year to year. This was a problem I was not clever enough to solve, but luckily StackOverflow had the answer. We need to convert the polar coordinates to cartesian to allow the animation to go from December to January of the next year.\n\n# want to convert polar coordinates to cartesian to allow animation to go from December back to January\n# using this link https://stackoverflow.com/questions/55132352/geom-path-refuses-to-cross-over-the-0-360-line-in-coord-polar\n\n# calculate angles for each month, starting with January at 15º\nangles &lt;- tibble(month = unique(d$month),\n            angle = seq(15, by = 30, length.out = 12))\n\nd &lt;- left_join(d, angles)\n\nhead(d)\n\n# A tibble: 6 × 6\n   year month month2 time       anomaly angle\n  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt;\n1  1880 jan        1 1880-01-01   -0.18    15\n2  1880 feb        2 1880-02-01   -0.24    45\n3  1880 mar        3 1880-03-01   -0.09    75\n4  1880 apr        4 1880-04-01   -0.16   105\n5  1880 may        5 1880-05-01   -0.1    135\n6  1880 jun        6 1880-06-01   -0.21   165\n\n# add buffer to make everything positive - this can be anything really\nbuffer &lt;- 3\n\n# calculate the position in x/y space for each anomaly using maths!!!\nd &lt;- mutate(d, x_anomaly = sin(pi * angle/180) * (anomaly + buffer),\n               y_anomaly = cos(pi * angle/180) * (anomaly + buffer))\n\nhead(d)\n\n# A tibble: 6 × 8\n   year month month2 time       anomaly angle x_anomaly y_anomaly\n  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n1  1880 jan        1 1880-01-01   -0.18    15     0.730     2.72 \n2  1880 feb        2 1880-02-01   -0.24    45     1.95      1.95 \n3  1880 mar        3 1880-03-01   -0.09    75     2.81      0.753\n4  1880 apr        4 1880-04-01   -0.16   105     2.74     -0.735\n5  1880 may        5 1880-05-01   -0.1    135     2.05     -2.05 \n6  1880 jun        6 1880-06-01   -0.21   165     0.722    -2.69 \n\n\nWe now have the position of each anomaly for each month in x/y space. This should allow the animation to smoothly move between December of one year to January of the next.\nOur original plot also does not have very nice labelling to tell us anything about the extent of the anomaly (1ºC above or below average etc.)\nHowever, we can add these ourselves by using some functions from ggforce to create circles on our plot and labelling them. We also create a dataframe to place the months at a nicer place on the plot.\nWe can control the font size of geom_text() in terms of font size used in the rest of the plot using the pts() function that I copied from Andrew Heiss.\n\n# create limits\nlimits &lt;- c(-(max(d$anomaly) + buffer), max(d$anomaly) + buffer)\n\n# create circles for some temperatures\ncircles &lt;- data.frame(\n  r = c(buffer, buffer + 1, buffer - 1)) %&gt;%\n  mutate(r = round(r, 0),\n         x0 = 0,\n         y0 = 0,\n         label = c('0ºC', '+1ºC', '-1ºC'))\n\n# create dataset for months to be added to the plot\nmonths &lt;- mutate(angles, anomaly = limits[2] + limits[2] * .1,\n                 x_anomaly = sin(pi * angle/180) * anomaly,\n                 y_anomaly = cos(pi * angle/180) * anomaly)\n\n# increase limits slightly\nlimits &lt;- limits + limits*.1\n\n# create base plot\np1 &lt;- ggplot(d, aes(x_anomaly, y_anomaly)) +\n  scale_x_continuous(limits = limits) +\n  scale_y_continuous(limits = limits) +\n  ggforce::theme_no_axes() +\n  theme(panel.background = element_rect(fill = 'black'), \n        legend.position = 'none') +\n  geom_text(aes(x_anomaly, y_anomaly, label = month), data = months, col = 'white', size = MicrobioUoE::pts(18)) +\n  geom_path(aes(col = anomaly), alpha = 0.9) +\n  scale_color_gradientn('Temperature anomaly', colors = met.brewer(name='Homer1', direction=-1, override.order = F)) +\n  ggforce::geom_circle(aes(x0 = x0, y0 = y0, r = r, linewidth = I(1.5)), fill = NA, data = circles, inherit.aes = FALSE,col = 'white') +\n  geom_label(aes(x0, r, label = label), circles, fill = 'white', size = MicrobioUoE::pts(18)) +\n  coord_equal() +\n  geom_text(aes(x = 0, y = 0, label = year, col = anomaly), size = MicrobioUoE::pts(30))\n\np1\n\n\n\n\n\n\n\n\nThis looks great and more like what NASA created. We can easily animate this using gganimate::transition_reveal() and adding the column for time that we created earlier.\nWe can add a frame for every single row of the dataframe using nframes = nrow(d). We will also add a point to make it more obvious where we are at any given time.\n\n# add animation layer using gganimate\np_anim &lt;- p1 +\n  geom_point(shape = 21, fill = 'green', data = d, size = 4, col = 'white') +\n  transition_reveal(time)\n\n# save out the animation\nanim_save(filename = 'posts/climate_spiral/climate_spiral.gif', p_anim, nframes = nrow(d), duration = 45, width = 5.5, height = 6, units = 'in', renderer = gifski_renderer(), res = 150)\n\n\nThis looks amazing! There are probably ways I could improve the animation but this suits my motivations right now. For example, I have not linked the size of the line to the extent of the change, but this should be relatively easy to implement.\nI generally love this type of visualisation, and the spiral could be used on other data, such as atmospheric carbon dioxide levels or Arctic sea ice extent, to show how these variables have changed through time. By presenting data in this way, the Climate Spiral helps people to understand the steady, consistent increase in global temperatures over time, and the urgency of addressing climate change.\nLet me know if you found this helpful and if you any questions!"
  },
  {
    "objectID": "posts/rolling_regression/index.html",
    "href": "posts/rolling_regression/index.html",
    "title": "Rolling regression to estimate microbial growth rate",
    "section": "",
    "text": "Introduction\nMicrobial ecologists often measure the growth rates of their favourite microbes, commonly using an OD (optical density) reader, with growth being related to the increasing OD of the sample through time. There are loads of ways to analyse these curves. Most of these, like growthcurver and the methods I used in my recent ISME paper (nls.multstart and functions from nlsMicrobio), fit models to logistic growth. Both methods can easily be scaled up to fit multiple curves at the same time.\nHowever, sometimes these methods do not do a good job. The most common example when this happens is if the wee critters do not reach stationary phase. Without stationary phase, most of the models will struggle to calculate carrying capacity, which also means the estimated exponential growth rate is poor. Similar things can occur if the bacteria form biofilms. This can result in increasingly noisy measurements at higher OD readings, again making the estimation of carrying capacity and growth rates more difficult.\nAs an alternative, we can bin off trying to model the entire growth curve, and instead implement a rolling regression, where we fit a linear regression on a shifting window of points. On natural-log transformed OD, the slope of the regression between \\(logOD\\) and time is equivalent to the exponential growth rate.\n\n\nGet started\nWe will load (and install) all the packages needed to run the example here. We will use the example data from growthcurver as example OD readings from a 96-well plate. Time is in hours, and I have created stacked all the wells into a single column for OD. Finally I created a column for \\(logOD\\), which is needed for the rolling regression, and \\(log_{10}OD\\) which is needed for fitting the modified gompertz growth model from nlsMicrobio.\n\n# load packages\nlibrary(tidyverse) #install.packages(tidyverse)\nlibrary(zoo) #install.packages(zoo)\nlibrary(broom) #install.packages(broom)\nlibrary(growthcurver) # install.packages(growthcurver)\nlibrary(nls.multstart) # install.packages(nls.multstart)\n# remotes::install_github('padpadpadpad/MicrobioUoE)\n\n# load example data\nd &lt;- growthcurver::growthdata %&gt;%\n  gather(., well, od, -time) %&gt;%\n  mutate(ln_od = log(od),\n         log10_od = log10(od))\n# have a look at the data\nglimpse(d)\n\nRows: 13,920\nColumns: 5\n$ time     &lt;dbl&gt; 0.0000000, 0.1666667, 0.3333333, 0.5000000, 0.6666667, 0.8333…\n$ well     &lt;chr&gt; \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"…\n$ od       &lt;dbl&gt; 0.05348585, 0.04800336, 0.05587451, 0.05131749, 0.04516719, 0…\n$ ln_od    &lt;dbl&gt; -2.928338, -3.036484, -2.884647, -2.969724, -3.097384, -2.938…\n$ log10_od &lt;dbl&gt; -1.271761, -1.318728, -1.252786, -1.289735, -1.345177, -1.276…\n\n\n\n\nFit modified gompertz model for bacterial growth\nWe will first demonstrate rolling regression against the modified gompertz model for growth. I like the inclusion of the lag parameter in this model, especially for OD readers where the initial inoculate can often be so low that the OD reader cannot measure it. It means that exponential growth is only calculated at OD readings that we are confident represent changes in biomass of the bacteria.\nTo do this, we’ll filter the data for just the first well, A1. Then we will fit the modified gompertz model and plot the results.\n\n# filter for just a single well\nd_a1 &lt;- filter(d, well == 'A1')\n# define gompertz growth model\ngompertz &lt;- function(log10_nmax, log10_n0, mumax, t, lag){\n  log10_n0 + (log10_nmax - log10_n0) * exp(-exp(mumax * exp(1) * (lag - t)/((log10_nmax - log10_n0) * log(10)) + 1))\n}\n# fit gompertz model\nfit_gomp &lt;- nls.multstart::nls_multstart(log10_od ~ gompertz(log10_nmax, log10_n0, mumax, t = time, lag),\n           data = d_a1,\n           start_lower = c(log10_nmax = -0.75, log10_n0 = -3, mumax = 0, lag = 0),\n           start_upper = c(log10_nmax = 0.5, log10_n0 = -1, mumax = 10, lag = 25),\n           lower = c(log10_nmax = -0.6, log10_n0 = -2, mumax = 0, lag = 0),\n           iter = 500,\n           supp_errors = 'Y')\n# get predictions\ngomp_preds &lt;- augment(fit_gomp)\n# plot on original scale\nggplot(d_a1, aes(time, od)) +\n  geom_line(aes(time, 10^.fitted), gomp_preds, col = 'red') +\n  geom_point() +\n  theme_bw(base_size = 16) +\n  labs(x = 'time (hours)',\n       y = 'OD') +\n  annotate(geom = 'text', x = 0, y = 0.37, label = paste('µ = ', round(coef(fit_gomp)[3], 2), ' hr-1', sep = ''), hjust = 0, size = MicrobioUoE::pts(16))\n\n\n\n\n\n\n\n\nHowever, lets say our measurements end at 10 or 11 hours. When we have not reached stationary phase, the traditional bacterial growth models are likely to have trouble fitting.\n\nd_a1 &lt;- filter(d_a1, time &lt; 10.5)\n# plot data without stationary phase\nggplot(d_a1, aes(time, od)) +\n  geom_point() +\n  theme_bw(base_size = 16) +\n  labs(x = 'time (hours)',\n       y = 'OD')\n\n\n\n\n\n\n\n\n\n\nUsing rolling regression\nRolling regression allows us to calculate exponential growth rate even when we do not have the whole curve. First, we need to create our own rolling regression function. This method is mainly taken from G. Grothendieck’s StackOverflow answer. In the function, we specify our output from a standard lm object. So if you know how to access the output of lm(), you can add any extra details you want.\nOne of the big decisions in rolling regression is deciding how many points you are going to calculate the growth rate over. In this example, measurements are taken every 0.167 hours, about every ten minutes. I want a shifting window to span a minimum of 1.5 hours, so I calculate num_points to define the number of points the rolling regression will act on.\nWe then run the rolling regression, using zoo::rollapplyr() and dplyr::do(). Finally, in order to illustrate what the rolling regression is doing, I created a predictions dataframe for every single linear model that is fitted.\n\n# create the rolling regression function\nroll_regress &lt;- function(x){\n  temp &lt;- data.frame(x)\n  mod &lt;- lm(temp)\n  temp &lt;- data.frame(slope = coef(mod)[[2]],\n                     slope_lwr = confint(mod)[2, ][[1]],\n                     slope_upr = confint(mod)[2, ][[2]],\n                     intercept = coef(mod)[[1]],\n                     rsq = summary(mod)$r.squared, stringsAsFactors = FALSE)\n  return(temp)\n}\n# define window - here every ~1.5 hours\nnum_points = ceiling(1.5*60/(60*0.167)) \n\n# run rolling regression on ln od ~ time\nmodels &lt;- d_a1 %&gt;%\n  do(cbind(model = dplyr::select(., ln_od, time) %&gt;% \n           zoo::rollapplyr(width = num_points, roll_regress, by.column = FALSE, fill = NA, align = 'center'),\n           time = dplyr::select(., time),\n           ln_od = dplyr::select(., ln_od))) %&gt;%\n  rename_all(., gsub, pattern = 'model.', replacement = '')\n# create predictions\npreds &lt;- models %&gt;%\n  filter(., !is.na(slope)) %&gt;%\n  group_by(time) %&gt;%\n  do(data.frame(time2 = c(.$time - 2, .$time + 2))) %&gt;%\n  left_join(., models) %&gt;%\n  mutate(pred = (slope*time2) + intercept)\n\nWe can plot the rolling regression through time. I have extracted the exponential growth rate as the maximum slope of any of the regressions. Reassuringly the value of \\(\\mu\\) we get is very similar to that of using the gompertz model. I have also plotted the time at which the maximum slope occurred. It looks pretty close to mid-log to me.\n\n# calculate the exponential growth rate\ngrowth_rate &lt;- filter(models, slope == max(slope, na.rm = TRUE))\n# plot rolling regression\nggplot(d_a1, aes(time, ln_od)) +\n  geom_point() +\n  geom_line(aes(time2, pred, group = time), col = 'red', preds, alpha = 0.5) +\n  theme_bw(base_size = 16) +\n  geom_segment(aes(x = time, y = -3, xend = time, yend = ln_od), growth_rate) +\n  geom_segment(aes(x = 0, y = ln_od, xend = time, yend = ln_od), growth_rate) +\n  annotate(geom = 'text', x = 0, y = -1, label = paste('µ = ', round(growth_rate$slope, 2), ' hr-1\\n95%CI:(',round(growth_rate$slope_lwr, 2), '-', round(growth_rate$slope_upr, 2), ')', sep = ''), hjust = 0, size = MicrobioUoE::pts(16)) +\n  labs(x = 'time (hours)',\n       y = 'OD')\n\n\n\n\n\n\n\n\n\n\nThe opportunities are endless\nThe great thing about this approach is its flexibility. It can easily be rolled out over all the wells in that plate, using group_by().\n\n# run rolling regression on ln od_cor ~ time\nmodels &lt;- d %&gt;%\n  group_by(well) %&gt;%\n  do(cbind(model = select(., ln_od, time) %&gt;% \n           zoo::rollapplyr(width = num_points, roll_regress, by.column = FALSE, fill = NA, align = 'center'),\n           time = select(., time),\n           ln_od = select(., ln_od))) %&gt;%\n  rename_all(., gsub, pattern = 'model.', replacement = '')\n# calculate growth rate for each one\ngrowth_rates &lt;- models %&gt;%\n  filter(slope == max(slope, na.rm = TRUE)) %&gt;%\n  ungroup()\n\n|===========================================|100% ~0 s remaining \n\nglimpse(models)\n\nRows: 13,920\nColumns: 8\nGroups: well [96]\n$ well      &lt;chr&gt; \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", …\n$ slope     &lt;dbl&gt; NA, NA, NA, NA, -0.077427705, -0.028208492, -0.021245636, 0.…\n$ slope_lwr &lt;dbl&gt; NA, NA, NA, NA, -0.199773163, -0.160658493, -0.157480637, -0…\n$ slope_upr &lt;dbl&gt; NA, NA, NA, NA, 0.04491775, 0.10424151, 0.11498936, 0.131953…\n$ intercept &lt;dbl&gt; NA, NA, NA, NA, -2.944791, -2.976248, -2.967393, -3.024750, …\n$ rsq       &lt;dbl&gt; NA, NA, NA, NA, 0.2423791383, 0.0349643445, 0.0190560342, 0.…\n$ time      &lt;dbl&gt; 0.0000000, 0.1666667, 0.3333333, 0.5000000, 0.6666667, 0.833…\n$ ln_od     &lt;dbl&gt; -2.928338, -3.036484, -2.884647, -2.969724, -3.097384, -2.93…\n\n\nThese growth rates can then be used for downstream analyses, and the method can easily be used over multiple plates and for many different types of data. Finally, you could also filter the regressions by \\(R^{2}\\) values, making sure you only kept good fitting regressions. Or do a sensitivity analysis of different sized window sizes to make sure your chosen window is suitable.\nHow do you get your data off of the OD reader? I have written scripts to collate hundreds of plate readings into a single dataframe in R. Let me know if you would like me to do a blog post on that process! Thanks for reading."
  },
  {
    "objectID": "posts/ena_file_submission/index.html",
    "href": "posts/ena_file_submission/index.html",
    "title": "Submitting files to ENA",
    "section": "",
    "text": "The European Nucleotide Archive (ENA) provides a comprehensive record of the world’s nucleotide sequencing information, covering raw sequencing data, sequence assembly information and functional annotation. I always find it so painful to submit to ENA. I do it so rarely (maybe once or twice a year) that by the time I come to do it again, I have forgotten how to do it. The ENA documentation is quite good, but it is not always clear what you need to do. I have written this post to help me remember how to submit files using the Webin-CLI software and hopefully help others who are in a similar position.\nSo I assume that you have stumbled across this post in a similar position: you have a bunch of sequencing data you want to submit to ENA. Throughout this post, I will reference the online documentation provided by the ENA, and you will need to signup to the interactive Webin submission service and download the Webin command line submission interface (Webin-CLI).\nOverall the process for submitting sequencing files can be summarised as:\n\nRegister a study (interactive online)\nRegister samples (interactive online and using Excel)\nCreate sample metadata (using Excel)\nMake individual manifest files for each sample (I use R)\nRename files if needed (I use R)\nSubmit samples (using bash and Webin-CLI)"
  },
  {
    "objectID": "posts/ena_file_submission/index.html#introduction",
    "href": "posts/ena_file_submission/index.html#introduction",
    "title": "Submitting files to ENA",
    "section": "",
    "text": "The European Nucleotide Archive (ENA) provides a comprehensive record of the world’s nucleotide sequencing information, covering raw sequencing data, sequence assembly information and functional annotation. I always find it so painful to submit to ENA. I do it so rarely (maybe once or twice a year) that by the time I come to do it again, I have forgotten how to do it. The ENA documentation is quite good, but it is not always clear what you need to do. I have written this post to help me remember how to submit files using the Webin-CLI software and hopefully help others who are in a similar position.\nSo I assume that you have stumbled across this post in a similar position: you have a bunch of sequencing data you want to submit to ENA. Throughout this post, I will reference the online documentation provided by the ENA, and you will need to signup to the interactive Webin submission service and download the Webin command line submission interface (Webin-CLI).\nOverall the process for submitting sequencing files can be summarised as:\n\nRegister a study (interactive online)\nRegister samples (interactive online and using Excel)\nCreate sample metadata (using Excel)\nMake individual manifest files for each sample (I use R)\nRename files if needed (I use R)\nSubmit samples (using bash and Webin-CLI)"
  },
  {
    "objectID": "posts/ena_file_submission/index.html#submitting-files-to-ena",
    "href": "posts/ena_file_submission/index.html#submitting-files-to-ena",
    "title": "Submitting files to ENA",
    "section": "Submitting files to ENA",
    "text": "Submitting files to ENA\nWe will go through each one to summarise the main steps and things I often get wrong.\n\n1. Register study using the interactive interface\nThe first thing to do is to register your study. This is easiest to do interactively on the Webin Submissions Portal and the ENA have a help page on this here. The Register Study link is currently found towards the top left of the page.\n\n\n\nENA submission portal\n\n\nThis is the easiest bit of the process and probably the only part that doesn’t take me several attempts. If submitting sequences from a study that is nearing publication, you can enter the study title and the abstract. The release date of the study is when all the sequences will become public. I generally put this for a week after I started the process to allow me to make many mistakes, but post submission you can always bring this date forward. Citations can be added at a later date, so it is possible to submit sequencing before the work is published.\nMake a note of the Accession Number for your study as it will be used later (should start with PRJEB).\n\n\n2. Register samples using the interactive interface\nA sample is sequenced biomaterial, and we need to register samples to make sure each sample has metadata associated with it. Samples are associated with checklists, which define the fields used to annotate the samples. The ENA help page for this is quite good.\nWhen using the interactive submission portal, you need to click through to Register Samples and then click Download spreadsheet to register samples. There are many different standardised sheets to choose from which should help provide consistent metadata that will allow for better reporting of datasets in the future.\nHowever, as most of the sequencing I upload are from bespoke, controlled experiments in the lab, I have generally only used the ENA default sample checklist which is within Other Checklists There are some fields that are mandatory for that checklist. What they are, and their definition is displayed after you have clicked on your checklist.\n\n\n\nENA sample fields for default sample checklist\n\n\nIf there are extra fields you want to add, then add them, otherwise click Next and click Download Template Spreadsheet, which will download a .tsv file that contains the minimum required fields for the ENA sample register. When opened in Excel (the horror), this will look something like this.\n\n\n\nEmpty ENA samples checklist\n\n\nYou can then fill out your samples checklist. There is some key advice from the ENA documentation when filling out this spreadsheet:\n\nDo not remove or modify, the first three lines of the spreadsheet, which specify the checklist in use, field names, and units row.\nEnter data in row 4 of the spreadsheet onwards. Use row 3 (#units) to specify units where required by the checklist.\nYou can add custom fields by inserting new column headers\nDo not edit the existing column names\n\nFrom doing this a few times, I have my own advice for future me that past me learned the hard way:\n\nEvery sample is always associated with a taxon, which is inputted into the tax_id column and then the scientific_name column. I use the NCBI taxonomy browser to find the correct taxon. For example, sediment metagenome has the taxonomy ID of 749907.\nWhen inputting numbers into Excel, when you double click them to go autofill, they often follow a numeric rule (x+1) or something. Copy and paste the same number into the cell below, and then double click them both to autofill and this does not happen.\nEach sample needs to have its each individual row. The sample_alias column needs to be a unique identifier to identify that sample. It is unique to ALL future submissions too so make sure you label them in relation to the study AND the sample. For example for a recent project on Myxobacteria I started all of them with myxo_16s_s1 or myxo_rpoB_1 etc. All the other columns are relative self explanatory. You can also add metadata columns. An example completed file - saved as a.txt\\ might look something like this.\nI generally have the same name for the sample_title as I do for the sample_alias.\nIn the sample_description column, I generally put what sequencing was done.\nFor most studies, I also add extra columns that are unique to the study and represent treatments and extra data that is interesting and needed to best understand the files. For example, I added columns about what predefined habitat the samples came from and what biome the sample was classified as. I also added metadata collected by a collaborator on where the sample was taken and the latitude and longitude.\n\nMy most recent sample checklist looked like this:\n\n\n\nComplete ENA samples checklist\n\n\nOnce completed, this file can be uploaded to the ENA interactive web portal by clicking Register Samples -&gt; Upload filled spreadsheet to register samples and then Submit Completed Spreadsheet after you have chosen your file. The portal will tell you if you are successful which means you can move on to the next stage.\n\n\n3. Create sample metadata\nAfter doing steps 1 and 2, you should receive emails containing the Accession Numbers of your experiment and of your samples. These need to be included in a manifest file that is required for the submission of each sample to ENA. Details on the manifest file can be found here.\nThe information needed for each sample may change based on what files are being uploaded. For paired end fastq reads, they are generally:\n\nSTUDY: Study Accession Number, from Step 1.\nSAMPLE: Sample Accession Number, from Step 2.\nNAME: Experiment name, which I generally use the same as the sample_alias.\nPLATFORM: Sequencing platform\nINSTRUMENT: Sequencing instrument\nINSERT_SIZE: Size of the sequence is the length of the sequence between the adapter sequences.\nLIBRARY_SOURCE: What type of information was sequenced? DNA, RNA, etc.\nLIBRARY_SELECTION: Library selection. What selection was done on the DNA? PCR, random, etc.\nLIBRARY_STRATEGY: Library strategy. What type of sequencing stratedy was done? WGS, RNA-Seq, etc.\nFASTQ: File name of forward fastq file\nFASTQ: File name of reverse fastq file\n\nI generally create another Excel file, with these values as column names, where I document all the samples from a study. I call this sample_metadata.csv, and my most recent one looks like this.\n\n\n\nExample sample metadata\n\n\nI leave the fastq columns blank because I am going to rename the files before uploading to be the same as the sample_alias.\n\n\n4. Create manifest files for each sample\nEach sample needs its own manifest file, so I use R to create manifest files from the sample_metadata.csv file. We want to make a manifest file for each row of the spreadsheet.\nTo reiterate, I try to use the sample_alias as a unique ID for each manifest file and fastq file linked to the that sample. So I will name each manifest file as the sample_alias.txt, and then rename the fastq files to be the same as the sample_alias_R1/R2.fastq.gz.\nExample code to do this could be:\n\n# create single manifest file for each sample from a sample metadata file\n\n# load in tidyverse\nlibrary(tidyverse)\n\n# read in sample metadata column\nfiles &lt;- read.csv('ena_submission/sample_metadata.csv') %&gt;%\n  # make numeric columns character so that pivot longer works\n  mutate(across(where(is.numeric), as.character))\n\n# create single manifest file for each row\n# run a for loop\nfor(i in 1:nrow(files)){\n  \n  # grab the first row\n  temp &lt;- files[i,]\n  \n  # go from wide to long format\n  temp &lt;- pivot_longer(temp, cols = everything())    \n  \n  # grab the file name from the NAME row (third element)\n  file_name &lt;- temp$value[3]\n  \n  # rename the fastq columns FASTQ\n  temp$name[10:11] &lt;- 'FASTQ'\n  temp &lt;- temp[1:11,]\n  \n  # name the fastq files R1 and R2 and the file name\n  temp$value[10] &lt;- paste(file_name, '_R1.fastq.gz', sep = '')\n  temp$value[11] &lt;- paste(file_name, '_R2.fastq.gz', sep = '')\n  \n  # save it out\n  # need to create a folder for your manifest files\n  write.table(temp, paste('manifest_files/', file_name, '.txt', sep = ''), row.names = FALSE, col.names = FALSE, quote = FALSE)\n}\n\nThis should result in you having a unique manifest file for each of your samples that you registered.\nAn example of the top row from my most recent submission is a file created called myxo_16s_s1.txt. Its contents are:\nSTUDY PRJEB73761\nSAMPLE ERS18415308\nNAME myxo_16s_s1\nPLATFORM ILLUMINA\nINSTRUMENT Illumina MiSeq\nINSERT_SIZE 300\nLIBRARY_SOURCE GENOMIC\nLIBRARY_SELECTION PCR\nLIBRARY_STRATEGY AMPLICON\nFASTQ myxo_16s_s1_R1.fastq.gz\nFASTQ myxo_16s_s1_R2.fastq.gz\n\n\n5. Submit samples\nOnce you have your manifest files, you can submit them to ENA. However, it is likely that before you do this you may need to rename your files to match the names you specified in the FASTQ values of each manifest file. This is because the manifest file will be looking for files with those names in the directory where you specify the fastq files are.\nSo I have started creating a new folder called ena_upload where I copy and rename the samples to for ena submission. These can then be deleted after submission is successful.\nI do file renaming in R, and this is likely to be bespoke for each project and how you have named your sample aliases. In case there are mistakes down the line in your file renaming or submission - or you find that some files do not have the metadata you thought they had - it might be useful to save out a csv with all the original names and the new names.\nAn example of what this might look like is:\n\n# rename files for ena upload\n\n# list manifest files names\nmanifest_files &lt;- list.files('manifest_files', full.names = TRUE)\n\n# list the sequencing files to rename\nfiles &lt;- list.files('where_the_raw_files_live', full.names = TRUE, pattern = 'fastq|fq', recursive = TRUE)\n\n# empty dataframe to populate original file names and new file names\nd_files &lt;- data.frame(manifest_file = rep(basename(manifest_files), each = 2)) %&gt;%\n  mutate(original_file = NA, new_file = NA)\n\n# write for loop ro rename files\nfor(i in 1:length(manifest_files)){\n  \n  # grab the first row\n  temp &lt;- d[i,]\n  \n  # grab the ith manifest fuke\n  temp &lt;- manifest_files[i]\n  \n  # remove file extension\n  temp &lt;- tools::file_path_sans_ext(temp)\n  \n  # in this example, the sample identifier is the s1 part, so I will grab that\n  # this bit needs to allow you to find the sequencing files - given the current naming - that relate to that manifest file\n  temp_num &lt;- str_split(temp, '_')[[1]][3]\n  \n  # find the sequencing files that link to that manifest file\n  files_temp &lt;- files[str_detect(basename(files), paste(temp_num, '_', sep = ''))]\n  \n  # rename files for ena upload\n  # for R1 file\n\n  file.copy(files_temp[str_detect(basename(files_temp), 'R1')], paste('~/ena_upload/', temp, '_R1.fastq.gz', sep = ''))\n  # for R2 file\n  file.copy(files_temp[str_detect(basename(files_temp), 'R2')], paste('~/ena_upload/', temp, '_R2.fastq.gz', sep = ''))\n  \n  # populate d_files\n  d_files$original_file[(2*i)] &lt;- basename(files_temp[str_detect(basename(files_temp), 'R1')])\n  d_files$original_file[(2*i)+1] &lt;- basename(files_temp[str_detect(basename(files_temp), 'R2')])\n  d_files$new_file[(2*i)] &lt;- paste(temp, '_R1.fastq.gz', sep = '')\n  d_files$new_file[(2*i)+1] &lt;- paste(temp, '_R2.fastq.gz', sep = '')\n}\n\n# save out csv containing old and new names\nwrite.csv(d_files, 'file_renaming.csv', row.names = FALSE)\n\nThis should result in the sequencing files being renamed to match the names specified in the manifest files. We should then be able to upload them to ENA. I use the ENA webin-cli tool to do this. You can find the documentation for this tool here.\nWe can now run Webin-cli to submit our samples. We will start by validating our submission to check no terrible errors have occurred. This bit is now done in the Terminal using bash.\n\n# submitting files to ENA\n\n# check webin-CLI is working\n# download latest version from https://github.com/enasequence/webin-cli/releases\nwget https://github.com/enasequence/webin-cli/releases/download/7.0.1/webin-cli-7.0.1.jar\n\n# check it exists\nls\n\n# check it is working\njava -jar webin-cli-7.0.1.jar -version\n# seems to be working\n\n# open a screen\nscreen -ls # check what screen exist\nscreen -S ena # start a new screen called ena\n# screen -r ena # reopen the screen\n#screen -X -S ena quit # you want to kill the screen\n\n# validate each file submission\n\n# path to raw renamed sequencing files\nfastq_files=~/ena_upload\n\n# path to manifest files\nmanifest_files=~/manifest_files\n\n# create a manifest output folder\nmkdir -p $manifest_files/output\nmanifest_output=$manifest_files/output\n\n# run a test\nfile=$manifest_files/myxo_16s_s1.txt\n\n# run a for loop to submit sequencing files\nfor file in $manifest_files/*.txt\n\n    do\n        # cat the file\n        echo $file\n\n        # grab the file name without the extension\n        stub=$(basename ${file%.txt})\n\n        man_file=$file\n        \n        # make a folder for the output of the validation\n        mkdir -p $manifest_output/$stub\n\n        # run webin-cli - run validation to check\n        java -jar webin-cli-7.0.1.jar -validate -context reads -manifest $man_file -inputDir $fastq_files -outputDir $manifest_output/$stub -username your_username -password your_password\n        \n  done\n\nAfter this has ran, you can check the output of all the validation files. If there are no errors, you can then submit the files to ENA. This can be done quite simply in R.\n\n# check validation reports\n\n# list validation folders\nvalidation_folders &lt;- list.files('~/manifest_files/output', full.names = TRUE)\n\n# setup empty dataframe to populate\nd_check &lt;- data.frame(sample = basename(validation_folders),\n                      check = NA, \n                      fullname = validation_folders)\n\n# run a for loop to grab the output of the validation report for each sample\nfor(i in 1:nrow(d_check)){\n  # read file in\n  temp &lt;- readLines(file.path(d_check$fullname[i], 'webin-cli.report'))\n  \n  # input it into the correct place in the dataframe\n  d_check$check[i] &lt;- temp[length(temp)]\n  \n}\n\n# drop the full name column\nd_check &lt;- select(d_check, -fullname)\n\nd_check\n\nMy most recent one of these looks like this:\n\n\n\nChecking validation of manifest files\n\n\nWe can then run the submission for realsies! This bit is now done in the Terminal using bash.\n\n# run a for loop to submit sequencing files\nfor file in $manifest_files/*.txt\n    do\n        # cat the file\n        echo $file\n\n        # grab the file name without the extension\n        stub=$(basename ${file%.txt})\n\n        man_file=$file\n\n        # run webin-cli\n        java -jar webin-cli-7.0.1.jar -submit -context reads -manifest $man_file -inputDir $fastq_files -outputDir $manifest_output/$stub -username your_username -password your_password\n  done\n\nWith any luck, these files should then be viewable the Samples Report section of the ENA Web Portal."
  },
  {
    "objectID": "posts/ena_file_submission/index.html#conclusion",
    "href": "posts/ena_file_submission/index.html#conclusion",
    "title": "Submitting files to ENA",
    "section": "Conclusion",
    "text": "Conclusion\nI hope you have enjoyed reading this word vomit of a blog post about submitting to ENA. I hope it is useful to someone. Future me at the very least will be grateful for it. If you have any questions, please feel free to get in touch."
  },
  {
    "objectID": "posts/ena_file_submission/index.html#extras",
    "href": "posts/ena_file_submission/index.html#extras",
    "title": "Submitting files to ENA",
    "section": "Extras",
    "text": "Extras\n\nPermitted values for platform of a manifest file\n\nBGISEQ: Sequencers based on DNBSEQ by MGI Tech.\nCAPILLARY: Sequencers based on capillary electrophoresis technology manufactured by LifeTech (formerly Applied BioSciences).\nDNBSEQ: Uses DNA nanoballs(DNB) and regular array chips.\nELEMENT: Element Biosciences uses avidity sequencing: a polymerase inserts nucleotides, detected using fluorescence.\nHELICOS: Helicos is similar to 454 technology - uses 1-color sequential flows.\nILLUMINA: 54 technology use 1-color sequential flows: 454 technology use 1-color sequential flows.\nION_TORRENT: Ion Torrent Personal Genome Machine (PGM) from Life Technologies. Directly translates chemically encoded information (A, C, G, T) into digital on semiconductor chip.\nLS454: 454 technology use 1-color sequential flows.\nOXFORD_NANOPORE: Oxford Nanopore platform type. nanopore-based electronic single molecule analysis.\nPACBIO_SMRT: PacificBiosciences platform type for the single molecule real time (SMRT) technology.\nULTIMA: Ultima Genomics platform type. Flowing one nucleotide at a time in order, iteratively.\n\n\n\nPermitted value for instrument of a manifest file\n\n454 GS\n454 GS 20\n454 GS FLX\n454 GS FLX Titanium\n454 GS FLX+\n454 GS Junior\nAB 310 Genetic Analyzer\nAB 3130 Genetic Analyzer\nAB 3130xL Genetic Analyzer\nAB 3500 Genetic Analyzer\nAB 3500xL Genetic Analyzer\nAB 3730 Genetic Analyzer\nAB 3730xL Genetic Analyzer\nAB 5500 Genetic Analyzer\nAB 5500xl Genetic Analyzer\nAB 5500xl-W Genetic Analysis System\nBGISEQ-50\nBGISEQ-500\nDNBSEQ-G400\nDNBSEQ-G400 FAST\nDNBSEQ-G50\nDNBSEQ-T7\nElement AVITI\nGridION\nHelicos HeliScope\nHiSeq X Five\nHiSeq X Ten\nIllumina Genome Analyzer\nIllumina Genome Analyzer II\nIllumina Genome Analyzer IIx\nIllumina HiScanSQ\nIllumina HiSeq 1000\nIllumina HiSeq 1500\nIllumina HiSeq 2000\nIllumina HiSeq 2500\nIllumina HiSeq 3000\nIllumina HiSeq 4000\nIllumina HiSeq X\nIllumina MiSeq\nIllumina MiniSeq\nIllumina NovaSeq 6000\nIllumina NovaSeq X\nIllumina iSeq 100\nIon GeneStudio S5\nIon GeneStudio S5 Plus\nIon GeneStudio S5 Prime\nIon Torrent Genexus\nIon Torrent PGM\nIon Torrent Proton\nIon Torrent S5\nIon Torrent S5 XL\nMGISEQ-2000RS\nMinION\nNextSeq 1000\nNextSeq 2000\nNextSeq 500\nNextSeq 550\nPacBio RS\nPacBio RS II\nPromethION\nSequel\nSequel II\nSequel IIe\nUG 100\nunspecified\n\n\n\nPermitted values for library selection\n\nRANDOM: No Selection or Random selection\nPCR: target enrichment via PCR\nRANDOM PCR: Source material was selected by randomly generated primers.\nRT-PCR: target enrichment via\nHMPR: Hypo-methylated partial restriction digest\nMF: Methyl Filtrated\nrepeat fractionation: Selection for less repetitive (and more gene rich) sequence through Cot filtration (CF) or other fractionation techniques based on DNA kinetics.\nsize fractionation: Physical selection of size appropriate targets.\nMSLL: Methylation Spanning Linking Library\ncDNA: PolyA selection or enrichment for messenger RNA (mRNA); synonymize with PolyA\ncDNA_randomPriming:\ncDNA_oligo_dT:\nPolyA: PolyA selection or enrichment for messenger RNA (mRNA); should replace cDNA enumeration.\nOligo-dT: enrichment of messenger RNA (mRNA) by hybridization to Oligo-dT.\nInverse rRNA: depletion of ribosomal RNA by oligo hybridization.\nInverse rRNA selection: depletion of ribosomal RNA by inverse oligo hybridization.\nChIP: Chromatin immunoprecipitation\nChIP-Seq: Chromatin immunoPrecipitation, reveals binding sites of specific proteins, typically transcription factors (TFs) using antibodies to extract DNA fragments bound to the target protein.\nMNase: Identifies well-positioned nucleosomes. uses Micrococcal Nuclease (MNase) is an endo-exonuclease that processively digests DNA until an obstruction, such as a nucleosome, is reached.\nDNase: DNase I endonuclease digestion and size selection reveals regions of chromatin where the DNA is highly sensitive to DNase I.\nHybrid Selection: Selection by hybridization in array or solution.\nReduced Representation: Reproducible genomic subsets, often generated by restriction fragment size selection, containing a manageable number of loci to facilitate re-sampling.\nRestriction Digest: DNA fractionation using restriction enzymes.\n5-methylcytidine antibody: Selection of methylated DNA fragments using an antibody raised against 5-methylcytosine or 5-methylcytidine (m5C).\nMBD2 protein methyl-CpG binding domain: Enrichment by methyl-CpG binding domain.\nCAGE: Cap-analysis gene expression.\nRACE: Rapid Amplification of cDNA Ends.\nMDA: Multiple Displacement Amplification, a non-PCR based DNA amplification technique that amplifies a minute quantifies of DNA to levels suitable for genomic analysis.\npadlock probes capture method: Targeted sequence capture protocol covering an arbitrary set of nonrepetitive genomics targets. An example is capture bisulfite sequencing using padlock probes (BSPP).\nother: Other library enrichment, screening, or selection process.\nunspecified: Library enrichment, screening, or selection is not specified.\n\n\nPermitted values for library source\n\nGENOMIC: Genomic DNA (includes PCR products from genomic DNA).\nGENOMIC SINGLE CELL\nTRANSCRIPTOMIC: Transcription products or non genomic DNA (EST, cDNA, RT-PCR, screened libraries).\nTRANSCRIPTOMIC SINGLE CELL:\nMETAGENOMIC: Mixed material from metagenome.\nMETATRANSCRIPTOMIC: Transcription products from community targets\nSYNTHETIC: Synthetic DNA.\nVIRAL RNA: Viral RNA.\nOTHER: Other, unspecified, or unknown library source material.\n\n\n\n\nPermitted values for library strategy\n\nWGS: Whole Genome Sequencing - random sequencing of the whole genome (see pubmed 10731132 for details)\nWGA: Whole Genome Amplification followed by random sequencing. (see pubmed 1631067,8962113 for details)\nWXS: Random sequencing of exonic regions selected from the genome. (see pubmed 20111037 for details)\nRNA-Seq: Random sequencing of whole transcriptome, also known as Whole Transcriptome Shotgun Sequencing, or WTSS). (see pubmed 18611170 for details)\nssRNA-seq: Strand-specific RNA sequencing.\nmiRNA-Seq: Micro RNA sequencing strategy designed to capture post-transcriptional RNA elements and include non-coding functional elements. (see pubmed 21787409 for details)\nncRNA-Seq: Capture of other non-coding RNA types, including post-translation modification types such as snRNA (small nuclear RNA) or snoRNA (small nucleolar RNA), or expression regulation types such as siRNA (small interfering RNA) or piRNA/piwi/RNA (piwi-interacting RNA).\nFL-cDNA: Full-length sequencing of cDNA templates\nEST: Single pass sequencing of cDNA templates\nHi-C: Chromosome Conformation Capture technique where a biotin-labeled nucleotide is incorporated at the ligation junction, enabling selective purification of chimeric DNA ligation junctions followed by deep sequencing.\nATAC-seq: Assay for Transposase-Accessible Chromatin (ATAC) strategy is used to study genome-wide chromatin accessibility. alternative method to DNase-seq that uses an engineered Tn5 transposase to cleave DNA and to integrate primer DNA sequences into the cleaved genomic DNA.\nWCS: Random sequencing of a whole chromosome or other replicon isolated from a genome.\nRAD-Seq:\nCLONE: Genomic clone based (hierarchical) sequencing.\nPOOLCLONE: Shotgun of pooled clones (usually BACs and Fosmids).\nAMPLICON: Sequencing of overlapping or distinct PCR or RT-PCR products. For example, metagenomic community profiling using SSU rRNA.\nCLONEEND: Clone end (5’, 3’, or both) sequencing.\nFINISHING: Sequencing intended to finish (close) gaps in existing coverage.\nChIP-Seq: ChIP-seq, Chromatin ImmunoPrecipitation, reveals binding sites of specific proteins, typically transcription factors (TFs) using antibodies to extract DNA fragments bound to the target protein.\nMNase-Seq: Identifies well-positioned nucleosomes. uses Micrococcal Nuclease (MNase) is an endo-exonuclease that processively digests DNA until an obstruction, such as a nucleosome, is reached.\nRibo-Seq: Ribosome profiling (also named ribosome footprinting) uses specialized messenger RNA (mRNA) sequencing to determine which mRNAs are being actively translated and produces a “global snapshot” of all the ribosomes active in a cell at a particular moment, known as a translatome.\nDNase-Hypersensitivity: Sequencing of hypersensitive sites, or segments of open chromatin that are more readily cleaved by DNaseI.\nBisulfite-Seq: MethylC-seq. Sequencing following treatment of DNA with bisulfite to convert cytosine residues to uracil depending on methylation status.\nCTS: Concatenated Tag Sequencing\nMRE-Seq: Methylation-Sensitive Restriction Enzyme Sequencing.\nMeDIP-Seq: Methylated DNA Immunoprecipitation Sequencing.\nMBD-Seq: Methyl CpG Binding Domain Sequencing.\nTn-Seq: Quantitatively determine fitness of bacterial genes based on how many times a purposely seeded transposon gets inserted into each gene of a colony after some time.\nVALIDATION: CGHub special request: Independent experiment to re-evaluate putative variants.\nFAIRE-seq: Formaldehyde Assisted Isolation of Regulatory Elements. Reveals regions of open chromatin.\nSELEX: Systematic Evolution of Ligands by Exponential enrichment\nRIP-Seq: Direct sequencing of RNA immunoprecipitates (includes CLIP-Seq, HITS-CLIP and PAR-CLIP).\nChIA-PET: Direct sequencing of proximity-ligated chromatin immunoprecipitates.\nSynthetic-Long-Read: binning and barcoding of large DNA fragments to facilitate assembly of the fragment\nTargeted-Capture: Enrichment of a targeted subset of loci.\nTethered Chromatin Conformation Capture:\nOTHER: Library strategy not listed."
  },
  {
    "objectID": "posts/nlsmultstart/index.html",
    "href": "posts/nlsmultstart/index.html",
    "title": "Doing robust nls regression in R",
    "section": "",
    "text": "With my research, I often use non-linear least squares regression to fit a model with biologically meaningful parameters to data. Specifically, I measure the thermal performance of phytoplankon growth, respiration and photosynthesis over a wide range of assay temperatures to see how the organisms are adapted to the temperatures they live at.\nThese thermal performance curves generally follow a unimodal shape and parameters for which are widely used in climate change research to predict whether organisms will be able to cope with increasing temperatures.\n\n\n\nExample Thermal Performance Curve\n\n\nThese curves can be modelled with a variety of equations, such as the Sharpe-Schoolfield equation, which I have log-transformed here:\n\\[log(rate) = lnc + E(\\frac{1}{T_{c}} - \\frac{1}{kT}) - ln(1 + e^{E_h(\\frac{1}{kT_h} - \\frac{1}{kT})})\\] where \\(lnc\\) is a normalisation constant at a common temperature, \\(T_{c}\\), \\(E\\) is an activation energy that describes the rate of increase before the optimum temperature, \\(T_{opt}\\). \\(k\\) is Boltzmann’s constant, \\(E_{h}\\) is the deactivation energy that controls the decline in rate past the optimum temperature and \\(T_{h}\\) is the temperature where, after the optimu, the rate is half of the maximal rate.\nSay I want to fit the same equation to 10, 50, or 100s of these curves. I could loop through a call to nls(), nlsLM(), or use nlsList() from nlme. However, non-linear least squares regression in R is sensitive to the start parameters, meaning that different start parameters can give different “best estimated parameters”. This becomes more likely when fitting more curves with only a single set of start parameters, where the variation in estimated parameter values is likely to be much larger. For example, some curves could have much higher rates (\\(lnc\\)), higher optimum temperatures (i.e. \\(T_{h}\\)) or have different values of temperature-dependence (\\(E\\)).\nTo combat this, I wrote an R package which allows for multiple start parameters for non-linear regression. I wrapped this method in an R package called nlsLoop and submitted it to The Journal of Open Source Software. Everything was good with the world and I went to a Christmas party.\nThe next day, I had an epiphany surrounding the redundancies and needless complexities of my R package, withdrew my submission and rewrote the entire package in a weekend to give rise to a single function package, nls.multstart::nls_multstart(). Essentially since I first wrote nlsLoop ~3 years ago I have realised that broom and purrr can do what I wrote clunkier functions to achieve. In contrast, nls.multstart works perfectly with the tools of the tidyverse to fit multiple models."
  },
  {
    "objectID": "posts/nlsmultstart/index.html#introduction",
    "href": "posts/nlsmultstart/index.html#introduction",
    "title": "Doing robust nls regression in R",
    "section": "",
    "text": "With my research, I often use non-linear least squares regression to fit a model with biologically meaningful parameters to data. Specifically, I measure the thermal performance of phytoplankon growth, respiration and photosynthesis over a wide range of assay temperatures to see how the organisms are adapted to the temperatures they live at.\nThese thermal performance curves generally follow a unimodal shape and parameters for which are widely used in climate change research to predict whether organisms will be able to cope with increasing temperatures.\n\n\n\nExample Thermal Performance Curve\n\n\nThese curves can be modelled with a variety of equations, such as the Sharpe-Schoolfield equation, which I have log-transformed here:\n\\[log(rate) = lnc + E(\\frac{1}{T_{c}} - \\frac{1}{kT}) - ln(1 + e^{E_h(\\frac{1}{kT_h} - \\frac{1}{kT})})\\] where \\(lnc\\) is a normalisation constant at a common temperature, \\(T_{c}\\), \\(E\\) is an activation energy that describes the rate of increase before the optimum temperature, \\(T_{opt}\\). \\(k\\) is Boltzmann’s constant, \\(E_{h}\\) is the deactivation energy that controls the decline in rate past the optimum temperature and \\(T_{h}\\) is the temperature where, after the optimu, the rate is half of the maximal rate.\nSay I want to fit the same equation to 10, 50, or 100s of these curves. I could loop through a call to nls(), nlsLM(), or use nlsList() from nlme. However, non-linear least squares regression in R is sensitive to the start parameters, meaning that different start parameters can give different “best estimated parameters”. This becomes more likely when fitting more curves with only a single set of start parameters, where the variation in estimated parameter values is likely to be much larger. For example, some curves could have much higher rates (\\(lnc\\)), higher optimum temperatures (i.e. \\(T_{h}\\)) or have different values of temperature-dependence (\\(E\\)).\nTo combat this, I wrote an R package which allows for multiple start parameters for non-linear regression. I wrapped this method in an R package called nlsLoop and submitted it to The Journal of Open Source Software. Everything was good with the world and I went to a Christmas party.\nThe next day, I had an epiphany surrounding the redundancies and needless complexities of my R package, withdrew my submission and rewrote the entire package in a weekend to give rise to a single function package, nls.multstart::nls_multstart(). Essentially since I first wrote nlsLoop ~3 years ago I have realised that broom and purrr can do what I wrote clunkier functions to achieve. In contrast, nls.multstart works perfectly with the tools of the tidyverse to fit multiple models."
  },
  {
    "objectID": "posts/nlsmultstart/index.html#multiple-model-fitting-in-practice",
    "href": "posts/nlsmultstart/index.html#multiple-model-fitting-in-practice",
    "title": "Doing robust nls regression in R",
    "section": "Multiple model fitting in practice",
    "text": "Multiple model fitting in practice\nLoad in all packages that are used in this analysis. Packages can be installed from GitHub using devtools.\n\n# load packages\nlibrary(nls.multstart)\nlibrary(ggplot2)\nlibrary(broom)\nlibrary(tidyverse)\nlibrary(nlstools)\n\nWe can then load in the data and have a look at it using glimpse(). Here we shall use a dataset of thermal performance curves of metabolism of Chlorella vulgaris from Padfield et al. 2016.\n\n# load in example data set\ndata(\"Chlorella_TRC\")\nglimpse(Chlorella_TRC)\n\nRows: 649\nColumns: 7\n$ curve_id    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2…\n$ growth.temp &lt;dbl&gt; 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20…\n$ process     &lt;chr&gt; \"acclimation\", \"acclimation\", \"acclimation\", \"acclimation\"…\n$ flux        &lt;chr&gt; \"respiration\", \"respiration\", \"respiration\", \"respiration\"…\n$ temp        &lt;dbl&gt; 16, 19, 22, 25, 28, 31, 34, 37, 40, 43, 46, 49, 16, 19, 22…\n$ K           &lt;dbl&gt; 289.15, 292.15, 295.15, 298.15, 301.15, 304.15, 307.15, 31…\n$ ln.rate     &lt;dbl&gt; -2.06257833, -1.32437939, -0.95416807, -0.79443675, -0.182…\n\n\nNext we define the Sharpe-Schoolfield equation discussed earlier.\n\n# define the Sharpe-Schoolfield equation\nschoolfield_high &lt;- function(lnc, E, Eh, Th, temp, Tc) {\n  Tc &lt;- 273.15 + Tc\n  k &lt;- 8.62e-5\n  boltzmann.term &lt;- lnc + log(exp(E/k*(1/Tc - 1/temp)))\n  inactivation.term &lt;- log(1/(1 + exp(Eh/k*(1/Th - 1/temp))))\n  return(boltzmann.term + inactivation.term)\n  }\n\nThere are 60 curves in this dataset, 30 each of photosynthesis and respiration. The treatments are growth temperature (20, 23, 27, 30, 33 ºC) and adaptive process (acclimation or adaptation) that reflects the number of generations cultures were grown at each temperature.\nWe can see how nls_multstart() works by subsetting the data for a single curve.\n\n# subset dataset\nd_1 &lt;- subset(Chlorella_TRC, curve_id == 1)\n# run nls_multstart\nfit &lt;- nls_multstart(ln.rate ~ schoolfield_high(lnc, E, Eh, Th, temp = K, Tc = 20),\n                     data = d_1,\n                     iter = 500,\n                     start_lower = c(lnc = -10, E = 0.1, Eh = 0.2, Th = 285),\n                     start_upper = c(lnc = 10, E = 2, Eh = 5, Th = 330),\n                     supp_errors = 'Y',\n                     na.action = na.omit,\n                     lower = c(lnc = -10, E = 0, Eh = 0, Th = 0))\nfit\n\nNonlinear regression model\n  model: ln.rate ~ schoolfield_high(lnc, E, Eh, Th, temp = K, Tc = 20)\n   data: data\n     lnc        E       Eh       Th \n -1.3462   0.9877   4.3326 312.1887 \n residual sum-of-squares: 7.257\n\nNumber of iterations to convergence: 15 \nAchieved convergence tolerance: 1.49e-08\n\n\nnls_multstart() allows boundaries for each parameter to be set. A uniform distribution between these values is created and start values for each iteration of the fitting process are then picked randomly. The function returns the best available model by picking the model with the lowest AIC score. Additional info on the function can be found here or by typing ?nls_multstart into the R console.\nThis fit can then be “tidied” in various ways using the R package broom. Each different function in broom returns a different set of information. tidy() returns the estimated parameters, augment() returns the predictions and glance() returns information about the model such as the AIC score and whether the model has reached convergence. Confidence intervals of non-linear regression can also be estimated using nlstools::confint2()\nThe amazing thing about these tools is the ease at which they can then be used on multiple curves at once, an approach Hadley Wickham has previously written about. The approach nests the data based on grouping variables using nest(), then creates a list column of the best fit for each curve using map().\n\n# fit over each set of groupings\nfits &lt;- Chlorella_TRC %&gt;%\n  group_by(., flux, growth.temp, process, curve_id) %&gt;%\n  nest() %&gt;%\n  mutate(fit = purrr::map(data, ~ nls_multstart(ln.rate ~ schoolfield_high(lnc, E, Eh, Th, temp = K, Tc = 20),\n                                   data = .x,\n                                   iter = 1000,\n                                   start_lower = c(lnc = -10, E = 0.1, Eh = 0.2, Th = 285),\n                                   start_upper = c(lnc = 10, E = 2, Eh = 5, Th = 330),\n                                   supp_errors = 'Y',\n                                   na.action = na.omit,\n                                   lower = c(lnc = -10, E = 0, Eh = 0, Th = 0))))\n\nIf you are confused, then you are not alone. This took me a long time to understand and I imagine there are still better ways for me to do it! However, to check it has worked, we can look at a single fit to check it looks ok. We can also look at fits to see that there is now a fit list column containing each of the non-linear fits for each combination of our grouping variables.\n\n# look at a single fit\nsummary(fits$fit[[1]])\n\n\nFormula: ln.rate ~ schoolfield_high(lnc, E, Eh, Th, temp = K, Tc = 20)\n\nParameters:\n    Estimate Std. Error t value Pr(&gt;|t|)    \nlnc  -1.3462     0.4656  -2.891   0.0202 *  \nE     0.9877     0.4521   2.185   0.0604 .  \nEh    4.3326     1.4878   2.912   0.0195 *  \nTh  312.1887     3.8782  80.499 6.32e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.9524 on 8 degrees of freedom\n\nNumber of iterations to convergence: 19 \nAchieved convergence tolerance: 1.49e-08\n\n# look at output object\nselect(fits, curve_id, data, fit)\n\nAdding missing grouping variables: `flux`, `growth.temp`, `process`\n\n\n# A tibble: 60 × 6\n# Groups:   flux, growth.temp, process, curve_id [60]\n   flux        growth.temp process     curve_id data              fit   \n   &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;list&gt;            &lt;list&gt;\n 1 respiration          20 acclimation        1 &lt;tibble [12 × 3]&gt; &lt;nls&gt; \n 2 respiration          20 acclimation        2 &lt;tibble [12 × 3]&gt; &lt;nls&gt; \n 3 respiration          23 acclimation        3 &lt;tibble [12 × 3]&gt; &lt;nls&gt; \n 4 respiration          27 acclimation        4 &lt;tibble [9 × 3]&gt;  &lt;nls&gt; \n 5 respiration          27 acclimation        5 &lt;tibble [12 × 3]&gt; &lt;nls&gt; \n 6 respiration          30 acclimation        6 &lt;tibble [12 × 3]&gt; &lt;nls&gt; \n 7 respiration          30 acclimation        7 &lt;tibble [12 × 3]&gt; &lt;nls&gt; \n 8 respiration          33 acclimation        8 &lt;tibble [10 × 3]&gt; &lt;nls&gt; \n 9 respiration          33 acclimation        9 &lt;tibble [8 × 3]&gt;  &lt;nls&gt; \n10 respiration          20 acclimation       10 &lt;tibble [10 × 3]&gt; &lt;nls&gt; \n# … with 50 more rows\n\n\nThese fits can be cleaned up using the broom functions and purrr::map() to iterate over the grouping variables.\n\n# get summary info\ninfo &lt;- fits %&gt;%\n  mutate(., info = map(fit, glance)) %&gt;%\n  unnest(info)\n\n# get params\nparams &lt;- fits %&gt;%\n  mutate(., params = map(fit, tidy)) %&gt;%\n  unnest(params)\n  \n# get confidence intervals\nCI &lt;- fits %&gt;% \n  mutate(., CI = map(fit, function(x)data.frame(confint2(x)))) %&gt;%\n  unnest(CI) %&gt;%\n  select(-data, -fit) %&gt;%\n  rename(., conf.low = `X2.5..`, conf.high = `X97.5..`) %&gt;%\n  group_by(., curve_id) %&gt;%\n  mutate(., term = c('lnc', 'E', 'Eh', 'Th')) %&gt;%\n  ungroup()\n# merge parameters and CI estimates\nparams &lt;- merge(params, CI, by = intersect(names(params), names(CI)))\n\n# get predictions\npreds &lt;- fits %&gt;%\n  mutate(., preds = map(fit, augment)) %&gt;%\n  unnest(preds)\n\nLooking at info allows us to see if all the models converged.\n\nungroup(info) %&gt;% select(., curve_id, logLik, AIC, BIC, deviance, df.residual)\n\n# A tibble: 60 × 6\n   curve_id  logLik   AIC   BIC deviance df.residual\n      &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;\n 1        1 -14.0   38.0  40.4     7.26            8\n 2        2  -1.20  12.4  14.8     0.858           8\n 3        3  -7.39  24.8  27.2     2.41            8\n 4        4  -0.523 11.0  12.0     0.592           5\n 5        5 -10.8   31.7  34.1     4.29            8\n 6        6  -8.52  27.0  29.5     2.91            8\n 7        7  -1.29  12.6  15.0     0.871           8\n 8        8 -13.4   36.7  38.2     8.48            6\n 9        9   1.82   6.36  6.76    0.297           4\n10       10  -1.27  12.5  14.1     0.755           6\n# … with 50 more rows\n\n\nWhen plotting non-linear fits, I prefer to have a smooth curve, even when there are not many points underlying the fit. This can be achieved by including newdata in the augment() function and creating a higher resolution set of predictor values.\nHowever, when predicting for many different fits, it is not certain that each curve has the same range of predictor variables. We can get around this by setting the limits of each prediction by the min() and max() of the predictor variables.\n\n# new data frame of predictions\nnew_preds &lt;- Chlorella_TRC %&gt;%\n  do(., data.frame(K = seq(min(.$K), max(.$K), length.out = 150), stringsAsFactors = FALSE))\n# max and min for each curve\nmax_min &lt;- group_by(Chlorella_TRC, curve_id) %&gt;%\n  summarise(., min_K = min(K), max_K = max(K), .groups = 'drop')\n\n# create new predictions\npreds2 &lt;- fits %&gt;%\n  mutate(preds = map(fit, augment, newdata = new_preds)) %&gt;%\n  unnest(preds) %&gt;%\n  merge(., max_min, by = 'curve_id') %&gt;%\n  group_by(., curve_id) %&gt;%\n  filter(., K &gt; unique(min_K) & K &lt; unique(max_K)) %&gt;%\n  rename(., ln.rate = .fitted) %&gt;%\n  ungroup()\n\nThese can then be plotted using ggplot2.\n\n# plot\nggplot() +\n  geom_point(aes(K - 273.15, ln.rate, col = flux), size = 2, Chlorella_TRC) +\n  geom_line(aes(K - 273.15, ln.rate, col = flux, group = curve_id), alpha = 0.5, preds2) +\n  facet_wrap(~ growth.temp + process, labeller = labeller(.multi_line = FALSE)) +\n  scale_colour_manual(values = c('green4', 'black')) +\n  theme_bw(base_size = 12, base_family = 'Helvetica') +\n  ylab('log Metabolic rate') +\n  xlab('Assay temperature (ºC)') +\n  theme(legend.position = c(0.9, 0.15))\n\n\n\n\n\n\n\n\nThe confidence intervals of each parameter for each curve fit can also be easily visualised.\n\n# plot\nggplot(params, aes(col = flux)) +\n  geom_point(aes(curve_id, estimate)) +\n  facet_wrap(~ term, scale = 'free_x', ncol = 4) +\n  geom_linerange(aes(curve_id, ymin = conf.low, ymax = conf.high)) +\n  coord_flip() +\n  scale_color_manual(values = c('green4', 'black')) +\n  theme_bw(base_size = 12, base_family = 'Helvetica') +\n  theme(legend.position = 'top') +\n  xlab('curve') +\n  ylab('parameter estimate')\n\n\n\n\n\n\n\n\nThis method of modelling can be used for different data, different non-linear models (and linear models for that matter) and combined with the tidyverse can make very useful visualisations.\nThe next stage of these curve fits is to try and better understand the uncertainty of these curve fits and their predictions. One approach to achieve this could be bootstrapping new datasets from the existing data. I hope to demonstrate how this could be done soon in another post."
  },
  {
    "objectID": "posts/nlsmultstart/index.html#references",
    "href": "posts/nlsmultstart/index.html#references",
    "title": "Doing robust nls regression in R",
    "section": "References",
    "text": "References\n[1] Padfield, D., Yvon-durocher, G., Buckling, A., Jennings, S. & Yvon-durocher, G. (2016). Rapid evolution of metabolic traits explains thermal adaptation in phytoplankton. Ecology Letters, 19(2), 133-142."
  },
  {
    "objectID": "posts/animate_rstrava/index.html",
    "href": "posts/animate_rstrava/index.html",
    "title": "rStrava and gganimate",
    "section": "",
    "text": "rStrava is an R package that allows you to access data from Strava using the Strava API. Some of the functions of rStrava scrape data from the public Strava website but to access your own data you will need a Strava profile and an authentication token. Details on obtaining your unique token can be found on the rStrava GitHub In addition to this key, we use rgbif::elevation() to calculate the elevation of each route. This requires a Google API key which can be created here.\nGot a Strava authentication token? Got a Google API key? We are ready to create some animations! To create our animations, we use gganimate that requires ImageMagick to be installed."
  },
  {
    "objectID": "posts/animate_rstrava/index.html#getting-started-with-rstrava",
    "href": "posts/animate_rstrava/index.html#getting-started-with-rstrava",
    "title": "rStrava and gganimate",
    "section": "",
    "text": "rStrava is an R package that allows you to access data from Strava using the Strava API. Some of the functions of rStrava scrape data from the public Strava website but to access your own data you will need a Strava profile and an authentication token. Details on obtaining your unique token can be found on the rStrava GitHub In addition to this key, we use rgbif::elevation() to calculate the elevation of each route. This requires a Google API key which can be created here.\nGot a Strava authentication token? Got a Google API key? We are ready to create some animations! To create our animations, we use gganimate that requires ImageMagick to be installed."
  },
  {
    "objectID": "posts/animate_rstrava/index.html#loading-packages-and-defining-tokens",
    "href": "posts/animate_rstrava/index.html#loading-packages-and-defining-tokens",
    "title": "rStrava and gganimate",
    "section": "Loading packages and defining tokens",
    "text": "Loading packages and defining tokens\nFirst load the packages that are used in the script and our Strava and Google authentication tokens. The app_scope argument in strava_oauth() has to be one of “read” , “read_all”, “profile:read_all”, “profile:write”, “activity:read”, “activity:read_all” or “activity:write”. To access your activities, activity:read_all has to be included.\n\n# load packages ####\nlibrary(rStrava) # devtools::install_github('fawda123/rStrava')\nlibrary(gganimate)\nlibrary(tidyverse)\nlibrary(sp)\nlibrary(ggmap)\nlibrary(raster)\n\n# initial setup ####\n# Strava key\napp_name &lt;- 'xxxx'\napp_client_id &lt;- 'xxxxx'\napp_secret &lt;- '\"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\"'\n\n# create strava token\nmy_token &lt;- httr::config(token = strava_oauth(app_name, app_client_id, app_secret, app_scope = 'read_all,activity:read_all'))\n\n# Google elevation API key\nGoogleAPI &lt;- 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'\n\nA browser window should open at this point saying Authentication complete. Please close this page and return to R. This means everything is going well!"
  },
  {
    "objectID": "posts/animate_rstrava/index.html#download-your-data",
    "href": "posts/animate_rstrava/index.html#download-your-data",
    "title": "rStrava and gganimate",
    "section": "Download your data",
    "text": "Download your data\nWe can then download our personal activity data using the rStrava::get_activity_list(). This function needs your strava token and your strava athlete id. For example, my strava id is 2140248.\n\n# download strava data\nmy_acts &lt;- get_activity_list(my_token)\n\nlength(my_acts)\n\n[1] 1669\n\n\nThis returns a large list of all your previous activities. Mine has 1028 previous entries. If you want to explore your list, you can use View(my_acts) in RStudio which opens the Data Viewer window."
  },
  {
    "objectID": "posts/animate_rstrava/index.html#compile-your-data-into-tidy-dataframe",
    "href": "posts/animate_rstrava/index.html#compile-your-data-into-tidy-dataframe",
    "title": "rStrava and gganimate",
    "section": "Compile your data into “tidy” dataframe",
    "text": "Compile your data into “tidy” dataframe\nrStrava has a function that compiles the information stored in the output of get_activity_list() to a “tidy” dataframe, with one row for each activity. compile_activities() finds all the columns across all activities and returns NA when a column is not present in a given activity. This means that if HR was not measured across all your strava activities, the function will still work!\n\n# compile activities into a tidy dataframe\nmy_acts &lt;- compile_activities(my_acts)\n\n# have a look at the dataframe\ndplyr::glimpse(my_acts)\n\nRows: 1,669\nColumns: 60\n$ achievement_count             &lt;dbl&gt; 5, 9, 12, 0, 0, 1, 11, 1, 23, 3, 2, 0, 0…\n$ athlete_count                 &lt;dbl&gt; 1, 1, 2, 1, 1, 1, 1, 1, 51, 1, 1, 1, 1, …\n$ athlete.id                    &lt;chr&gt; \"2140248\", \"2140248\", \"2140248\", \"214024…\n$ athlete.resource_state        &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n$ average_heartrate             &lt;chr&gt; \"127.8\", \"127.6\", \"123.8\", NA, \"127.4\", …\n$ average_speed                 &lt;dbl&gt; 21.9168, 26.2476, 24.0264, 27.1476, 17.5…\n$ average_temp                  &lt;chr&gt; \"10\", \"9\", \"9\", \"7\", \"3\", NA, NA, NA, NA…\n$ average_watts                 &lt;dbl&gt; 134.7, 156.7, 148.8, 101.1, 138.1, NA, N…\n$ comment_count                 &lt;dbl&gt; 1, 14, 0, 0, 0, 3, 0, 0, 3, 0, 0, 0, 2, …\n$ commute                       &lt;chr&gt; \"FALSE\", \"FALSE\", \"FALSE\", \"FALSE\", \"FAL…\n$ device_watts                  &lt;chr&gt; \"FALSE\", \"FALSE\", \"FALSE\", \"FALSE\", \"FAL…\n$ display_hide_heartrate_option &lt;chr&gt; \"TRUE\", \"TRUE\", \"TRUE\", \"FALSE\", \"TRUE\",…\n$ distance                      &lt;dbl&gt; 22.3615, 27.7074, 42.3477, 5.7089, 5.639…\n$ elapsed_time                  &lt;dbl&gt; 3822, 3884, 6656, 757, 1158, 1923, 4469,…\n$ elev_high                     &lt;dbl&gt; 73.2, 146.2, 238.6, 118.2, 126.8, 75.9, …\n$ elev_low                      &lt;dbl&gt; -0.4, 2.4, 4.6, 12.8, 20.0, 68.3, 45.1, …\n$ end_latlng1                   &lt;dbl&gt; 50.15009, 50.00123, 50.15008, 50.15007, …\n$ end_latlng2                   &lt;dbl&gt; -5.084491, -5.181100, -5.084519, -5.0845…\n$ external_id                   &lt;chr&gt; \"garmin_ping_260217768521\", \"garmin_ping…\n$ flagged                       &lt;chr&gt; \"FALSE\", \"FALSE\", \"FALSE\", \"FALSE\", \"FAL…\n$ from_accepted_tag             &lt;chr&gt; \"FALSE\", \"FALSE\", \"FALSE\", \"FALSE\", \"FAL…\n$ gear_id                       &lt;chr&gt; \"b11291030\", \"b11291030\", \"b11291030\", \"…\n$ has_heartrate                 &lt;chr&gt; \"TRUE\", \"TRUE\", \"TRUE\", \"FALSE\", \"TRUE\",…\n$ has_kudoed                    &lt;chr&gt; \"FALSE\", \"FALSE\", \"FALSE\", \"FALSE\", \"FAL…\n$ heartrate_opt_out             &lt;chr&gt; \"FALSE\", \"FALSE\", \"FALSE\", \"FALSE\", \"FAL…\n$ id                            &lt;dbl&gt; 8566326572, 8541744691, 8531882051, 8527…\n$ kilojoules                    &lt;dbl&gt; 494.9, 595.4, 944.1, 76.5, 159.9, NA, NA…\n$ kudos_count                   &lt;dbl&gt; 17, 23, 14, 5, 2, 8, 27, 5, 26, 4, 11, 1…\n$ location_country              &lt;chr&gt; \"United Kingdom\", \"United Kingdom\", \"Uni…\n$ manual                        &lt;chr&gt; \"FALSE\", \"FALSE\", \"FALSE\", \"FALSE\", \"FAL…\n$ map.id                        &lt;chr&gt; \"a8566326572\", \"a8541744691\", \"a85318820…\n$ map.resource_state            &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2…\n$ map.summary_polyline          &lt;chr&gt; \"a|aqHhu_^Uo@KmCOcAWo@kCwDYb@oBlEcDlC}D|…\n$ max_heartrate                 &lt;chr&gt; \"157\", \"150\", \"157\", NA, \"149\", \"166\", \"…\n$ max_speed                     &lt;dbl&gt; 57.0096, 58.2696, 66.5136, 58.8420, 41.0…\n$ moving_time                   &lt;dbl&gt; 3673, 3800, 6345, 757, 1158, 1878, 4314,…\n$ name                          &lt;chr&gt; \"Afternoon Ride\", \"Morning Ride. Fun unt…\n$ photo_count                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ pr_count                      &lt;chr&gt; \"0\", \"1\", \"8\", \"0\", \"0\", \"0\", \"7\", \"0\", …\n$ private                       &lt;chr&gt; \"FALSE\", \"FALSE\", \"FALSE\", \"FALSE\", \"FAL…\n$ resource_state                &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2…\n$ sport_type                    &lt;chr&gt; \"Ride\", \"Ride\", \"Ride\", \"Ride\", \"Ride\", …\n$ start_date                    &lt;chr&gt; \"2023-02-15T16:04:05Z\", \"2023-02-11T10:0…\n$ start_date_local              &lt;chr&gt; \"2023-02-15T16:04:05Z\", \"2023-02-11T10:0…\n$ start_latlng1                 &lt;dbl&gt; 50.15005, 50.15006, 50.14998, 50.17089, …\n$ start_latlng2                 &lt;dbl&gt; -5.084534, -5.084494, -5.084516, -5.1274…\n$ suffer_score                  &lt;chr&gt; \"29\", \"30\", \"40\", NA, \"9\", \"33\", \"86\", \"…\n$ timezone                      &lt;chr&gt; \"(GMT+00:00) Europe/London\", \"(GMT+00:00…\n$ total_elevation_gain          &lt;dbl&gt; 376.0, 372.0, 601.0, 38.0, 147.0, 15.0, …\n$ total_photo_count             &lt;dbl&gt; 2, 3, 0, 0, 0, 0, 3, 0, 3, 0, 3, 0, 5, 3…\n$ trainer                       &lt;chr&gt; \"FALSE\", \"FALSE\", \"FALSE\", \"FALSE\", \"FAL…\n$ type                          &lt;chr&gt; \"Ride\", \"Ride\", \"Ride\", \"Ride\", \"Ride\", …\n$ upload_id                     &lt;chr&gt; \"9196267205\", \"9168807862\", \"9157876592\"…\n$ upload_id_str                 &lt;chr&gt; \"9196267205\", \"9168807862\", \"9157876592\"…\n$ utc_offset                    &lt;chr&gt; \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", …\n$ visibility                    &lt;chr&gt; \"everyone\", \"everyone\", \"everyone\", \"eve…\n$ workout_type                  &lt;chr&gt; \"10\", \"10\", NA, NA, NA, NA, \"0\", NA, \"0\"…\n$ average_cadence               &lt;chr&gt; NA, NA, NA, NA, NA, \"79.5\", \"81.3\", \"80.…\n$ location_city                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ location_state                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n\n\nThere are so many columns here, so I remove some columns I am not interested in for this post and do some data transformations to get the date in a correct format. I also do not want to run the example on all my rides, instead I filter them for just 2020.\n\n# columns to keep\ndesired_columns &lt;- c('distance', 'elapsed_time', 'moving_time', 'start_date', 'start_date_local', 'type', 'map.summary_polyline', 'location_city', 'upload_id')\n\n# keep only desired columns\nmy_acts2 &lt;- dplyr::select(my_acts, any_of(desired_columns))\n\n# transformations ####\nmy_acts &lt;- mutate(my_acts,\n                  activity_no = seq(1,n(), 1),\n                  elapsed_time = elapsed_time/60/60,\n                  moving_time = moving_time/60/60, \n                  date = gsub(\"T.*$\", '', start_date) %&gt;%\n                    as.POSIXct(., format = '%Y-%m-%d'),\n                  EUdate = format(date, '%d/%m/%Y'),\n                  month = format(date, \"%m\"),\n                  day = format(date, \"%d\"),\n                  year = format(date, \"%Y\")) %&gt;%\n  mutate(., across(c(month, day), as.numeric)) %&gt;%\n  filter(.,year == '2020')"
  },
  {
    "objectID": "posts/animate_rstrava/index.html#get-latitude-and-longitude-for-each-activity",
    "href": "posts/animate_rstrava/index.html#get-latitude-and-longitude-for-each-activity",
    "title": "rStrava and gganimate",
    "section": "Get latitude and longitude for each activity",
    "text": "Get latitude and longitude for each activity\nEach activity has a bunch of data associated with it. For mapping, I am interested in the map.summary_polyline, which is a Google polyline which allows the encoding of multiple latitude and longitude points as a single string. We can get the latitude and longitude for each of the activities by using get_latlon() which decodes the polylines and using dplyr and purrr to iterate over every activity in the dataframe. I add my Google API key as a column so that map() can easily find it.\n\n# get lat lon and distance of every ride ####\nlat_lon &lt;- my_acts %&gt;%\n  filter(!is.na(map.summary_polyline)) %&gt;%\n  filter(type == 'Ride') %&gt;%\n  mutate(key = GoogleAPI) %&gt;%\n  group_by(activity_no) %&gt;%\n  nest() %&gt;%\n  mutate(coords = map(data, ~get_latlon(.$map.summary_polyline, key = .$key)),\n         dist = map(coords, ~get_dists(.x$lon, .x$lat))) %&gt;%\n  unnest(., data) %&gt;%\n  unnest(., c(coords, dist))\n\nHaving got the latitude and longitude for every ride, we can now get the elevation of each point and then calculate the gradient between points. To do this I use elevation() in the R package rgbif. To use this, you need to get a GeoNames username by registering for an account at http://www.geonames.org/login.\n\n# get elevation and calculate gradient between points\nlat_lon &lt;- ungroup(lat_lon) %&gt;%\n  mutate(., ele = rgbif::elevation(latitude = .$lat, longitude = .$lon, user = 'YOUR USERNAME HERE', model = 'srtm1')$elevation_geonames)\n\nlat_lon &lt;- group_by(lat_lon, activity_no) %&gt;%\n  mutate(., ele_diff = c(0, diff(ele)),\n         dist_diff = c(0, diff(dist)),\n         grad = c(0, (ele_diff[2:n()]/10)/dist_diff[2:n()])) %&gt;%\n  ungroup() %&gt;%\n  dplyr::select(., -c(ele_diff, dist_diff))\n\nThis now gives us a data frame of all my rides from 2020 with the latitude, longitude, cumulative distance, elevation and gradient. It would now be super easy to create elevation profiles, but I will save that for another post."
  },
  {
    "objectID": "posts/animate_rstrava/index.html#create-a-gif-of-a-single-ride",
    "href": "posts/animate_rstrava/index.html#create-a-gif-of-a-single-ride",
    "title": "rStrava and gganimate",
    "section": "Create a gif of a single ride",
    "text": "Create a gif of a single ride\nWe now have almost all the components to create a gif of a single ride.\n\nlat_lon_single &lt;- filter(lat_lon, activity_no == min(activity_no))\nnrow(lat_lon_single)\n\n[1] 343\n\n\nHowever, Google polylines do not give a consistent number of latitude and longitude points. This means it might be hard to get a smooth elevation profile for the ride and also for smooth transitions in a gif. To create a set number of points from the current polyline, we can use geospatial packages such as sp and raster to interpolate a desired number of points from the current ones. Here I create 250 points.\n\n# reorder columns so lat lon are first\nlat_lon_single &lt;- dplyr::select(lat_lon_single, lat, lon, everything())\n\n# make new data with by interpolation\ninterp &lt;- raster::spLines(as.matrix(lat_lon_single[,1:2])) %&gt;%\n  sp::spsample(., n = 250, type = 'regular') %&gt;%\n  data.frame() %&gt;%\n  mutate(., dist = get_dists(lon, lat),\n         ele = rgbif::elevation(latitude = .$lat, longitude = .$lon, user = 'padpadpadpad', model = 'srtm1')$elevation_geoname,\n         ele_diff = c(0, diff(ele)),\n         dist_diff = c(0, diff(dist)),\n         grad = c(0, (ele_diff[2:n()]/10)/dist_diff[2:n()]),\n         n = row_number())\n\nWe can now put the gif together, using ggmap and ggplot2. We use gganimate to make the plot animated.\n\n# make bbox\nbbox &lt;- ggmap::make_bbox(lon, lat, data = lat_lon_single, f = 1.3)\n\n# download map\nmap &lt;- get_map(location = bbox, source = 'google', maptype = 'terrain')\n\nsingle_ride &lt;- ggmap(map, darken = 0.15) +\n  geom_path(aes(x = lon, y = lat,  col = grad, group = 1), data = interp, size = 2, alpha = 1) +\n  scale_color_distiller('Gradient (%)', palette = 'Spectral') +\n  labs(title = '') +\n  coord_cartesian() +\n  ggforce::theme_no_axes(theme_bw(base_size = 16)) +\n  transition_reveal(dist)\n\n# animate plot\ngganimate::anim_save('where_to_save.gif', single_ride, width = 1000, height = 700)\n\nThe output of this code can be seen below."
  },
  {
    "objectID": "posts/animate_rstrava/index.html#create-a-gif-of-all-the-rides",
    "href": "posts/animate_rstrava/index.html#create-a-gif-of-all-the-rides",
    "title": "rStrava and gganimate",
    "section": "Create a gif of ALL the rides",
    "text": "Create a gif of ALL the rides\nWe can also make a gif of multiple activities. I will filter my activities to only be bike rides over 15km.\n\n# get a bbox for Cornwall\nbbox &lt;- ggmap::make_bbox(lat_lon_single$lon, lat_lon_single$lat, f = 1.2)\n\n# add column for frame and total distance per ride\nlat_lon &lt;- group_by(lat_lon, activity_no) %&gt;%\n  mutate(n = 1:n(),\n         tot_dist = max(distance)) %&gt;%\n  ungroup()\n\n# filter lat_lon for when points are within this\nlat_lon &lt;- filter(lat_lon, between(start_longitude, bbox[1], bbox[3]) & between(start_latitude, bbox[2], bbox[4]) & type == 'Ride' & tot_dist &gt; 15)\n\n# add column for frame\nlat_lon &lt;- group_by(lat_lon, activity_no) %&gt;%\n  mutate(n = 1:n()) %&gt;%\n  ungroup()\n\n# make bbox again\nbbox &lt;- ggmap::make_bbox(lon, lat, data = lat_lon, f = 0.1)\n\n# download map\nmap &lt;- get_map(location = bbox, source = 'google', maptype = 'terrain')\n\nall_the_rides &lt;- ggmap(map, darken = 0.15) +\n  geom_path(aes(x = lon, y = lat, group = activity_no), col = 'red', data = lat_lon, size = 1.25, alpha = 0.5) +\n  labs(title = 'All the rides') +\n  coord_cartesian() +\n  ggforce::theme_no_axes(theme_bw(base_size = 16)) +\n  theme(legend.position = 'none') +\n  transition_reveal(n)\n\n# animate plot\ngganimate::anim_save('where_to_save.gif', all_the_rides, width = 750, height = 700)\n\n\nAnd there we have it. A relatively simple way to animate your strava activities in R. I personally find that saving the output as .mp4 rather than .gif gives smaller and higher quality files when uploading them to Instagram, but these options are easy to change. Take back your own data and get plotting!\nThere are loads of other functions and uses for the rStrava package. I hope to blog more about them soon."
  },
  {
    "objectID": "posts/bootstrap_nls/index.html",
    "href": "posts/bootstrap_nls/index.html",
    "title": "Bootstrap nls models in R",
    "section": "",
    "text": "This post was updated to reflect the improvement of using car to bootstrap nonlinear regressions."
  },
  {
    "objectID": "posts/bootstrap_nls/index.html#introduction",
    "href": "posts/bootstrap_nls/index.html#introduction",
    "title": "Bootstrap nls models in R",
    "section": "Introduction",
    "text": "Introduction\nFor my first academic publication, a reviewer asked for the \\(r^{2}\\) values of the thermal performance curves I fitted using non-linear regression. I bowed to the request as is often the case with reviewer comments, but would now resist as the \\(r^{2}\\) is not necessarily an effective goodness of fit measure for non-linear regression (see this SO answer). It does raise the question of how to determine how well a biologically meaningful model fits the data it is fitted to. I generally just plot every curve to its data, but it tells me nothing of the uncertainty around the curve.\nStep forward the bootstrap! (Non-parametric) bootstrapping is a robust way of computing parameter and model prediction confidence intervals. Bootstrapping involves simulating “new” datasets produced from either the original data (case resampling) or from the original model (residual resampling).\nThe same model is then fitted separately on each individual bootstrapped dataset. Doing this over and over allows us to visualise uncertainty of predictions and produce confidence intervals of estimated parameters. When previously implementing this, I used methods similar to previous blog posts by Andrew MacDonald and Hadley Wickham, as well as a broom vignette.\nHowever, I have since applied a more efficient method using the package car, which contains the function Boot() that provides a wrapper for the widely used function boot::boot() that is tailored to bootstrapping regression models."
  },
  {
    "objectID": "posts/bootstrap_nls/index.html#case-resampling-resampling-the-original-data-with-replacement",
    "href": "posts/bootstrap_nls/index.html#case-resampling-resampling-the-original-data-with-replacement",
    "title": "Bootstrap nls models in R",
    "section": "Case resampling: Resampling the original data with replacement",
    "text": "Case resampling: Resampling the original data with replacement\nBootstrapping using case resampling involves simulating “new” datasets produced from the existing data by sampling with replacement.\n\nCase resampling: When it works\nWe will demonstrate an example of when this case resampling approach works using data from a recent paper by Padfield et al. (2020), that measures the thermal performance of the bacteria, Pseudomonas fluorescens, in the presence and absence of its phage, \\(\\phi 2\\). In this study, each single growth rate estimate is a technical replicate. As such, all the data points within each phage treatment can be used to estimate the same curve. The data is in the R package rTPC and we can visualise one of the curves using ggplot2.\n\n# load packages\nlibrary(boot)\nlibrary(car)\nlibrary(rTPC) #remotes::install_github('padpadpadpad/rTPC')\nlibrary(nls.multstart)\nlibrary(broom)\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(minpack.lm)\n\n# load in data\ndata(\"bacteria_tpc\")\n\n# keep just a single curve\nd &lt;- filter(bacteria_tpc, phage == 'nophage')\n\n# show the data\nggplot(d, aes(temp, rate)) +\n  geom_point(size = 2, alpha = 0.5) +\n  theme_bw(base_size = 12) +\n  labs(x = 'Temperature (ºC)',\n       y = 'Growth rate',\n       title = 'Growth rate across temperatures')\n\n\n\n\n\n\n\n\nAs in the study, we can fit the Sharpe-Schoolfield model to the data. I take advantage of the packages nls.mulstart and rTPC to do this.\n\n# fit Sharpe-Schoolfield model\nd_fit &lt;- nest(d, data = c(temp, rate)) %&gt;%\n  mutate(sharpeschoolhigh = map(data, ~nls_multstart(rate~sharpeschoolhigh_1981(temp = temp, r_tref,e,eh,th, tref = 15),\n                        data = .x,\n                        iter = c(3,3,3,3),\n                        start_lower = get_start_vals(.x$temp, .x$rate, model_name = 'sharpeschoolhigh_1981') - 10,\n                        start_upper = get_start_vals(.x$temp, .x$rate, model_name = 'sharpeschoolhigh_1981') + 10,\n                        lower = get_lower_lims(.x$temp, .x$rate, model_name = 'sharpeschoolhigh_1981'),\n                        upper = get_upper_lims(.x$temp, .x$rate, model_name = 'sharpeschoolhigh_1981'),\n                        supp_errors = 'Y',\n                        convergence_count = FALSE)),\n         # create new temperature data\n         new_data = map(data, ~tibble(temp = seq(min(.x$temp), max(.x$temp), length.out = 100))),\n         # predict over that data,\n         preds =  map2(sharpeschoolhigh, new_data, ~augment(.x, newdata = .y)))\n\n# unnest predictions\nd_preds &lt;- select(d_fit, preds) %&gt;%\n  unnest(preds)\n\n# plot data and predictions\nggplot() +\n  geom_line(aes(temp, .fitted), d_preds, col = 'blue') +\n  geom_point(aes(temp, rate), d, size = 2, alpha = 0.5) +\n  theme_bw(base_size = 12) +\n  labs(x = 'Temperature (ºC)',\n       y = 'Growth rate',\n       title = 'Growth rate across temperatures')\n\n\n\n\n\n\n\n\nnls_multstart() is designed to fit models across a wide possible parameter space, but as it samples multiple start parameters for each model, using it with bootstrapping becomes computationally expensive. Instead, we refit the model using minpack.lm::nlsLM(), using the coefficients of nls_multstart() as the start values. The Boot() function then refits the model 999 times and stores the model coefficients.\n\n# refit model using nlsLM\nfit_nlsLM &lt;- minpack.lm::nlsLM(rate~sharpeschoolhigh_1981(temp = temp, r_tref,e,eh,th, tref = 15),\n                        data = d,\n                        start = coef(d_fit$sharpeschoolhigh[[1]]),\n                        lower = get_lower_lims(d$temp, d$rate, model_name = 'sharpeschoolhigh_1981'),\n                        upper = get_upper_lims(d$temp, d$rate, model_name = 'sharpeschoolhigh_1981'),\n                        weights = rep(1, times = nrow(d)))\n\n# bootstrap using case resampling\nboot1 &lt;- Boot(fit_nlsLM, method = 'case')\n\n# look at the data\nhead(boot1$t)\n\n        r_tref         e       eh       th\n[1,] 0.2387067 0.9452492 2.367318 29.24874\n[2,] 0.2511824 0.7655751 2.547971 31.27085\n[3,] 0.3173423 0.7499641 2.081992 29.59478\n[4,] 0.2586626 0.7592931 2.564117 31.18532\n[5,] 0.2871170 0.6627851 2.483048 31.94504\n[6,] 0.2434468 0.8695365 2.432169 30.15619\n\n\nThe parameters of each bootstrapped refit are returned. All methods that are available for boot() and Boot() are supported for these objects. This includes the hist.boot() function which looks at the distribution of each parameter.\n\nhist(boot1, layout = c(2,2))\n\n\n\n\n\n\n\n\nWe can easily create predictions for each of these models and through this confidence intervals around the original fitted predictions. We can then plot (1) the bootstrapped fits and (2) the confidence regions around the model predictions.\n\n# create predictions of each bootstrapped model\nboot1_preds &lt;- boot1$t %&gt;%\n  as.data.frame() %&gt;%\n  drop_na() %&gt;%\n  mutate(iter = 1:n()) %&gt;%\n  group_by_all() %&gt;%\n  do(data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))) %&gt;%\n  ungroup() %&gt;%\n  mutate(pred = sharpeschoolhigh_1981(temp, r_tref, e, eh, th, tref = 15))\n\n# calculate bootstrapped confidence intervals\nboot1_conf_preds &lt;- group_by(boot1_preds, temp) %&gt;%\n  summarise(conf_lower = quantile(pred, 0.025),\n            conf_upper = quantile(pred, 0.975),\n            .groups = 'drop')\n\n# plot bootstrapped CIs\np1 &lt;- ggplot() +\n  geom_line(aes(temp, .fitted), d_preds, col = 'blue') +\n  geom_ribbon(aes(temp, ymin = conf_lower, ymax = conf_upper), boot1_conf_preds, fill = 'blue', alpha = 0.3) +\n  geom_point(aes(temp, rate), d, size = 2, alpha = 0.5) +\n  theme_bw(base_size = 12) +\n  labs(x = 'Temperature (ºC)',\n       y = 'Growth rate',\n       title = 'Growth rate across temperatures')\n\n# plot bootstrapped predictions\np2 &lt;- ggplot() +\n  geom_line(aes(temp, .fitted), d_preds, col = 'blue') +\n  geom_line(aes(temp, pred, group = iter), boot1_preds, col = 'blue', alpha = 0.007) +\n  geom_point(aes(temp, rate), d, size = 2, alpha = 0.5) +\n  theme_bw(base_size = 12) +\n  labs(x = 'Temperature (ºC)',\n       y = 'Growth rate',\n       title = 'Growth rate across temperatures')\n\np1 + p2\n\n\n\n\n\n\n\n\nThis method works well here, because there are many points beyond the peak of the curve and multiple independent points at each temperature.\n\n\nCase resampling: When it struggles\nThis method becomes more problematic when there is a small sample size and the coverage of temperature values beyond the optimum temperature is small. This means that many of the bootstrapped datasets will not have any points beyond the optimum, which is problematic for mathematical models that expect a unimodal shape. The effect of this can be seen by case resampling a curve from the chlorella_tpc dataset also in rTPC. Here we again fit the model using nls_multstart(), refit the model using nlsLM(), then bootstrap the model using Boot().\n\n# load in chlorella data\ndata('chlorella_tpc') \n\nd2 &lt;- filter(chlorella_tpc, curve_id == 1)\n\n# fit Sharpe-Schoolfield model to raw data\nd_fit &lt;- nest(d2, data = c(temp, rate)) %&gt;%\n  mutate(sharpeschoolhigh = map(data, ~nls_multstart(rate~sharpeschoolhigh_1981(temp = temp, r_tref,e,eh,th, tref = 15),\n                        data = .x,\n                        iter = c(3,3,3,3),\n                        start_lower = get_start_vals(.x$temp, .x$rate, model_name = 'sharpeschoolhigh_1981') - 10,\n                        start_upper = get_start_vals(.x$temp, .x$rate, model_name = 'sharpeschoolhigh_1981') + 10,\n                        lower = get_lower_lims(.x$temp, .x$rate, model_name = 'sharpeschoolhigh_1981'),\n                        upper = get_upper_lims(.x$temp, .x$rate, model_name = 'sharpeschoolhigh_1981'),\n                        supp_errors = 'Y',\n                        convergence_count = FALSE)),\n         # create new temperature data\n         new_data = map(data, ~tibble(temp = seq(min(.x$temp), max(.x$temp), length.out = 100))),\n         # predict over that data,\n         preds =  map2(sharpeschoolhigh, new_data, ~augment(.x, newdata = .y)))\n\n# refit model using nlsLM\nfit_nlsLM2 &lt;- nlsLM(rate~sharpeschoolhigh_1981(temp = temp, r_tref,e,eh,th, tref = 15),\n                        data = d2,\n                        start = coef(d_fit$sharpeschoolhigh[[1]]),\n                        lower = get_lower_lims(d2$temp, d2$rate, model_name = 'sharpeschoolhigh_1981'),\n                        upper = get_upper_lims(d2$temp, d2$rate, model_name = 'sharpeschoolhigh_1981'),\n                        control = nls.lm.control(maxiter=500),\n                        weights = rep(1, times = nrow(d2)))\n\n# bootstrap using case resampling\nboot2 &lt;- Boot(fit_nlsLM2, method = 'case')\n\n\n Number of bootstraps was 995 out of 999 attempted \n\n\nWe can then create predictions for each bootstrapped model and calculate 95% confidence intervals around the predictions. Models that don’t fit and return NA for the parameter estimates are dropped.\n\n# unnest predictions of original model fit\nd_preds &lt;- select(d_fit, preds) %&gt;%\n  unnest(preds)\n\n# predict over new data\nboot2_preds &lt;- boot2$t %&gt;%\n  as.data.frame() %&gt;%\n  drop_na() %&gt;%\n  mutate(iter = 1:n()) %&gt;%\n  group_by_all() %&gt;%\n  do(data.frame(temp = seq(min(d2$temp), max(d2$temp), length.out = 100))) %&gt;%\n  ungroup() %&gt;%\n  mutate(pred = sharpeschoolhigh_1981(temp, r_tref, e, eh, th, tref = 15))\n\n# calculate bootstrapped confidence intervals\nboot2_conf_preds &lt;- group_by(boot2_preds, temp) %&gt;%\n  summarise(conf_lower = quantile(pred, 0.025),\n            conf_upper = quantile(pred, 0.975),\n            .groups = 'drop')\n\n# plot bootstrapped CIs\np1 &lt;- ggplot() +\n  geom_line(aes(temp, .fitted), d_preds, col = 'blue') +\n  geom_ribbon(aes(temp, ymin = conf_lower, ymax = conf_upper), boot2_conf_preds, fill = 'blue', alpha = 0.3) +\n  geom_point(aes(temp, rate), d2, size = 2) +\n  theme_bw(base_size = 12) +\n  labs(x = 'Temperature (ºC)',\n       y = 'Growth rate',\n       title = 'Growth rate across temperatures')\n\n# plot bootstrapped predictions\np2 &lt;- ggplot() +\n  geom_line(aes(temp, .fitted), d_preds, col = 'blue') +\n  geom_line(aes(temp, pred, group = iter), boot2_preds, col = 'blue', alpha = 0.007) +\n  geom_point(aes(temp, rate), d2, size = 2) +\n  theme_bw(base_size = 12) +\n  labs(x = 'Temperature (ºC)',\n       y = 'Growth rate',\n       title = 'Growth rate across temperatures')\n\np1 + p2\n\n\n\n\n\n\n\n\nAs can be seen, bootstrapping-with-replacement with only a single point at each temperature can lead to a large variety of fits. In the second panel, we can see the variation of the curve fits, clustering around 4 possible paths for the decrease in rate beyond the optimum temperature. This occurs because in many instances there are no points sampled at the very high temperatures, leading to this clustering in curve fits."
  },
  {
    "objectID": "posts/bootstrap_nls/index.html#residual-resampling",
    "href": "posts/bootstrap_nls/index.html#residual-resampling",
    "title": "Bootstrap nls models in R",
    "section": "Residual resampling",
    "text": "Residual resampling\nCase resampling is the most common way of thinking about bootstrapping. However, bootstrapping ordinary least squares regression models is often done using bootstrapping residuals. This method - where the values of the predictors in a study remain fixed during resampling - is especially useful in a designed experiment where the values of the predictors are set by the experimenter.\nRe-sampling residuals, at its heart, follows a simple set of steps:\n\nFit the model and for each data point, \\(i\\), retain the fitted values \\(\\hat{y_{i}}\\) and the residuals, \\(\\hat{e_{i}} = y_{i} - \\hat{y_{i}}\\)\nFor each data pair, (\\(x_i\\), \\(y_i\\)), where \\(x_i\\) is the measured temperature value, we add a randomly re-sampled residual, \\(\\hat{e}\\) to the fitted value \\(\\hat{y_i}\\). This becomes the new \\(y_i\\) value, such that \\(y_i = \\hat{y_i} + \\hat{e}\\). The new response variable is created based on the random re-allocation of the variation around the original model fit\nThe model is refit using the newly created \\(y_i\\) response variable\nRepeat steps 2 and 3 a number of times\n\nThis method makes the assumption that the original model fit is a good representation of the data, and that the error terms in the model are normally distributed and independent. If the model is incorrectly specified – for example, if there is unmodelled non-linearity, non-constant error variance, or outliers – these characteristics will not carry over into the re-sampled data sets.\ncar::Boot() has an argument that allows us to easily implement residual resampling instead of case resampling, by setting method = 'residual'.\n\n# bootstrap using residual resampling\nboot3 &lt;- Boot(fit_nlsLM2, method = 'residual')\n\n# predict over new data\nboot3_preds &lt;- boot3$t %&gt;%\n  as.data.frame() %&gt;%\n  drop_na() %&gt;%\n  mutate(iter = 1:n()) %&gt;%\n  group_by_all() %&gt;%\n  do(data.frame(temp = seq(min(d2$temp), max(d2$temp), length.out = 100))) %&gt;%\n  ungroup() %&gt;%\n  mutate(pred = sharpeschoolhigh_1981(temp, r_tref, e, eh, th, tref = 15))\n\n# calculate bootstrapped confidence intervals\nboot3_conf_preds &lt;- group_by(boot3_preds, temp) %&gt;%\n  summarise(conf_lower = quantile(pred, 0.025),\n            conf_upper = quantile(pred, 0.975),\n            .groups = 'drop')\n\n# plot bootstrapped CIs\np1 &lt;- ggplot() +\n  geom_line(aes(temp, .fitted), d_preds, col = 'blue') +\n  geom_ribbon(aes(temp, ymin = conf_lower, ymax = conf_upper), boot3_conf_preds, fill = 'blue', alpha = 0.3) +\n  geom_point(aes(temp, rate), d2, size = 2) +\n  theme_bw(base_size = 12) +\n  labs(x = 'Temperature (ºC)',\n       y = 'Growth rate',\n       title = 'Growth rate across temperatures')\n\n# plot bootstrapped predictions\np2 &lt;- ggplot() +\n  geom_line(aes(temp, .fitted), d_preds, col = 'blue') +\n  geom_line(aes(temp, pred, group = iter), boot3_preds, col = 'blue', alpha = 0.007) +\n  geom_point(aes(temp, rate), d2, size = 2) +\n  theme_bw(base_size = 12) +\n  labs(x = 'Temperature (ºC)',\n       y = 'Growth rate',\n       title = 'Growth rate across temperatures')\n\np1 + p2"
  },
  {
    "objectID": "posts/bootstrap_nls/index.html#calculating-confidence-intervals-of-estimated-parameters",
    "href": "posts/bootstrap_nls/index.html#calculating-confidence-intervals-of-estimated-parameters",
    "title": "Bootstrap nls models in R",
    "section": "Calculating confidence intervals of estimated parameters",
    "text": "Calculating confidence intervals of estimated parameters\nBootstrapping can be used to estimate confidence intervals of the parameters explicitly modelled in the regression. We can compare these approaches to profiled confidence intervals (using confint-MASS) and asymptotic confidence intervals (using nlstools::confint2()). For the bootstrapped parameter distributions, confint.boot() supports the calculation of BCa, basic, normal, and percentile confidence intervals. We use BCa here, and we will calculate all CIs on the two models done previously in this vignette. First with the bacteria TPC.\n\n# First for the bacteria\n\n# get parameters of fitted model\nparam_bact &lt;- broom::tidy(fit_nlsLM) %&gt;%\n  select(param = term, estimate)\n\n# calculate confidence intervals of models\nci_bact1 &lt;- nlstools::confint2(fit_nlsLM, method = 'asymptotic') %&gt;%\n  as.data.frame() %&gt;%\n  rename(conf_lower = 1, conf_upper = 2) %&gt;%\n  rownames_to_column(., var = 'param') %&gt;%\n  mutate(method = 'asymptotic')\nci_bact2 &lt;- confint(fit_nlsLM) %&gt;%\n  as.data.frame() %&gt;%\n  rename(conf_lower = 1, conf_upper = 2) %&gt;%\n  rownames_to_column(., var = 'param') %&gt;%\n  mutate(method = 'profile')\n\n# CIs from case resampling\nci_bact3 &lt;- confint(boot1, method = 'bca') %&gt;%\n  as.data.frame() %&gt;%\n  rename(conf_lower = 1, conf_upper = 2) %&gt;%\n  rownames_to_column(., var = 'param') %&gt;%\n  mutate(method = 'case bootstrap')\n\n# CIs from residual resampling\nci_bact4 &lt;- Boot(fit_nlsLM, method = 'residual') %&gt;%\n  confint(., method = 'bca') %&gt;%\n  as.data.frame() %&gt;%\n  rename(conf_lower = 1, conf_upper = 2) %&gt;%\n  rownames_to_column(., var = 'param') %&gt;%\n  mutate(method = 'residual bootstrap')\n\nci_bact &lt;- bind_rows(ci_bact1, ci_bact2, ci_bact3, ci_bact4) %&gt;%\n  left_join(., param_bact)\n\n# plot\nggplot(ci_bact, aes(forcats::fct_relevel(method, c('profile', 'asymptotic')), estimate, col = method)) +\n  geom_hline(aes(yintercept = conf_lower), linetype = 2, filter(ci_bact, method == 'profile')) +\n  geom_hline(aes(yintercept = conf_upper), linetype = 2, filter(ci_bact, method == 'profile')) +\n  geom_point(size = 4) +\n  geom_linerange(aes(ymin = conf_lower, ymax = conf_upper)) +\n  theme_bw() +\n  facet_wrap(~param, scales = 'free') +\n  scale_x_discrete('', labels = function(x) stringr::str_wrap(x, width = 10)) +\n  labs(title = 'Calculation of confidence intervals for model parameters',\n       subtitle = 'For the bacteria TPC; dashed lines are CI of profiling method')\n\n\n\n\n\n\n\n\nEach panel is a different explicitly modelled parameter. The dashed lines represent the 95% intervals for the profiling method. In general, the different bootstrap methods are similar to the profiled intervals, but not all parameters are the same. For example, r_tref and e give wider (and asymmetric) confidence intervals using the case resampling method. The residual method gives estimates that are more similar to those calculated from profiling."
  },
  {
    "objectID": "posts/bootstrap_nls/index.html#calculate-confidence-intervals-of-generated-parameters",
    "href": "posts/bootstrap_nls/index.html#calculate-confidence-intervals-of-generated-parameters",
    "title": "Bootstrap nls models in R",
    "section": "Calculate confidence intervals of generated parameters",
    "text": "Calculate confidence intervals of generated parameters\nCrucially, bootstrapping allows the calculation of confidence intervals for parameters derived from the model that were not present in the initial fitting process. For example, the optimum temperature of a thermal performance curve, \\(T_{opt}\\) is calculated as:\n\\[T_{opt} = \\frac{E_{h}T_{h}}{E_{h} + k T_{h} ln(\\frac{E_{h}}{E} - 1)}\\] We can calculate \\(T_{opt}\\) by writing a custom function that we feed into Boot(). We will do this using the case resampling approach for the first curve in this blog post.\n\nget_topt &lt;- function(model){\n  coefs = coef(model)\n  \n  e = coefs[names(coefs) == 'e']\n  eh = coefs[names(coefs) == 'eh']\n  th = coefs[names(coefs) == 'th']\n  \n  return(((eh*(th + 273.15))/(eh + (8.62e-05 *(th + 273.15)*log((eh/e) - 1)))) - 273.15)\n}\n\ntopt &lt;- Boot(fit_nlsLM, f = function(x){get_topt(x)}, labels = 'topt', R = 999, method = 'case')\n\nhist(topt, legend = 'none')\n\n\n\n\n\n\n\n\nThis approach of using purrr, nls.multstart, and car can easily be scaled up to multiple curves."
  },
  {
    "objectID": "posts/bootstrap_nls/index.html#references",
    "href": "posts/bootstrap_nls/index.html#references",
    "title": "Bootstrap nls models in R",
    "section": "References",
    "text": "References\n\nPadfield, D., Castledine, M., & Buckling, A. (2020). Temperature-dependent changes to host–parasite interactions alter the thermal performance of a bacterial host. The ISME Journal, 14(2), 389-398."
  },
  {
    "objectID": "publications/articles/padfield_2020a.html",
    "href": "publications/articles/padfield_2020a.html",
    "title": "Evolution of diversity explains the impact of pre-adaptation of a focal species on the structure of a natural microbial community",
    "section": "",
    "text": "Padfield, D., Vujakovic, A., Paterson, S., Griffiths, R., Buckling, A., & Hesse, E. (2020). Evolution of diversity explains the impact of pre-adaptation of a focal species on the structure of a natural microbial community. The ISME journal, 14(11), 2877-2889."
  },
  {
    "objectID": "publications/articles/padfield_2020a.html#citation",
    "href": "publications/articles/padfield_2020a.html#citation",
    "title": "Evolution of diversity explains the impact of pre-adaptation of a focal species on the structure of a natural microbial community",
    "section": "",
    "text": "Padfield, D., Vujakovic, A., Paterson, S., Griffiths, R., Buckling, A., & Hesse, E. (2020). Evolution of diversity explains the impact of pre-adaptation of a focal species on the structure of a natural microbial community. The ISME journal, 14(11), 2877-2889."
  },
  {
    "objectID": "publications/articles/padfield_2020a.html#abstract",
    "href": "publications/articles/padfield_2020a.html#abstract",
    "title": "Evolution of diversity explains the impact of pre-adaptation of a focal species on the structure of a natural microbial community",
    "section": "Abstract",
    "text": "Abstract\nRapid within-species evolution can alter community structure, yet the mechanisms underpinning this effect remain unknown. Populations that rapidly evolve large amounts of phenotypic diversity are likely to interact with more species and have the largest impact on community structure. However, the evolution of phenotypic diversity is, in turn, influenced by the presence of other species. Here, we investigate how microbial community structure changes as a consequence of rapidly evolved within-species diversity using Pseudomonas fluorescens as a focal species. Evolved P. fluorescens populations showed substantial phenotypic diversification in resource-use (and correlated genomic change) irrespective of whether they were pre-adapted in isolation or in a community context. Manipulating diversity revealed that more diverse P. fluorescens populations had the greatest impact on community structure, by suppressing some bacterial taxa, but facilitating others. These findings suggest that conditions that promote the evolution of high within-population diversity should result in a larger impact on community structure."
  },
  {
    "objectID": "publications/articles/castledine_2024.html",
    "href": "publications/articles/castledine_2024.html",
    "title": "Bacteriophage resistance increases bacterial productivity by shifting population growth dynamics in the soil bacterium Variovorax sp",
    "section": "",
    "text": "Castledine, M., Padfield, D., Lewis, R., & Buckling, A. (2024). Bacteriophage resistance increases bacterial productivity by shifting population growth dynamics in the soil bacterium Variovorax sp. bioRxiv, 2024-03."
  },
  {
    "objectID": "publications/articles/castledine_2024.html#citation",
    "href": "publications/articles/castledine_2024.html#citation",
    "title": "Bacteriophage resistance increases bacterial productivity by shifting population growth dynamics in the soil bacterium Variovorax sp",
    "section": "",
    "text": "Castledine, M., Padfield, D., Lewis, R., & Buckling, A. (2024). Bacteriophage resistance increases bacterial productivity by shifting population growth dynamics in the soil bacterium Variovorax sp. bioRxiv, 2024-03."
  },
  {
    "objectID": "publications/articles/castledine_2024.html#abstract",
    "href": "publications/articles/castledine_2024.html#abstract",
    "title": "Bacteriophage resistance increases bacterial productivity by shifting population growth dynamics in the soil bacterium Variovorax sp",
    "section": "Abstract",
    "text": "Abstract\nBacteriophages can be important drivers of bacterial densities, and therefore microbial community composition and function. In response to phage infection, bacteria can evolve resistance while phage can reciprocally evolve to increase infectivity. Coevolutionary arms-races between bacteria and phage have been studied in many model systems and in pairs isolated from natural samples. However, how multiple bacteria-phage pairs coevolve simultaneously within a community is poorly understood. Here, we examine how three pairs of coexisting soil bacteria (Ochrobactrum sp., Pseudomonas sp., and Variovorax sp.) evolve with three species-specific bacteriophages over eight weeks of experimental evolution, both as host-parasite pairs in isolation and as a mixed community. Coevolution was very limited, with two phages going extinct after two weeks and Ochrobactrum phage increasing in infectivity without comparable reciprocal increases in bacterial resistance. One surprising finding was that Variovorax sp. increased in density following phage extinction, above that of no-phage controls. We examined the mechanisms behind this density increase through common garden experiments, growth curves, supernatant assays, and sequencing. Our results showed that this density increase resulted from genetic changes and was associated with phage resistance. Growth curves demonstrated that phage resistance shifted population growth curves such that density was higher in the death-phase. That resistance to lytic phage can improve host densities has implications for wider ecology and phage therapy where lytic phages are presumed to have negative effects on their hosts."
  },
  {
    "objectID": "publications/articles/padfield_2020b.html",
    "href": "publications/articles/padfield_2020b.html",
    "title": "Temperature-dependent changes to host–parasite interactions alter the thermal performance of a bacterial host",
    "section": "",
    "text": "Padfield, D., Castledine, M., & Buckling, A. (2020). Temperature-dependent changes to host–parasite interactions alter the thermal performance of a bacterial host. The ISME Journal, 14(2), 389-398."
  },
  {
    "objectID": "publications/articles/padfield_2020b.html#citation",
    "href": "publications/articles/padfield_2020b.html#citation",
    "title": "Temperature-dependent changes to host–parasite interactions alter the thermal performance of a bacterial host",
    "section": "",
    "text": "Padfield, D., Castledine, M., & Buckling, A. (2020). Temperature-dependent changes to host–parasite interactions alter the thermal performance of a bacterial host. The ISME Journal, 14(2), 389-398."
  },
  {
    "objectID": "publications/articles/padfield_2020b.html#abstract",
    "href": "publications/articles/padfield_2020b.html#abstract",
    "title": "Temperature-dependent changes to host–parasite interactions alter the thermal performance of a bacterial host",
    "section": "Abstract",
    "text": "Abstract\nThermal performance curves (TPCs) are used to predict changes in species interactions, and hence, range shifts, disease dynamics and community composition, under forecasted climate change. Species interactions might in turn affect TPCs. Here, we investigate how temperature-dependent changes in a microbial host–parasite interaction (the bacterium Pseudomonas fluorescens, and its lytic bacteriophage, SBWΦ2) changes the host TPC and the ecological and evolutionary mechanisms underlying these changes. The bacteriophage had a narrower thermal tolerance for infection, with their critical thermal maximum ~6 ºC lower than those at which the bacteria still had high growth. Consequently, in the presence of phage, the host TPC changed, resulting in a lower maximum growth rate. These changes were not just driven by differences in thermal tolerance, with temperature-dependent costs of evolved resistance also playing a major role: the largest cost of resistance occurred at the temperature at which bacteria grew best in the absence of phage. Our work highlights how ecological and evolutionary mechanisms can alter the effect of a parasite on host thermal performance, even over very short timescales."
  },
  {
    "objectID": "publications/articles/bartlett_2022.html",
    "href": "publications/articles/bartlett_2022.html",
    "title": "A comprehensive list of bacterial pathogens infecting humans",
    "section": "",
    "text": "Bartlett, A., Padfield, D., Lear, L., Bendall, R., & Vos, M. (2022). A comprehensive list of bacterial pathogens infecting humans. Microbiology, 168(12), 001269."
  },
  {
    "objectID": "publications/articles/bartlett_2022.html#citation",
    "href": "publications/articles/bartlett_2022.html#citation",
    "title": "A comprehensive list of bacterial pathogens infecting humans",
    "section": "",
    "text": "Bartlett, A., Padfield, D., Lear, L., Bendall, R., & Vos, M. (2022). A comprehensive list of bacterial pathogens infecting humans. Microbiology, 168(12), 001269."
  },
  {
    "objectID": "publications/articles/bartlett_2022.html#abstract",
    "href": "publications/articles/bartlett_2022.html#abstract",
    "title": "A comprehensive list of bacterial pathogens infecting humans",
    "section": "Abstract",
    "text": "Abstract\nThere exists an enormous diversity of bacteria capable of human infection, but no up-to-date, publicly accessible list is available. Combining a pragmatic definition of pathogenicity with an extensive search strategy, we report 1513 bacterial pathogens known to infect humans described pre-2021. Of these, 73 % were regarded as established (have infected at least three persons in three or more references) and 27 % as putative (fewer than three known cases). Pathogen species belong to 10 phyla and 24 classes scattered throughout the bacterial phylogeny. We show that new human pathogens are discovered at a rapid rate. Finally, we discuss how our results could be expanded to a database, which could provide a useful resource for microbiologists. Our list is freely available and archived on GitHub and Zenodo and we have provided walkthroughs to facilitate access and use."
  },
  {
    "objectID": "publications/articles/silk_2021.html",
    "href": "publications/articles/silk_2021.html",
    "title": "CMRnet: An R package to derive networks of social interactions and movement from mark–recapture data",
    "section": "",
    "text": "Silk, M. J., McDonald, R. A., Delahay, R. J., Padfield, D., & Hodgson, D. J. (2021). CMRnet: An r package to derive networks of social interactions and movement from mark–recapture data. Methods in Ecology and Evolution, 12(1), 70-75."
  },
  {
    "objectID": "publications/articles/silk_2021.html#citation",
    "href": "publications/articles/silk_2021.html#citation",
    "title": "CMRnet: An R package to derive networks of social interactions and movement from mark–recapture data",
    "section": "",
    "text": "Silk, M. J., McDonald, R. A., Delahay, R. J., Padfield, D., & Hodgson, D. J. (2021). CMRnet: An r package to derive networks of social interactions and movement from mark–recapture data. Methods in Ecology and Evolution, 12(1), 70-75."
  },
  {
    "objectID": "publications/articles/silk_2021.html#abstract",
    "href": "publications/articles/silk_2021.html#abstract",
    "title": "CMRnet: An R package to derive networks of social interactions and movement from mark–recapture data",
    "section": "Abstract",
    "text": "Abstract\n\nLong-term capture–mark–recapture data provide valuable information on the movements of individuals between locations, and the contemporary and/or co-located captures of individuals can be used to approximate the social structure of populations.\nWe introduce an r package (CMRnet) that generates social and movement networks from spatially explicit capture–mark–recapture data. It also provides functions for network and datastream permutations for these networks. Here we describe the package and key considerations for its application, providing two example case studies.\nThe conversion of spatially explicit mark–recapture data into social and movement networks will provide insights into the interplay between demography and behaviour in wild animal populations, with important applications in their management and conservation."
  },
  {
    "objectID": "publications/articles/padfield_2017.html",
    "href": "publications/articles/padfield_2017.html",
    "title": "Metabolic compensation constrains the temperature dependence of gross primary production",
    "section": "",
    "text": "Padfield, D., Lowe, C., Buckling, A., Ffrench‐Constant, R., Student Research Team, Jennings, S., … & Yvon‐Durocher, G. (2017). Metabolic compensation constrains the temperature dependence of gross primary production. Ecology Letters, 20(10), 1250-1260."
  },
  {
    "objectID": "publications/articles/padfield_2017.html#citation",
    "href": "publications/articles/padfield_2017.html#citation",
    "title": "Metabolic compensation constrains the temperature dependence of gross primary production",
    "section": "",
    "text": "Padfield, D., Lowe, C., Buckling, A., Ffrench‐Constant, R., Student Research Team, Jennings, S., … & Yvon‐Durocher, G. (2017). Metabolic compensation constrains the temperature dependence of gross primary production. Ecology Letters, 20(10), 1250-1260."
  },
  {
    "objectID": "publications/articles/padfield_2017.html#abstract",
    "href": "publications/articles/padfield_2017.html#abstract",
    "title": "Metabolic compensation constrains the temperature dependence of gross primary production",
    "section": "Abstract",
    "text": "Abstract\nGross primary production (GPP) is the largest flux in the carbon cycle, yet its response to global warming is highly uncertain. The temperature dependence of GPP is directly linked to photosynthetic physiology, but the response of GPP to warming over longer timescales could also be shaped by ecological and evolutionary processes that drive variation in community structure and functional trait distributions. Here, we show that selection on photosynthetic traits within and across taxa dampens the effects of temperature on GPP across a catchment of geothermally heated streams. Autotrophs from cold streams had higher photosynthetic rates and after accounting for differences in biomass among sites, biomass-specific GPP was independent of temperature in spite of a 20 °C thermal gradient. Our results suggest that temperature compensation of photosynthetic rates constrains the long-term temperature dependence of GPP, and highlights the importance of considering physiological, ecological and evolutionary mechanisms when predicting how ecosystem-level processes respond to warming."
  },
  {
    "objectID": "publications/articles/barneche_2021.html",
    "href": "publications/articles/barneche_2021.html",
    "title": "Warming impairs trophic transfer efficiency in a long-term field experiment",
    "section": "",
    "text": "Barneche, D. R., Hulatt, C. J., Dossena, M., Padfield, D., Woodward, G., Trimmer, M., & Yvon-Durocher, G. (2021). Warming impairs trophic transfer efficiency in a long-term field experiment. Nature, 592(7852), 76-79."
  },
  {
    "objectID": "publications/articles/barneche_2021.html#citation",
    "href": "publications/articles/barneche_2021.html#citation",
    "title": "Warming impairs trophic transfer efficiency in a long-term field experiment",
    "section": "",
    "text": "Barneche, D. R., Hulatt, C. J., Dossena, M., Padfield, D., Woodward, G., Trimmer, M., & Yvon-Durocher, G. (2021). Warming impairs trophic transfer efficiency in a long-term field experiment. Nature, 592(7852), 76-79."
  },
  {
    "objectID": "publications/articles/barneche_2021.html#abstract",
    "href": "publications/articles/barneche_2021.html#abstract",
    "title": "Warming impairs trophic transfer efficiency in a long-term field experiment",
    "section": "Abstract",
    "text": "Abstract\nIn ecosystems, the efficiency of energy transfer from resources to consumers determines the biomass structure of food webs. As a general rule, about 10% of the energy produced in one trophic level makes it up to the next1,2,3. Recent theory suggests that this energy transfer could be further constrained if rising temperatures increase metabolic growth costs4, although experimental confirmation in whole ecosystems is lacking. Here we quantify nitrogen transfer efficiency—a proxy for overall energy transfer—in freshwater plankton in artificial ponds that have been exposed to seven years of experimental warming. We provide direct experimental evidence that, relative to ambient conditions, 4 °C of warming can decrease trophic transfer efficiency by up to 56%. In addition, the biomass of both phytoplankton and zooplankton was lower in the warmed ponds, which indicates major shifts in energy uptake, transformation and transfer5,6. These findings reconcile observed warming-driven changes in individual-level growth costs and in carbon-use efficiency across diverse taxa4,7,8,9,10 with increases in the ratio of total respiration to gross primary production at the ecosystem level11,12,13. Our results imply that an increasing proportion of the carbon fixed by photosynthesis will be lost to the atmosphere as the planet warms, impairing energy flux through food chains, which will have negative implications for larger consumers and for the functioning of entire ecosystems."
  },
  {
    "objectID": "publications/articles/padfield_2021.html",
    "href": "publications/articles/padfield_2021.html",
    "title": "rTPC and nls.multstart: A new pipeline to fit thermal performance curves in R",
    "section": "",
    "text": "Padfield, D., O’Sullivan, H., & Pawar, S. (2021). rTPC and nls. multstart: a new pipeline to fit thermal performance curves in R. Methods in Ecology and Evolution, 12(6), 1138-1143."
  },
  {
    "objectID": "publications/articles/padfield_2021.html#citation",
    "href": "publications/articles/padfield_2021.html#citation",
    "title": "rTPC and nls.multstart: A new pipeline to fit thermal performance curves in R",
    "section": "",
    "text": "Padfield, D., O’Sullivan, H., & Pawar, S. (2021). rTPC and nls. multstart: a new pipeline to fit thermal performance curves in R. Methods in Ecology and Evolution, 12(6), 1138-1143."
  },
  {
    "objectID": "publications/articles/padfield_2021.html#abstract",
    "href": "publications/articles/padfield_2021.html#abstract",
    "title": "rTPC and nls.multstart: A new pipeline to fit thermal performance curves in R",
    "section": "Abstract",
    "text": "Abstract\n\nQuantifying thermal performance curves (TPCs) for biological rates has many applications to important problems such as predicting responses of biological systems—from individuals to communities—to directional climate change or climatic fluctuations.\nCurrent software tools for fitting TPC models to data are not adequate for dealing with the immense size of new datasets that are increasingly becoming available. We require tools capable of tackling this issue in a simple, reproducible and accessible way.\nWe present a new, reproducible pipeline in r that allows for relatively simple fitting of 24 different TPC models using nonlinear least squares (NLLS) regression. The pipeline consists of two packages—rTPC and nls.multstart—that provide functions which conveniently address common problems with NLLS fitting such as the NLLS parameter starting values problem. rTPC also includes functions to set starting values, estimate key TPC parameters and calculate uncertainty around parameter estimates as well as the fitted model as a whole.\nWe demonstrate how this pipeline can be combined with other packages in r to robustly and reproducibly fit multiple mathematical models to multiple TPC datasets at once. In addition, we show how model selection or averaging, weighted model fitting and bootstrapping can be easily implemented within the pipeline.\nThis new pipeline provides a flexible and reproducible approach that makes the challenging task of fitting multiple TPC models to data accessible to a wide range of users across ecology and evolution."
  },
  {
    "objectID": "publications/articles/sierocinski_2023.html",
    "href": "publications/articles/sierocinski_2023.html",
    "title": "The ecology of scale: impact of volume on coalescence and function in methanogenic communities",
    "section": "",
    "text": "Sierocinski, P., Stilwell, P., Padfield, D., Bayer, F., & Buckling, A. (2023). The ecology of scale: impact of volume on coalescence and function in methanogenic communities. Interface Focus, 13(4), 20220089."
  },
  {
    "objectID": "publications/articles/sierocinski_2023.html#citation",
    "href": "publications/articles/sierocinski_2023.html#citation",
    "title": "The ecology of scale: impact of volume on coalescence and function in methanogenic communities",
    "section": "",
    "text": "Sierocinski, P., Stilwell, P., Padfield, D., Bayer, F., & Buckling, A. (2023). The ecology of scale: impact of volume on coalescence and function in methanogenic communities. Interface Focus, 13(4), 20220089."
  },
  {
    "objectID": "publications/articles/sierocinski_2023.html#abstract",
    "href": "publications/articles/sierocinski_2023.html#abstract",
    "title": "The ecology of scale: impact of volume on coalescence and function in methanogenic communities",
    "section": "Abstract",
    "text": "Abstract\nEngineered ecosystems span multiple volume scales, from a nano-scale to thousands of cubic metres. Even the largest industrial systems are tested in pilot scale facilities. But does scale affect outcomes? Here we look at comparing different size laboratory anaerobic fermentors to see if and how the volume of the community affects the outcome of community coalescence (combining multiple communities) on community composition and function. Our results show that there is an effect of scale on biogas production. Furthermore, we see a link between community evenness and volume, with smaller scale communities having higher evenness. Despite those differences, the overall patterns of community coalescence are very similar at all scales, with coalescence leading to levels of biogas production comparable with that of the best-performing component community. The increase in biogas with increasing volume plateaus, suggesting there is a volume where productivity stays stable over large volumes. Our findings are reassuring for ecologists studying large ecosystems and industries operating pilot scale facilities, as they support the validity of pilot scale studies in this field."
  },
  {
    "objectID": "publications/articles/lear_2023.html",
    "href": "publications/articles/lear_2023.html",
    "title": "Copper reduces the virulence of bacterial communities at environmentally relevant concentrations.",
    "section": "",
    "text": "Lear, L., Padfield, D., Hesse, E., Kay, S., Buckling, A., & Vos, M. (2023). Copper reduces the virulence of bacterial communities at environmentally relevant concentrations. Environment International, 182, 108295."
  },
  {
    "objectID": "publications/articles/lear_2023.html#citation",
    "href": "publications/articles/lear_2023.html#citation",
    "title": "Copper reduces the virulence of bacterial communities at environmentally relevant concentrations.",
    "section": "",
    "text": "Lear, L., Padfield, D., Hesse, E., Kay, S., Buckling, A., & Vos, M. (2023). Copper reduces the virulence of bacterial communities at environmentally relevant concentrations. Environment International, 182, 108295."
  },
  {
    "objectID": "publications/articles/lear_2023.html#abstract",
    "href": "publications/articles/lear_2023.html#abstract",
    "title": "Copper reduces the virulence of bacterial communities at environmentally relevant concentrations.",
    "section": "Abstract",
    "text": "Abstract\nIncreasing environmental concentrations of metals as a result of anthropogenic pollution are significantly changing many microbial communities. While there is evidence metal pollution can result in increased antibiotic resistance, the effects of metal pollution on the virulence of bacterial communities remains largely undetermined. Here, we experimentally test whether metal stress alters the virulence of bacterial communities. We do this by incubating three wastewater influent communities under different environmentally relevant copper concentrations for three days. We then quantify the virulence of the community phenotypically using the Galleria mellonella infection model, and test if differences are due to changes in the rate of biomass accumulation (productivity), copper resistance, or community composition (quantified using 16S amplicon sequencing). The virulence of the communities was found to be reduced by the highest copper concentration, but not to be affected by the lower concentration. As well as reduced virulence, communities exposed to the highest copper concentration were less diverse and had lower productivity. This work highlights that metal pollution may decrease virulence in bacterial communities, but at a cost to diversity and productivity."
  },
  {
    "objectID": "publications/articles/vanhoute_2021.html",
    "href": "publications/articles/vanhoute_2021.html",
    "title": "Compost spatial heterogeneity promotes evolutionary diversification of a bacterium",
    "section": "",
    "text": "van Houte, S., Padfield, D., Gómez, P., Luján, A. M., Brockhurst, M. A., Paterson, S., & Buckling, A. (2021). Compost spatial heterogeneity promotes evolutionary diversification of a bacterium. Journal of Evolutionary Biology, 34(2), 246-255."
  },
  {
    "objectID": "publications/articles/vanhoute_2021.html#citation",
    "href": "publications/articles/vanhoute_2021.html#citation",
    "title": "Compost spatial heterogeneity promotes evolutionary diversification of a bacterium",
    "section": "",
    "text": "van Houte, S., Padfield, D., Gómez, P., Luján, A. M., Brockhurst, M. A., Paterson, S., & Buckling, A. (2021). Compost spatial heterogeneity promotes evolutionary diversification of a bacterium. Journal of Evolutionary Biology, 34(2), 246-255."
  },
  {
    "objectID": "publications/articles/vanhoute_2021.html#abstract",
    "href": "publications/articles/vanhoute_2021.html#abstract",
    "title": "Compost spatial heterogeneity promotes evolutionary diversification of a bacterium",
    "section": "Abstract",
    "text": "Abstract\nSpatial resource heterogeneity is expected to be a key driver for the evolution of diversity. However, direct empirical support for this prediction is limited to studies carried out in simplified laboratory environments. Here, we investigate how altering spatial heterogeneity of potting compost—by the addition of water and mixing—affects the evolutionary diversification of a bacterial species, Pseudomonas fluorescens, that is naturally found in the environment. There was a greater propensity of resource specialists to evolve in the unmanipulated compost, while more generalist phenotypes dominated the compost–water mix. Genomic data were consistent with these phenotypic findings. Competition experiments strongly suggest these results are due to diversifying selection as a result of resource heterogeneity, as opposed to other covariables. Overall, our findings corroborate theoretical and in vitro findings, but in semi-natural, more realistic conditions."
  },
  {
    "objectID": "publications/articles/padfield_2018.html",
    "href": "publications/articles/padfield_2018.html",
    "title": "Linking phytoplankton community metabolism to the individual size distribution",
    "section": "",
    "text": "Padfield, D., Buckling, A., Warfield, R., Lowe, C., & Yvon‐Durocher, G. (2018). Linking phytoplankton community metabolism to the individual size distribution. Ecology Letters, 21(8), 1152-1161."
  },
  {
    "objectID": "publications/articles/padfield_2018.html#citation",
    "href": "publications/articles/padfield_2018.html#citation",
    "title": "Linking phytoplankton community metabolism to the individual size distribution",
    "section": "",
    "text": "Padfield, D., Buckling, A., Warfield, R., Lowe, C., & Yvon‐Durocher, G. (2018). Linking phytoplankton community metabolism to the individual size distribution. Ecology Letters, 21(8), 1152-1161."
  },
  {
    "objectID": "publications/articles/padfield_2018.html#abstract",
    "href": "publications/articles/padfield_2018.html#abstract",
    "title": "Linking phytoplankton community metabolism to the individual size distribution",
    "section": "Abstract",
    "text": "Abstract\nQuantifying variation in ecosystem metabolism is critical to predicting the impacts of environmental change on the carbon cycle. We used a metabolic scaling framework to investigate how body size and temperature influence phytoplankton community metabolism. We tested this framework using phytoplankton sampled from an outdoor mesocosm experiment, where communities had been either experimentally warmed (+ 4 °C) for 10 years or left at ambient temperature. Warmed and ambient phytoplankton communities differed substantially in their taxonomic composition and size structure. Despite this, the response of primary production and community respiration to long- and short-term warming could be estimated using a model that accounted for the size- and temperature dependence of individual metabolism, and the community abundance-body size distribution. This work demonstrates that the key metabolic fluxes that determine the carbon balance of planktonic ecosystems can be approximated using metabolic scaling theory, with knowledge of the individual size distribution and environmental temperature."
  },
  {
    "objectID": "publications/articles/vos_2023.html",
    "href": "publications/articles/vos_2023.html",
    "title": "Adaptive radiations in natural populations of prokaryotes: innovation is key.",
    "section": "",
    "text": "Vos, M., Padfield, D., Quince, C., & Vos, R. (2023). Adaptive radiations in natural populations of prokaryotes: innovation is key. FEMS Microbiology Ecology, 99(12), fiad154."
  },
  {
    "objectID": "publications/articles/vos_2023.html#citation",
    "href": "publications/articles/vos_2023.html#citation",
    "title": "Adaptive radiations in natural populations of prokaryotes: innovation is key.",
    "section": "",
    "text": "Vos, M., Padfield, D., Quince, C., & Vos, R. (2023). Adaptive radiations in natural populations of prokaryotes: innovation is key. FEMS Microbiology Ecology, 99(12), fiad154."
  },
  {
    "objectID": "publications/articles/vos_2023.html#abstract",
    "href": "publications/articles/vos_2023.html#abstract",
    "title": "Adaptive radiations in natural populations of prokaryotes: innovation is key.",
    "section": "Abstract",
    "text": "Abstract\nProkaryote diversity makes up most of the tree of life and is crucial to the functioning of the biosphere and human health. However, the patterns and mechanisms of prokaryote diversification have received relatively little attention compared to animals and plants. Adaptive radiation, the rapid diversification of an ancestor species into multiple ecologically divergent species, is a fundamental process by which macrobiological diversity is generated. Here, we discuss whether ecological opportunity could lead to similar bursts of diversification in bacteria. We explore how adaptive radiations in prokaryotes can be kickstarted by horizontally acquired key innovations allowing lineages to invade new niche space that subsequently is partitioned among diversifying specialist descendants. We discuss how novel adaptive zones are colonized and exploited after the evolution of a key innovation and whether certain types of are more prone to adaptive radiation. Radiation into niche specialists does not necessarily lead to speciation in bacteria when barriers to recombination are absent. We propose that in this scenario, niche-specific genes could accumulate within a single lineage, leading to the evolution of an open pangenome."
  },
  {
    "objectID": "publications/articles/garciacarreras_2018.html",
    "href": "publications/articles/garciacarreras_2018.html",
    "title": "Role of carbon allocation efficiency in the temperature dependence of autotroph growth rates",
    "section": "",
    "text": "García-Carreras, B., Sal, S., Padfield, D., Kontopoulos, D. G., Bestion, E., Schaum, C. E., … & Pawar, S. (2018). Role of carbon allocation efficiency in the temperature dependence of autotroph growth rates. Proceedings of the National Academy of Sciences, 115(31), E7361-E7368."
  },
  {
    "objectID": "publications/articles/garciacarreras_2018.html#citation",
    "href": "publications/articles/garciacarreras_2018.html#citation",
    "title": "Role of carbon allocation efficiency in the temperature dependence of autotroph growth rates",
    "section": "",
    "text": "García-Carreras, B., Sal, S., Padfield, D., Kontopoulos, D. G., Bestion, E., Schaum, C. E., … & Pawar, S. (2018). Role of carbon allocation efficiency in the temperature dependence of autotroph growth rates. Proceedings of the National Academy of Sciences, 115(31), E7361-E7368."
  },
  {
    "objectID": "publications/articles/garciacarreras_2018.html#abstract",
    "href": "publications/articles/garciacarreras_2018.html#abstract",
    "title": "Role of carbon allocation efficiency in the temperature dependence of autotroph growth rates",
    "section": "Abstract",
    "text": "Abstract\nRelating the temperature dependence of photosynthetic biomass production to underlying metabolic rates in autotrophs is crucial for predicting the effects of climatic temperature fluctuations on the carbon balance of ecosystems. We present a mathematical model that links thermal performance curves (TPCs) of photosynthesis, respiration, and carbon allocation efficiency to the exponential growth rate of a population of photosynthetic autotroph cells. Using experiments with the green alga, Chlorella vulgaris, we apply the model to show that the temperature dependence of carbon allocation efficiency is key to understanding responses of growth rates to warming at both ecological and longer-term evolutionary timescales. Finally, we assemble a dataset of multiple terrestrial and aquatic autotroph species to show that the effects of temperature-dependent carbon allocation efficiency on potential growth rate TPCs are expected to be consistent across taxa. In particular, both the thermal sensitivity and the optimal temperature of growth rates are expected to change significantly due to temperature dependence of carbon allocation efficiency alone. Our study provides a foundation for understanding how the temperature dependence of carbon allocation determines how population growth rates respond to temperature."
  },
  {
    "objectID": "publications/articles/castledine_2020b.html",
    "href": "publications/articles/castledine_2020b.html",
    "title": "Community coalescence: an eco-evolutionary perspective",
    "section": "",
    "text": "Castledine, M., Sierocinski, P., Padfield, D., & Buckling, A. (2020). Community coalescence: an eco-evolutionary perspective. Philosophical Transactions of the Royal Society B, 375(1798), 20190252."
  },
  {
    "objectID": "publications/articles/castledine_2020b.html#citation",
    "href": "publications/articles/castledine_2020b.html#citation",
    "title": "Community coalescence: an eco-evolutionary perspective",
    "section": "",
    "text": "Castledine, M., Sierocinski, P., Padfield, D., & Buckling, A. (2020). Community coalescence: an eco-evolutionary perspective. Philosophical Transactions of the Royal Society B, 375(1798), 20190252."
  },
  {
    "objectID": "publications/articles/castledine_2020b.html#abstract",
    "href": "publications/articles/castledine_2020b.html#abstract",
    "title": "Community coalescence: an eco-evolutionary perspective",
    "section": "Abstract",
    "text": "Abstract\nCommunity coalescence, the mixing of different communities, is widespread throughout microbial ecology. Coalescence can result in approximately equal contributions from the founding communities or dominance of one community over another. These different outcomes have ramifications for community structure and function in natural communities, and the use of microbial communities in biotechnology and medicine. However, we have little understanding of when a particular outcome might be expected. Here, we integrate existing theory and data to speculate on how a crucial characteristic of microbial communities—the type of species interaction that dominates the community—might affect the outcome of microbial community coalescence. Given the often comparable timescales of microbial ecology and microevolution, we explicitly consider ecological and evolutionary dynamics, and their interplay, in determining coalescence outcomes."
  },
  {
    "objectID": "publications.html",
    "href": "publications.html",
    "title": "DanPadLab",
    "section": "",
    "text": "Order By\n       Default\n         \n          Title\n        \n         \n          Author\n        \n         \n          Publication\n        \n         \n          Year\n        \n     \n  \n    \n      \n      \n    \n\n\n\n  \n    Bacteriophage resistance increases bacterial productivity by shifting population growth dynamics in the soil bacterium Variovorax sp\n    Meaghan Castledine, Daniel Padfield, Rai Lewis, Angus Buckling\n    bioRxiv\n    (2024)\n    \n      Details\n    \n    \n    \n    \n       Preprint\n    \n    \n    \n    \n    \n    \n  \n\n  \n    Contrary effects of increasing temperatures on the spread of antimicrobial resistance in river biofilms\n    Kenyum Bagra, David Kneis, Daniel Padfield, Edina Szekeres, Adela Teban-Man, Cristian Coman, Gargi Singh, Thomas U. Berendonk, Uli Klümper\n    Msphere\n    (2024)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n       Preprint\n    \n    \n    \n    \n    \n    \n  \n\n  \n    Macroevolutionary dynamics in micro-organisms: generalists give rise to specialists across biomes in the ubiquitous bacterial phylum Myxococcota\n    Daniel Padfield, Suzanne Kay, Rutger Vos, Christopher Quince, Michiel Vos\n    Molecular Biology & Evolution\n    (2024)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n       Preprint\n    \n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    Adaptive radiations in natural populations of prokaryotes: innovation is key.\n    Michiel Vos, Daniel Padfield, Christopher Quince, Rutger Vos\n    Fems Microbiology Ecology\n    (2023)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n    \n  \n\n  \n    Comparative experimental evolution reveals species‐specific idiosyncrasies in marine phytoplankton adaptation to warming\n    Samuel Barton, Daniel Padfield, Abigail Masterson, Angus Buckling, Nicholas Smirnoff, Gabriel Yvon‐Durocher\n    Global Change Biology\n    (2023)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    Copper reduces the virulence of bacterial communities at environmentally relevant concentrations.\n    Luke Lear, Daniel Padfield, Elze Hesse, Suzanne Kay, Angus Buckling, Michiel Vos\n    Environment Internatinal\n    (2023)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    The ecology of scale: impact of volume on coalescence and function in methanogenic communities\n    Pawel Sierocinski, Peter Stilwell, Daniel Padfield, Florian Bayer and Angus Buckling\n    Royal Society Interface Focus\n    (2023)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    A comprehensive list of bacterial pathogens infecting humans\n    Abigail Bartlett, Daniel Padfield, Luke Lear, Richard Bendall and Michiel Vos\n    Microbiology\n    (2022)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    Associations between abundances of free-roaming gamebirds and common buzzards Buteo buteo are not driven by consumption of gamebirds in the buzzard breeding season\n    George JF Swan, Stuart Bearhop, Stephen M Redpath, Matthew J Silk, Daniel Padfield, Cecily ED Goodwin, Robbie A McDonald\n    Ecology & Evolution\n    (2022)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n  \n\n  \n    Bacterial colonisation dynamics of household plastics in a coastal environment\n    Luke Lear, Daniel Padfield, Tirion Dowsett, Maia Jones, Suzanne Kay, Alex Hayward, Michiel Vos\n    Science of the Total Environment\n    (2022)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    Disturbance‐mediated invasions are dependent on community resource abundance\n    Luke Lear, Daniel Padfield, Hidetoshi Inamine, Katriona Shea, Angus Buckling\n    Ecology\n    (2022)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    Greater phage genotypic diversity constrains arms-race coevolution\n    Meaghan Castledine, Pawel Sierocinski, Mhairi Inglis, Suzanne Kay, Alex Hayward, Angus Buckling, Daniel Padfield\n    Frontiers in Cellular and Infection Microbiology\n    (2022)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    Parallel evolution of Pseudomonas aeruginosa phage resistance and virulence loss in response to phage treatment in vivo and in vitro\n    Meaghan Castledine, Daniel Padfield, Pawel Sierocinski, Jesica Soria Pascual, Adam Hughes, Lotta Mäkinen, Ville-Petri Friman, Jean-Paul Pirnay, Maya Merabishvili, Daniel De Vos, Angus Buckling\n    eLife\n    (2022)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n       Preprint\n    \n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    CMRnet: An R package to derive networks of social interactions and movement from mark–recapture data\n    Matthew J Silk, Robbie A McDonald, Richard J Delahay, Daniel Padfield, David J Hodgson\n    Methods in Ecology & Evolution\n    (2021)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n  \n\n  \n    Compost spatial heterogeneity promotes evolutionary diversification of a bacterium\n    Stineke van Houte, Daniel Padfield, Pedro Gómez, Adela M Luján, Michael A Brockhurst, Steve Paterson, Angus Buckling\n    Journal of Evolutionary Biology\n    (2021)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n       Preprint\n    \n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    The impact of propagule pressure on whole community invasions in biomethane-producing communities\n    Pawel Sierocinski, Jesica Soria Pascual, Daniel Padfield, Mike Salter, Angus Buckling\n    iScience\n    (2021)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n       Preprint\n    \n    \n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    Warming impairs trophic transfer efficiency in a long-term field experiment\n    Diego R Barneche, Chris J Hulatt, Matteo Dossena, Daniel Padfield, Guy Woodward, Mark Trimmer, Gabriel Yvon-Durocher\n    Nature\n    (2021)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n       Open Access\n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    rTPC and nls.multstart: A new pipeline to fit thermal performance curves in R\n    Daniel Padfield, Hannah O'Sullivan, Samraat Pawar\n    Methods in Ecology & Evolution\n    (2021)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n  \n\n  \n    Community coalescence: an eco-evolutionary perspective\n    Meaghan Castledine, Pawel Sierocinski, Daniel Padfield, Angus Buckling\n    Philosophical Transactions of the Royal Society B\n    (2020)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n    \n  \n\n  \n    Evolution of diversity explains the impact of pre-adaptation of a focal species on the structure of a natural microbial community\n    Daniel Padfield, Alex Vujakovic, Steve Paterson, Rob Griffiths, Angus Buckling, Elze Hesse\n    ISME\n    (2020)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n       Open Access\n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    Experimental (co)evolution in a multi‐species microbial community results in local maladaptation\n    Meaghan Castledine, Daniel Padfield, Angus Buckling\n    Ecology Letters\n    (2020)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n       Preprint\n    \n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n  \n\n  \n    Postrelease movement and habitat selection of translocated pine martens Martes martes\n    Catherine M McNicol, David Bavin, Stuart Bearhop, Josie Bridges, Elizabeth Croose, Robin Gill, Cecily ED Goodwin, John Lewis, Jenny MacPherson, Daniel Padfield, Henry Schofield, Matthew J Silk, Alexandra J Tomlinson, Robbie A McDonald\n    Ecology & Evolution\n    (2020)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    Temperature-dependent changes to host–parasite interactions alter the thermal performance of a bacterial host\n    Daniel Padfield, Meaghan Castledine, Angus Buckling\n    ISME\n    (2020)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n       Open Access\n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    A shared coevolutionary history does not alter the outcome of coalescence in experimental populations of Pseudomonas fluorescens\n    Meaghan Castledine, Angus Buckling, Daniel Padfield\n    Journal of Evolutionary Biology\n    (2019)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    Anthropogenic remediation of heavy metals selects against natural microbial remediation\n    Elze Hesse, Daniel Padfield, Florian Bayer, Eleanor M Van Veen, Christopher G Bryan, Angus Buckling\n    Proceedings of the Royal Society B\n    (2019)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n       Preprint\n    \n    \n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    Linking phytoplankton community metabolism to the individual size distribution\n    Daniel Padfield, Angus Buckling, Ruth Warfield, Chris Lowe, Gabriel Yvon‐Durocher\n    Ecology Letters\n    (2018)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n  \n\n  \n    Role of carbon allocation efficiency in the temperature dependence of autotroph growth rates\n    Bernardo García-Carreras, Sofía Sal, Daniel Padfield, Dimitrios-Georgios Kontopoulos, Elvire Bestion, C-Elisa Schaum, Gabriel Yvon-Durocher, Samraat Pawar\n    PNAS\n    (2018)\n    \n      Details\n    \n    \n    \n    \n    \n    \n    \n  \n\n  \n    Temperature‐driven selection on metabolic traits increases the strength of an algal–grazer interaction in naturally warmed streams\n    C Elisa Schaum, Student Research Team, Richard ffrench‐Constant, Chris Lowe, Jón S Ólafsson, Daniel Padfield, Gabriel Yvon‐Durocher, Yasmin Ashton, Romina Botoli, Peter Coles, Joe Crisp, Emma Dwan, Stella Enoch‐Pledger, Briony Flello, Kate Freegard, Ceri Haines, Matthew Holland, Luke Lear, Emma Lokuciejewski, Heather McPhee, Toby Newport, Liisa Pahk, Sienna Somers, Caspar Swindells, Maria Wild, Ethan Wrigglesworth\n    Global Change Biology\n    (2018)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n       Preprint\n    \n    \n    \n    \n    \n    \n  \n\n  \n    Metabolic compensation constrains the temperature dependence of gross primary production\n    Daniel Padfield, Chris Lowe, Angus Buckling, Richard Ffrench‐Constant, Student Research Team, Simon Jennings, Felicity Shelley, Jón S Ólafsson, Gabriel Yvon‐Durocher\n    Ecology Letters\n    (2017)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n       Preprint\n    \n    \n    \n    \n    \n       Code\n    \n    \n    \n    \n       Data\n    \n    \n    \n  \n\n  \n    Rapid evolution of metabolic traits explains thermal adaptation in phytoplankton\n    Daniel Padfield, Genevieve Yvon‐Durocher, Angus Buckling, Simon Jennings, Gabriel Yvon‐Durocher\n    Ecology Letters\n    (2016)\n    \n      Details\n    \n    \n    \n      DOI\n    \n    \n    \n    \n    \n    \n    \n  \n\n\n\n\nNo matching items"
  },
  {
    "objectID": "software.html",
    "href": "software.html",
    "title": "Software",
    "section": "",
    "text": "nls.multstart is an R package that allows more robust and reproducible non-linear regression compared to nls() or nlsLM(). These functions allow only a single starting value, meaning that it can be hard to get the best estimated model. This is especially true if the same model is fitted over the levels of a factor, which may have the same shape of curve, but be much different in terms of parameter estimates.\nnls_multstart() is the main function of nls.multstart. Similar to the R package nls2, it allows multiple starting values for each parameter and then iterates through multiple starting values, attempting a fit with each set of start parameters. The best model is then picked on AIC score. This results in a more reproducible and reliable method of fitting non-linear least squares regression in R.\nThis package is designed to work with the tidyverse, harnessing the functions within broom, tidyr, dplyr and purrr to extract estimates and plot things easily with ggplot2.\n  GitHub    CRAN"
  },
  {
    "objectID": "software.html#nls.multstart",
    "href": "software.html#nls.multstart",
    "title": "Software",
    "section": "",
    "text": "nls.multstart is an R package that allows more robust and reproducible non-linear regression compared to nls() or nlsLM(). These functions allow only a single starting value, meaning that it can be hard to get the best estimated model. This is especially true if the same model is fitted over the levels of a factor, which may have the same shape of curve, but be much different in terms of parameter estimates.\nnls_multstart() is the main function of nls.multstart. Similar to the R package nls2, it allows multiple starting values for each parameter and then iterates through multiple starting values, attempting a fit with each set of start parameters. The best model is then picked on AIC score. This results in a more reproducible and reliable method of fitting non-linear least squares regression in R.\nThis package is designed to work with the tidyverse, harnessing the functions within broom, tidyr, dplyr and purrr to extract estimates and plot things easily with ggplot2.\n  GitHub    CRAN"
  },
  {
    "objectID": "software.html#rtpc",
    "href": "software.html#rtpc",
    "title": "Software",
    "section": "rTPC",
    "text": "rTPC\nrTPC is an R package that helps fit thermal performance curves (TPCs) in R. rTPC contains 24 model formulations previously used to fit TPCs and has helper functions to help set sensible start parameters, upper and lower parameter limits and estimate parameters useful in downstream analyses, such as cardinal temperatures, maximum rate and optimum temperature.\nThe idea behind rTPC is to make fitting thermal performance curves easier, to provide workflows and examples of fitting TPCs without saying which model works best. Which model and which workflow is “best” is going to be down to the question that is being asked. Throughout the vignettes, Things to consider sections give some key considerations about what to consider before and during the analysis.\nWhen developing rTPC, we made a conscious decision not to repeat code and methods that are already optimised and available in the R ecosystem. Consequently, the workflows take advantage of nls.multstart for fitting non-linear least squares regression and packages from the tidyverse for data manipulation, fitting multiple models, and visualisation. The R package car is used extensively for the bootstrapping approaches.\n  GitHub    CRAN    website    publication"
  },
  {
    "objectID": "software.html#rstrava",
    "href": "software.html#rstrava",
    "title": "Software",
    "section": "rStrava",
    "text": "rStrava\nI contributed to the R package rStrava, which provides an interface to the Strava API in R. Using rStrava, you can access and manipulate data related to your own activities, as well as retrieve data about athletes and activities on Strava. Some of the main functionality of rStrava includes:\n\nAuthenticating and connecting to the Strava API\nRetrieving information about the user’s profile and activities\nRetrieving information about other athletes and their activities\nDownloading data from activities and working with it in R\nEasy visualisation of ride maps and elevation profiles\n\nThe main developer and maintainer of rStrava is Marcus Beck.\n  GitHub"
  },
  {
    "objectID": "posts/caring_for_soph/index.html#soph-has-not-seen-our-dog-copper-properly-in-over-6-years.",
    "href": "posts/caring_for_soph/index.html#soph-has-not-seen-our-dog-copper-properly-in-over-6-years.",
    "title": "Caring for someone with severe ME",
    "section": "",
    "text": "Copper - as some of you may know - is our 9 year old sausage dog. He was meant to be our great silver lining. When Soph became ill and unable to work, it meant she was at home so much more. Which gave us the opportunity to get a dog, and we specifically got Copper because he does not need walking so much with his tiny ridiculous legs.\nAnd he was a triumph. He loves people and company, and loved Soph in particular. He just loves being on you, touching you, stealing your warmth. We toilet trained him, taught him tricks, and the couple of summers we spent in Cornwall together as a 3 are among my happiest memories. And Soph loves him so much. She loves how he holds toys between his paws while he chews them, and how he rolls on his back for scritches and so many other things (apart from his barking). We used to enjoy dressing him up and trying to put our glasses on his face while he snoozed next to us. We were a tripod supporting each other.\n\n\n\nCopper with glasses.\n\n\nSoph has not been in Cornwall for ~7 years, and Copper has not either. As I live alone and try to get to the office when I am down there it is not the best place for a dog, so he lives in Cheltenham. When Soph was downstairs this worked ok. He would wait for her to come downstairs in the morning and be so excited to see her, showing her his belly and asking for scritches and giving licks. He is not an ideal companion dog, but he loved being around Soph as much as he could.\n\n\n\nCopper and Soph on an outdoor trip to to Potager gardens.\n\n\nHowever, as Soph has got worse she has seen Copper less. When Copper goes upstairs he is very alert and wants to sniff everything compared to the mellow, settled dog we’d need him to be so that Soph’s vertigo is not triggered. A few years ago when I still managed to very occasionally bring him upstairs, she would enjoy seeing him, she would smile and be engaged. He would lick her hand and let her be stroked, but he could sense something was wrong and need reassurance from me.\n\n\n\nCopper and Soph when Soph when she used to spend time downstairs.\n\n\nFast forward to today, he is sat on me under a blanket while I am typing. Soph has not seen him properly in &gt;6 years. Yet another heartbreaking thing she has lost. Instead he lives downstairs providing company and emotional support for the rest of us. I describe him as a living hot water bottle and stress ball (he is lay on me under a blanket as I type this). He is great for me when I come up to visit. And I am so thankful for Soph’s family for looking after him so well.\n\n\n\nHe just loves blankets.\n\n\nI often describe Soph as being in stasis, like her life is on pause - albeit while going through indescribable suffering - until we can have our little lifey. And that means she remembers Copper when he was 3, not when he was 9. In that time he has recovered from a slipped disc which left him unable to walk, had some cancerous tissue removed from a paw, and started greying under his chinny chin chin. But he is not allowed to get old. Not until Soph recovers somewhat to be able to see him regularly again The thought of him dying of old age while Soph is still alone, suffering in her bed, crosses my mind briefly. Cannot even imagine how we would tell her."
  }
]